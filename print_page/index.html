
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      <link rel="icon" href="../images/hpvs-logo.svg">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.11">
    
    
      
        <title>Print Site - Hyper Protect Virtual Servers (HPVS) Workshop</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.85bb2934.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a6bdf11c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
    <script>__md_scope=new URL("/",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-N1XCHYKZ2T"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-N1XCHYKZ2T",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-N1XCHYKZ2T",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="yellow">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Hyper Protect Virtual Servers (HPVS) Workshop" class="md-header__button md-logo" aria-label="Hyper Protect Virtual Servers (HPVS) Workshop" data-md-component="logo">
      
  <img src="../images/hpvs-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hyper Protect Virtual Servers (HPVS) Workshop
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="yellow"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="yellow"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ibm-wsc/hyper-protect-virtual-servers-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../assignment/" class="md-tabs__link">
      Lab Assignments
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../grep11-lab/overview/" class="md-tabs__link">
        GREP11 Lab
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../prerequisites/" class="md-tabs__link">
        Secure Image Build Lab
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../glossary/" class="md-tabs__link">
      Glossary of terms
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../resources/" class="md-tabs__link">
      Other resources
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../proposechange/" class="md-tabs__link">
      Propose a change
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="./" class="md-tabs__link">
      Print Site
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Hyper Protect Virtual Servers (HPVS) Workshop" class="md-nav__button md-logo" aria-label="Hyper Protect Virtual Servers (HPVS) Workshop" data-md-component="logo">
      
  <img src="../images/hpvs-logo.svg" alt="logo">

    </a>
    Hyper Protect Virtual Servers (HPVS) Workshop
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ibm-wsc/hyper-protect-virtual-servers-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../assignment/" class="md-nav__link">
        Lab Assignments
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          GREP11 Lab
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          GREP11 Lab
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../grep11-lab/overview/" class="md-nav__link">
        Lab overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../grep11-lab/grep11-setup/" class="md-nav__link">
        How to set up a GREP11 server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../grep11-lab/grep11-display/" class="md-nav__link">
        Displaying your GREP11 environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../grep11-lab/run-grep11-samples/" class="md-nav__link">
        Run the GREP11 sample code
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          Run the Lab exercises
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Run the Lab exercises
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../grep11-lab/exercise-overview/" class="md-nav__link">
        An overview of the Exercises
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../grep11-lab/lab-exercise1/" class="md-nav__link">
        Exercise 1 (List PKCS Mechanisms)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../grep11-lab/lab-exercise2/" class="md-nav__link">
        Exercise 2 (Encryption and Decryption)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../grep11-lab/lab-exercise3/" class="md-nav__link">
        Exercise 3 (Sign and Verify)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../grep11-lab/lab-exercise4/" class="md-nav__link">
        Exercise 4 (Wrap and Unwrap Key)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Secure Image Build Lab
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Secure Image Build Lab
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../prerequisites/" class="md-nav__link">
        Prerequisites
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../securebuild-lab/overview/" class="md-nav__link">
        Hyper Protect Virtual Servers (HPVS) Lab Process Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../securebuild-lab/securebuild-setup/" class="md-nav__link">
        Configuring your Environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../securebuild-lab/create-server/" class="md-nav__link">
        Create your HPVS Secure Build Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../securebuild-lab/build/" class="md-nav__link">
        Securely Build your Application
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../securebuild-lab/deploy-app/" class="md-nav__link">
        Deploy your Securely Built Application as a Hyper Protect Virtual Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../securebuild-lab/bitcoin_wallet/" class="md-nav__link">
        Welcome to the Secure Bitcoin Wallet on IBM LinuxONE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../securebuild-lab/cleanup/" class="md-nav__link">
        Clean up your Environment
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../glossary/" class="md-nav__link">
        Glossary of terms
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../resources/" class="md-nav__link">
        Other resources
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../proposechange/" class="md-nav__link">
        Propose a change
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Print Site
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Print Site
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    1. Home
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assignment" class="md-nav__link">
    2. Lab Assignments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-grep11-lab" class="md-nav__link">
    I. GREP11 Lab
  </a>
  
    <nav class="md-nav" aria-label="I. GREP11 Lab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grep11-lab-overview" class="md-nav__link">
    3. Lab overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grep11-lab-grep11-setup" class="md-nav__link">
    4. How to set up a GREP11 server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grep11-lab-grep11-display" class="md-nav__link">
    5. Displaying your GREP11 environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grep11-lab-run-grep11-samples" class="md-nav__link">
    6. Run the GREP11 sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-secure-image-build-lab" class="md-nav__link">
    II. Secure Image Build Lab
  </a>
  
    <nav class="md-nav" aria-label="II. Secure Image Build Lab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    7. Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-overview" class="md-nav__link">
    8. Hyper Protect Virtual Servers (HPVS) Lab Process Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-securebuild-setup" class="md-nav__link">
    9. Configuring your Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-create-server" class="md-nav__link">
    10. Create your HPVS Secure Build Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-build" class="md-nav__link">
    11. Securely Build your Application
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-deploy-app" class="md-nav__link">
    12. Deploy your Securely Built Application as a Hyper Protect Virtual Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-bitcoin_wallet" class="md-nav__link">
    13. Welcome to the Secure Bitcoin Wallet on IBM LinuxONE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-cleanup" class="md-nav__link">
    14. Clean up your Environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#glossary" class="md-nav__link">
    15. Glossary of terms
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    16. Other resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proposechange" class="md-nav__link">
    17. Propose a change
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    1. Home
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assignment" class="md-nav__link">
    2. Lab Assignments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-grep11-lab" class="md-nav__link">
    I. GREP11 Lab
  </a>
  
    <nav class="md-nav" aria-label="I. GREP11 Lab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grep11-lab-overview" class="md-nav__link">
    3. Lab overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grep11-lab-grep11-setup" class="md-nav__link">
    4. How to set up a GREP11 server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grep11-lab-grep11-display" class="md-nav__link">
    5. Displaying your GREP11 environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grep11-lab-run-grep11-samples" class="md-nav__link">
    6. Run the GREP11 sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-secure-image-build-lab" class="md-nav__link">
    II. Secure Image Build Lab
  </a>
  
    <nav class="md-nav" aria-label="II. Secure Image Build Lab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    7. Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-overview" class="md-nav__link">
    8. Hyper Protect Virtual Servers (HPVS) Lab Process Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-securebuild-setup" class="md-nav__link">
    9. Configuring your Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-create-server" class="md-nav__link">
    10. Create your HPVS Secure Build Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-build" class="md-nav__link">
    11. Securely Build your Application
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-deploy-app" class="md-nav__link">
    12. Deploy your Securely Built Application as a Hyper Protect Virtual Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-bitcoin_wallet" class="md-nav__link">
    13. Welcome to the Secure Bitcoin Wallet on IBM LinuxONE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securebuild-lab-cleanup" class="md-nav__link">
    14. Clean up your Environment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#glossary" class="md-nav__link">
    15. Glossary of terms
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    16. Other resources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proposechange" class="md-nav__link">
    17. Propose a change
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-hyper-protect-virtual-servers-wildfire-workshop">Hyper Protect Virtual Servers Wildfire Workshop<a class="headerlink" href="#index-hyper-protect-virtual-servers-wildfire-workshop" title="Permanent link">&para;</a></h1>
<p>Welcome to our Hyper Protect Virtual Servers workshop. IBM Hyper Protect Virtual Servers protect Linux® workloads on IBM Z® and LinuxONE throughout the application lifecycle – from build through to deploy and manage. Now you can be confident that applications and data are private and protected from a variety of internal and external threats. This workshop provides a primer on Hyper Protect Virtual Servers and practical use cases relevant to the enterprise. In addition, you will gain hands-on experience with IBM’s unique secure image build process to build a secure image and deploy it inside a FIPS 197-compliant protected memory enclave. Next, you will learn about Hyper Protect Virtual Servers' crypto service built on a FIPS 140-2 Level 4-compliant HSM. Lastly, you will gain hands-on experience exploiting the crypto service.</p>
<h2 id="index-agenda">Agenda<a class="headerlink" href="#index-agenda" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="../HPVS-Intro-December2020.pdf">Introduction to Hyper Protect Virtual Servers</a></li>
<li><a href="../HPVS-Intro-December2020.pdf">Hyper Protect Use Cases &amp; Demo</a></li>
<li><a href="../HPVS-Infra-Intro.pdf">Hyper Protect Virtual Servers infrastructure overview</a></li>
<li><a href="../GREP11-Intro.pdf">Introduction to HSM-backed Crypto Service</a></li>
<li><a href="#grep11-lab-overview">Lab: Crypto Service Exploitation</a></li>
<li><a href="#securebuild-lab-overview">Introduction to the Secure Image Build Process</a></li>
<li><a href="#securebuild-lab-overview">Lab: Build and Deploy Your First Hyper Protect Virtual Server Image</a></li>
<li>Next Steps on Your Journey &amp; Wrap Up</li>
</ul>
<h2 id="index-acknowledgements">Acknowledgements<a class="headerlink" href="#index-acknowledgements" title="Permanent link">&para;</a></h2>
<ul>
<li>Thanks to the following contributors: <a href="mailto:jnburges@us.ibm.com">Jasmine Burgess</a></li>
</ul>
<h2 id="index-workshop-owners">Workshop owners<a class="headerlink" href="#index-workshop-owners" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="mailto:silliman@us.ibm.com">Barry Silliman</a></li>
<li><a href="mailto:garrett.lee.woodworth@ibm.com">Garrett Woodworth</a></li>
<li><a href="mailto:jinxiong@us.ibm.com">Jin VanStee</a></li>
</ul></section><section class="print-page" id="assignment"><h1 id="assignment-lab-assignments">Lab Assignments<a class="headerlink" href="#assignment-lab-assignments" title="Permanent link">&para;</a></h1>
<p>You will need to enter the "Skytap Password" one time only (assuming you don't switch browsers or clear cache).</p>
<p>If your Ubuntu desktop asks for a login password for userid <em>hyper-protect-lab</em>, the password, for all teams, will be provided by an instructor in the WebEx meeting chat. Your desktop will lock and ask for this password if your session is idle for one hour.</p>
<p>Your two-digit team number will be used in the <em>Secure Image Build</em> lab in <a href="#securebuild-lab-create-server-set-your-provided-number-and-save-it-for-later-use">Step 1 here</a> . You must use both digits, including the leading zero (for teams 01-09).</p>
<table>
<thead>
<tr>
<th align="center">Name</th>
<th align="center">Team Number</th>
<th align="center">Skytap URL</th>
<th align="center">Skytap Password</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">TBD</td>
<td align="center">01</td>
<td align="center"><a href="http://ibm.biz/hpvsteam01" target="_new">http://ibm.biz/hpvsteam01</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">02</td>
<td align="center"><a href="http://ibm.biz/hpvsteam02" target="_new">http://ibm.biz/hpvsteam02</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">03</td>
<td align="center"><a href="http://ibm.biz/hpvsteam03" target="_new">http://ibm.biz/hpvsteam03</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">04</td>
<td align="center"><a href="http://ibm.biz/hpvsteam04" target="_new">http://ibm.biz/hpvsteam04</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">05</td>
<td align="center"><a href="http://ibm.biz/hpvsteam05" target="_new">http://ibm.biz/hpvsteam05</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">06</td>
<td align="center"><a href="http://ibm.biz/hpvsteam06" target="_new">http://ibm.biz/hpvsteam06</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">07</td>
<td align="center"><a href="http://ibm.biz/hpvsteam07" target="_new">http://ibm.biz/hpvsteam07</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">08</td>
<td align="center"><a href="http://ibm.biz/hpvsteam08" target="_new">http://ibm.biz/hpvsteam08</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">09</td>
<td align="center"><a href="http://ibm.biz/hpvsteam09" target="_new">http://ibm.biz/hpvsteam09</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">10</td>
<td align="center"><a href="http://ibm.biz/hpvsteam10" target="_new">http://ibm.biz/hpvsteam10</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">11</td>
<td align="center"><a href="http://ibm.biz/hpvsteam11" target="_new">http://ibm.biz/hpvsteam11</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">12</td>
<td align="center"><a href="http://ibm.biz/hpvsteam12" target="_new">http://ibm.biz/hpvsteam12</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">13</td>
<td align="center"><a href="http://ibm.biz/hpvsteam13" target="_new">http://ibm.biz/hpvsteam13</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">14</td>
<td align="center"><a href="http://ibm.biz/hpvsteam14" target="_new">http://ibm.biz/hpvsteam14</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">15</td>
<td align="center"><a href="http://ibm.biz/hpvsteam15" target="_new">http://ibm.biz/hpvsteam15</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">16</td>
<td align="center"><a href="http://ibm.biz/hpvsteam16" target="_new">http://ibm.biz/hpvsteam16</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">17</td>
<td align="center"><a href="http://ibm.biz/hpvsteam17" target="_new">http://ibm.biz/hpvsteam17</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">18</td>
<td align="center"><a href="http://ibm.biz/hpvsteam18" target="_new">http://ibm.biz/hpvsteam18</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">19</td>
<td align="center"><a href="http://ibm.biz/hpvsteam19" target="_new">http://ibm.biz/hpvsteam19</a></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">TBD</td>
<td align="center">20</td>
<td align="center"><a href="http://ibm.biz/hpvsteam20" target="_new">http://ibm.biz/hpvsteam20</a></td>
<td align="center"></td>
</tr>
</tbody>
</table></section>
                        <h1 class='nav-section-title' id='section-grep11-lab'>
                            GREP11 Lab <a class='headerlink' href='#section-grep11-lab' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="grep11-lab-overview"><h1 id="grep11-lab-overview-grep11-lab-overview">GREP11 Lab Overview<a class="headerlink" href="#grep11-lab-overview-grep11-lab-overview" title="Permanent link">&para;</a></h1>
<h2 id="grep11-lab-overview-grep11-overview">GREP11 Overview<a class="headerlink" href="#grep11-lab-overview-grep11-overview" title="Permanent link">&para;</a></h2>
<p>In this lab you will be working with the GREP11 feature of the <a href="https://www.ibm.com/support/knowledgecenter/SSHPMH_1.2.x/kc_welcome_page.html" target="_blank">Hyper Protect Virtual Servers on-premises</a> offering.</p>
<p>GREP11 is a shorthand term for <em>gRPC protocol-based Enterprise PKCS#11</em>.</p>
<p>PKCS #11 refers to the <a href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/pkcs11-base-v2.40.html" target="_blank">Public Key Cryptography Standard #11 Cryptographic Token Interface</a>, which is a standard for devices that hold cryptographic information and perform cryptographic functions.</p>
<p><a href="https://grpc.io/" target="_blank">gRPC</a> stands for Google Remote Procedure Call, which is a protocol developed by Google, and contributed to open source. gRPC uses HTTP/2 for its transport protocol.</p>
<p><em>Enterprise PKCS#11</em>, often referred to as <em>EP11</em>, refers to <a href="http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf" target="_blank">IBM's library</a>, designed for enterprise usage, that is very similar to the PKCS #11 standard. </p>
<p>The PKCS #11 standard covers the following cryptographic categories, and the GREP11 library provides functions in each of these categories:</p>
<ol>
<li>Encryption</li>
<li>Decryption</li>
<li>Message digests (also known as hashes)</li>
<li>Signing and MACing (Message Authentication Codes)</li>
<li>Verifying signatures and MACs</li>
<li>Key Management- creating symmetric keys, creating asymmetric keys, wrapping and unwrapping keys, and deriving keys from other keys</li>
<li>Random number generation - strictly speaking not a cryptographic operation unto itself, but random numbers are often used in cryptographic operations</li>
</ol>
<h2 id="grep11-lab-overview-lab-environment">Lab Environment<a class="headerlink" href="#grep11-lab-overview-lab-environment" title="Permanent link">&para;</a></h2>
<p>You will be working with the Hyper Protect Virtual Servers command line interface (CLI) running on an x86_64 virtual machine running the Ubuntu 18.04.5 Linux distribution. You will also be using this virtual machine to run programs, written in the Go programming language, that will communicate with the GREP11 server. This virtual machine is provisioned on SkyTap in the IBM Cloud, and you will access it through your web browser. <strong>Your instructor will provide you the information needed to access your virtual machine under separate cover.</strong></p>
<p>The GREP11 server runs as a Docker container running in Hyper Protect Virtual Servers.  Hyper Protect Virtual Servers runs in a Secure Service Container (SSC) LPAR on an IBM z15 server located in Herndon, Virginia, USA, and managed by the <em>Advanced Technology Group - IBM Z</em> team.</p>
<p>The Hyper Protect Virtual Servers LPAR is in an Advanced Technology Group private network and your Ubuntu virtual machine communicates with it through a VPN connection. <strong>Your instructor will provide you the information needed to establish a VPN connection under separate cover.</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The client program code used in this lab could also be run on the s390x architecture.  IBM provides sample client code, which connects to a GREP11 Server, in two programming lanugages - <a href="https://golang.org" target="_blank">Go</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript" target="_blank">JavaScript</a>, both of which are supported on s390x.
This lab will utilize client code written in Go.</p>
</div>
<p>The following diagram summarizes the data flow from the client application you will be running in this lab, to the GREP11 server which runs in the Hyper Protect Virtual Servers LPAR on an IBM Z or LinuxONE server, through kernel calls that call the cryptographic device driver (represented by <em>/dev/ap</em> in the drawing) which then accesses the Crypto Express 7S card through the PCIe bus.</p>
<p><img alt="GREP11 flow" src="../grep11-lab/images/grep11-000_flow.png" /></p>
<p>There is no inherent significance to the highlighted boxes in the drawing.  We highlighted the client application box to point out that the client application does not have to reside on the same host as the GREP11 server.  We highlighted the Go box since we will be working with the Go language GREP11 client in this lab and not the JavaScript GREP11 client. We highlighted GRPC just because, well, the <em>G</em> in GREP11 stands for gRPC.  <img alt="😄" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f604.svg" title=":smile:" /></p>
<h2 id="grep11-lab-overview-what-has-been-done-for-you-already">What has been done for you already<a class="headerlink" href="#grep11-lab-overview-what-has-been-done-for-you-already" title="Permanent link">&para;</a></h2>
<p>Our starting point for the lab is having the GREP11 servers running on our Hyper Protect Virtual Servers LPAR. Each GREP11 server is connected to a single domain on an <a href="https://www.ibm.com/security/cryptocards/pciecc4/overview" target="_blank">IBM Crypto Express 7S</a> card that is configured to our LPAR. Our Hyper Protect Virtual Servers LPAR has two Crypto Expess 7S cards configured to it, with one domain on each card dedicated to our LPAR.  So, with only two domains and many students, we had to provision the GREP11 servers ahead of time.  </p>
<p>We will describe the process of setting this up so that you will have a reference.</p>
<h2 id="grep11-lab-overview-detailed-lab-process">Detailed Lab Process<a class="headerlink" href="#grep11-lab-overview-detailed-lab-process" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Read about how we configured the GREP11 servers</p>
</li>
<li>
<p>Issue relevant Hyper Protect Virtual Servers CLI commands</p>
</li>
<li>
<p>Clone the GitHub repository which the lab uses</p>
</li>
<li>
<p>Run Hyper Protect Virtual Servers commands to inspect the GREP11 setup</p>
</li>
<li>
<p>Run the GREP11 samples that IBM documentation points to</p>
</li>
<li>
<p>Run custom lab exercises that go into greater depth</p>
</li>
</ol></section><section class="print-page" id="grep11-lab-grep11-setup"><h1 id="grep11-lab-grep11-setup-how-to-set-up-a-grep11-server">How to set up a GREP11 server<a class="headerlink" href="#grep11-lab-grep11-setup-how-to-set-up-a-grep11-server" title="Permanent link">&para;</a></h1>
<h2 id="grep11-lab-grep11-setup-hyper-protect-virtual-servers-lpar-setup">Hyper Protect Virtual Servers LPAR setup<a class="headerlink" href="#grep11-lab-grep11-setup-hyper-protect-virtual-servers-lpar-setup" title="Permanent link">&para;</a></h2>
<h2 id="grep11-lab-grep11-setup-note-all-commands-on-this-page-are-for-reference-only-and-not-to-be-entered-by-you-in-the-lab">NOTE: All commands on this page are for reference only and not to be entered by you in the lab<a class="headerlink" href="#grep11-lab-grep11-setup-note-all-commands-on-this-page-are-for-reference-only-and-not-to-be-entered-by-you-in-the-lab" title="Permanent link">&para;</a></h2>
<p>Hyper Protect Virtual Servers runs in an LPAR that is defined in Secure Service Container (SSC) mode. Defining an LPAR is a normal task for an IBM Z or LinuxONE systems administrator, typically performed from the Hardware Management Console (HMC).</p>
<p>The systems administrator must<sup id="fnref:1"><a class="footnote-ref" href="#grep11-lab-grep11-setup-fn:1">1</a></sup> dedicate one or more domains of one or more Crypto Express cards to the Hyper Protect Virtual Servers LPAR in order to use the GREP11 server. These Crypto Express cards must be defined in EP11 mode to your IBM Z or LinuxONE server in order to be used by a GREP11 server. 
These tasks are documented in the Hyper Protect Virtual Servers documentation, or in IBM publications referenced in the Hyper Protect Virtual Servers documentation. </p>
<p>The version of Hyper Protect Virtual Servers that we will be using in this lab is version 1.2.2.1, which was released on November 6, 2020.</p>
<p>A GREP11 server communicates with one and only one Crypto Express domain, and vice versa.  You can run multiple GREP11 servers if you have multiple domains configured to your Hyper Protect Virtual Servers LPAR.</p>
<p>The GREP11 server is stateless, so desired levels of throughput and resilience can be achieved by loading the same master key in one or more domains of one or more Crypto Express 7S cards across one or more CECs across one or more geographies.</p>
<h2 id="grep11-lab-grep11-setup-overview-of-grep11-server-setup">Overview of GREP11 server setup<a class="headerlink" href="#grep11-lab-grep11-setup-overview-of-grep11-server-setup" title="Permanent link">&para;</a></h2>
<p>This section provides an overview of what the remaining sections of this page will discuss in detail.</p>
<p>The following steps are required:</p>
<ol>
<li>
<p>Create a Certification Authority (CA) certificate and key</p>
</li>
<li>
<p>Create a GREP11 server X.509 certificate for <a href="https://tools.ietf.org/html/rfc8446" target="_blank">Transport Layer Security (TLS)</a> authentication</p>
</li>
<li>
<p>Create an X.509 certificate for your client application for TLS authentication</p>
</li>
<li>
<p>List Crypto Domains on your Hyper Protect Virtual Servers LPAR</p>
</li>
<li>
<p>Create <a href="https://yaml.org/" target="_blank">YAML</a> and/or <a href="https://www.json.org/" target="_blank">JSON</a> configuration files for GREP11 server initialization</p>
</li>
<li>
<p>Start the GREP11 server</p>
</li>
</ol>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>The commands shown on this page are for reference only</strong>- they have already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<h2 id="grep11-lab-grep11-setup-create-a-certification-authority-ca-certificate-and-key">Create a Certification Authority (CA) certificate and key<a class="headerlink" href="#grep11-lab-grep11-setup-create-a-certification-authority-ca-certificate-and-key" title="Permanent link">&para;</a></h2>
<p>The <em>openssl</em> utility is used to generate a private key and a certificate that will act as a certification authority (CA). This will be used in later steps to issue certificates for the GREP11 server and for the client application which will connect to the GREP11 server.</p>
<p>Whenever you browse the web to a site with <em>https</em>, the server presents its certificate to your browser. This is known as <em>server-side</em> or <em>one-way</em> TLS authentication.  Most websites do not ask you to present a certificate. The website makes itself available to anybody who browses to it. </p>
<p>With mutual TLS authentication, the client does need to present a certificate.  The server will only establish a session with a client who presents a certificate that is trusted by the server. This prevents our GREP11 server from being used by unauthorized clients.</p>
<p>The following command was used to create the RSA private key which will be used by our soon to be created CA</p>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>genrsa<span class="w"> </span>-out<span class="w"> </span>atgz-hpvs-ca.key<span class="w"> </span><span class="m">2048</span>
</code></pre></div>
<p>This created a file named <code>atgz-hpvs-ca.key</code> which is an RSA private key.  </p>
<p>In most cases (and mandatory from PKCS #11 version 2.4 onwards) the RSA private key contains enough information to reconstitute the public key. It is for this reason that the private key is used as input to the following command, which will create a Certification Authority X.509 certificate. X.509 certificates contain information identifying the certificate holder, the attributes of the certificate, including what the certificate can be used for, and, importantly, the public key.  </p>
<p>We used this command to create this certificate.</p>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-x509<span class="w"> </span>-key<span class="w"> </span>atgz-hpvs-ca.key<span class="w"> </span>-out<span class="w"> </span>atgz-hpvs-ca.pem
</code></pre></div>
<p>The <code>atgz-hpvs-ca.key</code> file was input to this command, and the <code>atgz-hpvs-ca.pem</code> file is the output of this command.  This <code>atgz-hpvs-ca.pem</code> file is our "homegrown" certification authority root certificate.  </p>
<p>I will use the Linux <code>cat</code> command to get a raw listing of the root certificate we just created:</p>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>atgz-hpvs-ca.pem
</code></pre></div>
<details class="example">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code>-----BEGIN CERTIFICATE-----
MIIEMzCCAxugAwIBAgIUallVg6GrWPfoiwwUcCBdB+f7kPQwDQYJKoZIhvcNAQEL
BQAwgagxCzAJBgNVBAYTAlVTMREwDwYDVQQIDAhWaXJnaW5pYTEQMA4GA1UEBwwH
SGVybmRvbjEMMAoGA1UECgwDSUJNMSowKAYDVQQLDCFBZHZhbmNlZCBUZWNobm9s
b2d5IEdyb3VwIC0gSUJNIFoxFjAUBgNVBAMMDUFURy1aIEhQVlMgQ0ExIjAgBgkq
hkiG9w0BCQEWE3NpbGxpbWFuQHVzLmlibS5jb20wHhcNMjAxMjEwMTkyODI4WhcN
MjIwMTA5MTkyODI4WjCBqDELMAkGA1UEBhMCVVMxETAPBgNVBAgMCFZpcmdpbmlh
MRAwDgYDVQQHDAdIZXJuZG9uMQwwCgYDVQQKDANJQk0xKjAoBgNVBAsMIUFkdmFu
Y2VkIFRlY2hub2xvZ3kgR3JvdXAgLSBJQk0gWjEWMBQGA1UEAwwNQVRHLVogSFBW
UyBDQTEiMCAGCSqGSIb3DQEJARYTc2lsbGltYW5AdXMuaWJtLmNvbTCCASIwDQYJ
KoZIhvcNAQEBBQADggEPADCCAQoCggEBAMAUfJAKBdbbCMn0N9DHvA4Chz/ihBBU
xsCaTAUmJpVzDjv49rYTXY9YcxQpNYKyexsKjDlCfr+9gNlus1tKU0CrZD63ZLiA
JCZZoomIZOoZQNquhj5f46/9x2d299FHxKY5z729hbHhHbjD+UkG60inyxS6Qm42
OaILx8bjrrcHyOzhwKn4zm3RsaEOWcgqJP8yQvH8Bm7UElmKLADI5Ngp/+WWvNFE
+QeXfYmKUSpLaJ0/4BD54Bbk780RSyOohvjv1O/JaLdHRXrJUYMSNNYQ3oK/7qRM
CjOBnuaFY9FSdaGNvY2vS5vM44TaCy5DyMZ1GLCrCb9y13TvEVA9jFMCAwEAAaNT
MFEwHQYDVR0OBBYEFN7BgpkfqiCTKIp/9JglwCDDgGJ5MB8GA1UdIwQYMBaAFN7B
gpkfqiCTKIp/9JglwCDDgGJ5MA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQEL
BQADggEBALFAM8/LQ9lkBAih7M6HrKR3efKh/Aj0UgRP6iYpprpW2H88Osw0lEnD
ZZ2CTKeaHMDFHBUHapprLM3B0UnE/hchMxb4xQKihls6MRk9w3ZlZdUseStLYbS5
LHkZWr2VnTjMg5n6QRaVEbJ/BE/65uzXAJ+3TukSRjeqnJUQlmOy+j3t6/hnuVhd
5t9FI3bbF5Qi4ZpwpBnaAH74MMu/fvh7MXjUcwxgHOIvnY204FoNB5koGc4S0OK+
sJ+dnL8L7J8Lq9mvi2+SmpU6lmWfAW09R5WsPomYIWKyTTplpt+4qJah87A4OSyJ
mgvWNcD4Irl+wTtS0FixMdiLA5Z2+n0=
-----END CERTIFICATE-----
</code></pre></div>
</details>
<p>The first and last lines are meant to assure you that this is a certificate, but the lines in between are less insightful, as it is <a href="https://en.wikipedia.org/wiki/Base64" target="_blank">base64-encoded</a> binary data. Fortunately the <em>openssl</em> utility comes to our rescue and allows us to print the certificate in a form that a human can hope to understand:</p>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>x509<span class="w"> </span>-in<span class="w"> </span>atgz-hpvs-ca.pem<span class="w"> </span>-text
</code></pre></div>
<details class="example">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code>Certificate:
<span class="w">    </span>Data:
<span class="w">        </span>Version:<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">(</span>0x2<span class="o">)</span>
<span class="w">        </span>Serial<span class="w"> </span>Number:
<span class="w">            </span>6a:59:55:83:a1:ab:58:f7:e8:8b:0c:14:70:20:5d:07:e7:fb:90:f4
<span class="w">        </span>Signature<span class="w"> </span>Algorithm:<span class="w"> </span>sha256WithRSAEncryption
<span class="w">        </span>Issuer:<span class="w"> </span><span class="nv">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>US,<span class="w"> </span><span class="nv">ST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Virginia,<span class="w"> </span><span class="nv">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Herndon,<span class="w"> </span><span class="nv">O</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>IBM,<span class="w"> </span><span class="nv">OU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Advanced<span class="w"> </span>Technology<span class="w"> </span>Group<span class="w"> </span>-<span class="w"> </span>IBM<span class="w"> </span>Z,<span class="w"> </span><span class="nv">CN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ATG-Z<span class="w"> </span>HPVS<span class="w"> </span>CA,<span class="w"> </span><span class="nv">emailAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>silliman@us.ibm.com
<span class="w">        </span>Validity
<span class="w">            </span>Not<span class="w"> </span>Before:<span class="w"> </span>Dec<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">19</span>:28:28<span class="w"> </span><span class="m">2020</span><span class="w"> </span>GMT
<span class="w">            </span>Not<span class="w"> </span>After<span class="w"> </span>:<span class="w"> </span>Jan<span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="m">19</span>:28:28<span class="w"> </span><span class="m">2022</span><span class="w"> </span>GMT
<span class="w">        </span>Subject:<span class="w"> </span><span class="nv">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>US,<span class="w"> </span><span class="nv">ST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Virginia,<span class="w"> </span><span class="nv">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Herndon,<span class="w"> </span><span class="nv">O</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>IBM,<span class="w"> </span><span class="nv">OU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Advanced<span class="w"> </span>Technology<span class="w"> </span>Group<span class="w"> </span>-<span class="w"> </span>IBM<span class="w"> </span>Z,<span class="w"> </span><span class="nv">CN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ATG-Z<span class="w"> </span>HPVS<span class="w"> </span>CA,<span class="w"> </span><span class="nv">emailAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>silliman@us.ibm.com
<span class="w">        </span>Subject<span class="w"> </span>Public<span class="w"> </span>Key<span class="w"> </span>Info:
<span class="w">            </span>Public<span class="w"> </span>Key<span class="w"> </span>Algorithm:<span class="w"> </span>rsaEncryption
<span class="w">                </span>RSA<span class="w"> </span>Public-Key:<span class="w"> </span><span class="o">(</span><span class="m">2048</span><span class="w"> </span>bit<span class="o">)</span>
<span class="w">                </span>Modulus:
<span class="w">                    </span><span class="m">00</span>:c0:14:7c:90:0a:05:d6:db:08:c9:f4:37:d0:c7:
<span class="w">                    </span>bc:0e:02:87:3f:e2:84:10:54:c6:c0:9a:4c:05:26:
<span class="w">                    </span><span class="m">26</span>:95:73:0e:3b:f8:f6:b6:13:5d:8f:58:73:14:29:
<span class="w">                    </span><span class="m">35</span>:82:b2:7b:1b:0a:8c:39:42:7e:bf:bd:80:d9:6e:
<span class="w">                    </span>b3:5b:4a:53:40:ab:64:3e:b7:64:b8:80:24:26:59:
<span class="w">                    </span>a2:89:88:64:ea:19:40:da:ae:86:3e:5f:e3:af:fd:
<span class="w">                    </span>c7:67:76:f7:d1:47:c4:a6:39:cf:bd:bd:85:b1:e1:
<span class="w">                    </span>1d:b8:c3:f9:49:06:eb:48:a7:cb:14:ba:42:6e:36:
<span class="w">                    </span><span class="m">39</span>:a2:0b:c7:c6:e3:ae:b7:07:c8:ec:e1:c0:a9:f8:
<span class="w">                    </span>ce:6d:d1:b1:a1:0e:59:c8:2a:24:ff:32:42:f1:fc:
<span class="w">                    </span><span class="m">06</span>:6e:d4:12:59:8a:2c:00:c8:e4:d8:29:ff:e5:96:
<span class="w">                    </span>bc:d1:44:f9:07:97:7d:89:8a:51:2a:4b:68:9d:3f:
<span class="w">                    </span>e0:10:f9:e0:16:e4:ef:cd:11:4b:23:a8:86:f8:ef:
<span class="w">                    </span>d4:ef:c9:68:b7:47:45:7a:c9:51:83:12:34:d6:10:
<span class="w">                    </span>de:82:bf:ee:a4:4c:0a:33:81:9e:e6:85:63:d1:52:
<span class="w">                    </span><span class="m">75</span>:a1:8d:bd:8d:af:4b:9b:cc:e3:84:da:0b:2e:43:
<span class="w">                    </span>c8:c6:75:18:b0:ab:09:bf:72:d7:74:ef:11:50:3d:
<span class="w">                    </span>8c:53
<span class="w">                </span>Exponent:<span class="w"> </span><span class="m">65537</span><span class="w"> </span><span class="o">(</span>0x10001<span class="o">)</span>
<span class="w">        </span>X509v3<span class="w"> </span>extensions:
<span class="hll"><span class="w">            </span>X509v3<span class="w"> </span>Subject<span class="w"> </span>Key<span class="w"> </span>Identifier:<span class="w"> </span>
</span><span class="hll"><span class="w">                </span>DE:C1:82:99:1F:AA:20:93:28:8A:7F:F4:98:25:C0:20:C3:80:62:79
</span><span class="hll"><span class="w">            </span>X509v3<span class="w"> </span>Authority<span class="w"> </span>Key<span class="w"> </span>Identifier:<span class="w"> </span>
</span><span class="hll"><span class="w">                </span>keyid:DE:C1:82:99:1F:AA:20:93:28:8A:7F:F4:98:25:C0:20:C3:80:62:79
</span>
<span class="hll"><span class="w">            </span>X509v3<span class="w"> </span>Basic<span class="w"> </span>Constraints:<span class="w"> </span>critical
</span><span class="hll"><span class="w">                </span>CA:TRUE
</span><span class="w">    </span>Signature<span class="w"> </span>Algorithm:<span class="w"> </span>sha256WithRSAEncryption
<span class="w">        </span>b1:40:33:cf:cb:43:d9:64:04:08:a1:ec:ce:87:ac:a4:77:79:
<span class="w">        </span>f2:a1:fc:08:f4:52:04:4f:ea:26:29:a6:ba:56:d8:7f:3c:3a:
<span class="w">        </span>cc:34:94:49:c3:65:9d:82:4c:a7:9a:1c:c0:c5:1c:15:07:6a:
<span class="w">        </span>9a:6b:2c:cd:c1:d1:49:c4:fe:17:21:33:16:f8:c5:02:a2:86:
<span class="w">        </span>5b:3a:31:19:3d:c3:76:65:65:d5:2c:79:2b:4b:61:b4:b9:2c:
<span class="w">        </span><span class="m">79</span>:19:5a:bd:95:9d:38:cc:83:99:fa:41:16:95:11:b2:7f:04:
<span class="w">        </span>4f:fa:e6:ec:d7:00:9f:b7:4e:e9:12:46:37:aa:9c:95:10:96:
<span class="w">        </span><span class="m">63</span>:b2:fa:3d:ed:eb:f8:67:b9:58:5d:e6:df:45:23:76:db:17:
<span class="w">        </span><span class="m">94</span>:22:e1:9a:70:a4:19:da:00:7e:f8:30:cb:bf:7e:f8:7b:31:
<span class="w">        </span><span class="m">78</span>:d4:73:0c:60:1c:e2:2f:9d:8d:b4:e0:5a:0d:07:99:28:19:
<span class="w">        </span>ce:12:d0:e2:be:b0:9f:9d:9c:bf:0b:ec:9f:0b:ab:d9:af:8b:
<span class="w">        </span>6f:92:9a:95:3a:96:65:9f:01:6d:3d:47:95:ac:3e:89:98:21:
<span class="w">        </span><span class="m">62</span>:b2:4d:3a:65:a6:df:b8:a8:96:a1:f3:b0:38:39:2c:89:9a:
<span class="w">        </span>0b:d6:35:c0:f8:22:b9:7e:c1:3b:52:d0:58:b1:31:d8:8b:03:
<span class="w">        </span><span class="m">96</span>:76:fa:7d
-----BEGIN<span class="w"> </span>CERTIFICATE-----
MIIEMzCCAxugAwIBAgIUallVg6GrWPfoiwwUcCBdB+f7kPQwDQYJKoZIhvcNAQEL
BQAwgagxCzAJBgNVBAYTAlVTMREwDwYDVQQIDAhWaXJnaW5pYTEQMA4GA1UEBwwH
SGVybmRvbjEMMAoGA1UECgwDSUJNMSowKAYDVQQLDCFBZHZhbmNlZCBUZWNobm9s
b2d5IEdyb3VwIC0gSUJNIFoxFjAUBgNVBAMMDUFURy1aIEhQVlMgQ0ExIjAgBgkq
hkiG9w0BCQEWE3NpbGxpbWFuQHVzLmlibS5jb20wHhcNMjAxMjEwMTkyODI4WhcN
MjIwMTA5MTkyODI4WjCBqDELMAkGA1UEBhMCVVMxETAPBgNVBAgMCFZpcmdpbmlh
MRAwDgYDVQQHDAdIZXJuZG9uMQwwCgYDVQQKDANJQk0xKjAoBgNVBAsMIUFkdmFu
Y2VkIFRlY2hub2xvZ3kgR3JvdXAgLSBJQk0gWjEWMBQGA1UEAwwNQVRHLVogSFBW
UyBDQTEiMCAGCSqGSIb3DQEJARYTc2lsbGltYW5AdXMuaWJtLmNvbTCCASIwDQYJ
KoZIhvcNAQEBBQADggEPADCCAQoCggEBAMAUfJAKBdbbCMn0N9DHvA4Chz/ihBBU
xsCaTAUmJpVzDjv49rYTXY9YcxQpNYKyexsKjDlCfr+9gNlus1tKU0CrZD63ZLiA
JCZZoomIZOoZQNquhj5f46/9x2d299FHxKY5z729hbHhHbjD+UkG60inyxS6Qm42
OaILx8bjrrcHyOzhwKn4zm3RsaEOWcgqJP8yQvH8Bm7UElmKLADI5Ngp/+WWvNFE
+QeXfYmKUSpLaJ0/4BD54Bbk780RSyOohvjv1O/JaLdHRXrJUYMSNNYQ3oK/7qRM
CjOBnuaFY9FSdaGNvY2vS5vM44TaCy5DyMZ1GLCrCb9y13TvEVA9jFMCAwEAAaNT
MFEwHQYDVR0OBBYEFN7BgpkfqiCTKIp/9JglwCDDgGJ5MB8GA1UdIwQYMBaAFN7B
gpkfqiCTKIp/9JglwCDDgGJ5MA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQEL
BQADggEBALFAM8/LQ9lkBAih7M6HrKR3efKh/Aj0UgRP6iYpprpW2H88Osw0lEnD
ZZ2CTKeaHMDFHBUHapprLM3B0UnE/hchMxb4xQKihls6MRk9w3ZlZdUseStLYbS5
LHkZWr2VnTjMg5n6QRaVEbJ/BE/65uzXAJ+3TukSRjeqnJUQlmOy+j3t6/hnuVhd
5t9FI3bbF5Qi4ZpwpBnaAH74MMu/fvh7MXjUcwxgHOIvnY204FoNB5koGc4S0OK+
sJ+dnL8L7J8Lq9mvi2+SmpU6lmWfAW09R5WsPomYIWKyTTplpt+4qJah87A4OSyJ
mgvWNcD4Irl+wTtS0FixMdiLA5Z2+n0<span class="o">=</span>
-----END<span class="w"> </span>CERTIFICATE-----
</code></pre></div>
</details>
<p>A few lines of the output above have been highlighted. Notice the highlighted line that says <code>CA: TRUE</code>. This attribute indicates that this certificate is acting as a certification authority and can issue other certificates. Notice the lines above it which have values for <em>Subject Key Identifier</em> and <em>Authority Key Identifier</em>.  Subject Key Identifier is the identity of the holder of the certificate.  Authority Key Identifier is the identity of the issuer of the certificate. You can see that the values for these are the same.  This is known as a <em>self-signed certificate</em>.  Certification authorities (CA) exist in a hierarchy-  one CA can issue a certificate to another CA with the <em>CA: TRUE</em> attribute, and so forth.  In our lab we have this single, homegrown certification authority that we created, with its self-signed certificate that we created per the instructions in the Hyper Protect Virtual Servers documentation. </p>
<h2 id="grep11-lab-grep11-setup-create-a-grep11-server-x509-certificate-for-tls-authentication">Create a GREP11 server X.509 certificate for TLS authentication<a class="headerlink" href="#grep11-lab-grep11-setup-create-a-grep11-server-x509-certificate-for-tls-authentication" title="Permanent link">&para;</a></h2>
<p>Once we created a "homegrown" certification authority, we next created an X.509 certificate for our GREP11 server. This certificate was issued by our certification authority.</p>
<p>The first step was to create another RSA private key that our GREP11 server will use:</p>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>genrsa<span class="w"> </span>-out<span class="w"> </span>grep11-server79-9876-key.pem<span class="w"> </span><span class="m">2048</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The value of the <code>-out</code> argument, <code>grep11-server79-9876-key.pem</code> can be whatever you want it to be. I named it what I did for a reason.  The <em>79</em> in <em>server79</em> is for the last octet of my Hyper Protect Virtual Servers LPAR's IP adresss, 192.168.22.79, and I intend to use this certificate for a GREP11 server listening on port 9876 on one of the LPAR's Crypto Express 7S domains.</p>
</div>
<p>Then, this private key was used as input to <em>openssl</em> in order to create a <em>certificate signing request</em>:</p>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-key<span class="w"> </span>grep11-server79-9876-key.pem<span class="w"> </span>-out<span class="w"> </span>grep11-server79-9876.csr
</code></pre></div>
<p>The certificate signing request will be passed to our certification authority which will use the information to create an X.509 certificate.  We used <em>openssl</em> for this, too:</p>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>x509<span class="w"> </span>-sha256<span class="w"> </span>-req<span class="w"> </span>-in<span class="w"> </span>grep11-server79-9876.csr<span class="w"> </span>-CA<span class="w"> </span>atgz-hpvs-ca.pem<span class="w"> </span>-CAkey<span class="w"> </span>atgz-hpvs-ca.key<span class="w"> </span>-set_serial<span class="w"> </span><span class="m">8086</span><span class="w"> </span>-extfile<span class="w"> </span>openssl.cnf<span class="w"> </span>-extensions<span class="w"> </span>server<span class="w"> </span>-days<span class="w"> </span><span class="m">365</span><span class="w"> </span>-outform<span class="w"> </span>PEM<span class="w"> </span>-out<span class="w"> </span>grep11-server79-9876.pem
</code></pre></div>
<p>The file name of the certificate that was created by the preceding command is the value of the <code>-out</code> argument, <code>grep11-server79-9876.pem</code>.  <code>openssl</code> allows us to list this certificate in human-friendly form:</p>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>x509<span class="w"> </span>-in<span class="w"> </span>grep11-server79-9876.pem<span class="w"> </span>-noout<span class="w"> </span>-text
</code></pre></div>
<details class="example">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code>Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 8086 (0x1f96)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: C = US, ST = Virginia, L = Herndon, O = IBM, OU = Advanced Technology Group - IBM Z, CN = ATG-Z HPVS CA, emailAddress = silliman@us.ibm.com
        Validity
            Not Before: Dec 10 19:28:28 2020 GMT
            Not After : Jan  4 19:28:28 2022 GMT
        Subject: C = US, ST = Virginia, L = Herndon, O = IBM, OU = Advanced Technology Group - IBM Z, CN = 192.168.22.79
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (2048 bit)
                Modulus:
                    00:d9:c4:97:86:cc:d9:a8:d7:0e:e4:d5:7e:6a:97:
                    e6:03:f4:85:4c:4d:2f:c5:bc:1e:88:da:ab:31:68:
                    3b:1b:b7:eb:ae:81:a6:0f:34:1f:b0:90:bb:a7:1a:
                    7a:2c:c1:6b:be:b6:8b:9d:b4:b8:71:78:ff:fb:84:
                    61:c4:22:4e:8f:42:52:90:15:de:58:c8:1f:3d:5d:
                    3c:15:c7:9f:9d:bb:13:c4:0c:d8:a1:53:83:56:18:
                    ec:75:fd:69:5a:f4:ed:6e:61:5e:f0:1b:57:58:7c:
                    89:28:5b:b7:81:c9:6d:4e:fa:63:33:a1:98:ee:7a:
                    18:5b:ad:c5:53:8a:fe:3e:c7:99:07:7f:45:e2:15:
                    fa:2a:bc:e2:eb:2a:dc:7e:38:7a:8c:ec:1f:89:b1:
                    e3:91:6f:1a:36:d3:17:03:54:c3:56:57:65:7f:d4:
                    6b:56:dc:94:21:d9:5d:43:06:26:a6:fa:48:06:85:
                    95:e9:f3:10:b3:26:cb:69:c3:67:28:d3:ef:74:40:
                    50:7b:2a:f9:56:20:79:e4:92:64:2d:ea:6b:bc:07:
                    2a:95:3e:d2:80:5e:c5:61:b7:84:ca:63:83:e0:0a:
                    67:fe:e3:9c:af:12:54:f0:22:82:b3:84:30:87:08:
                    b5:8c:bf:05:af:dd:80:94:a3:0f:39:d4:d7:2e:d5:
                    d3:e7
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Basic Constraints: 
                CA:FALSE
            X509v3 Key Usage: 
                Digital Signature, Key Encipherment, Data Encipherment
            X509v3 Extended Key Usage: 
                TLS Web Server Authentication
            Netscape Cert Type: 
                SSL Server
            X509v3 CRL Distribution Points: 

                Full Name:
                URI:http://localhost/ca.crl

            X509v3 Subject Alternative Name: 
                DNS:192.168.22.79:9876, IP Address:192.168.22.79
    Signature Algorithm: sha256WithRSAEncryption
        1f:bb:b0:26:34:62:82:62:ca:7f:1c:a6:ef:54:15:d9:44:88:
        e4:97:19:5b:2c:fc:dd:1c:01:70:ee:27:1c:ec:49:58:25:a5:
        dc:9e:9a:55:71:9b:05:bb:c1:1b:6e:85:a3:ab:9c:ce:05:bf:
        29:3b:cb:ed:98:f5:01:e8:cb:e2:e6:14:c1:74:0d:96:38:14:
        58:ca:84:ad:af:35:fd:12:50:16:10:f3:6d:c1:fe:ba:04:12:
        ea:19:17:dd:95:a8:8b:65:83:da:bc:ef:6e:23:00:2c:52:6e:
        80:af:a9:93:7a:5f:40:8d:e7:55:ea:1d:90:d8:8c:04:59:91:
        91:b4:22:19:9f:9a:b6:20:ee:36:4d:c1:75:29:54:e1:a0:47:
        cd:82:14:86:75:37:60:4e:1a:54:f5:81:ec:5a:3a:de:64:93:
        51:fb:c6:44:b1:66:d7:41:59:b6:95:27:c9:81:fc:d9:76:a5:
        f2:16:74:47:8c:c8:a3:b1:1d:f3:98:34:b1:fa:52:d9:3e:d1:
        63:8b:70:d3:a3:aa:ac:47:1c:90:13:76:df:98:47:ae:19:e2:
        c4:d5:81:eb:44:66:45:09:6a:75:c6:5f:0c:aa:e0:44:52:16:
        35:be:49:f0:10:65:3f:df:a3:50:0d:3b:ae:94:59:9c:28:a5:
        41:24:a5:45
</code></pre></div>
</details>
<h2 id="grep11-lab-grep11-setup-create-an-x509-certificate-for-your-client-application-for-tls-authentication">Create an X.509 certificate for your client application for TLS authentication<a class="headerlink" href="#grep11-lab-grep11-setup-create-an-x509-certificate-for-your-client-application-for-tls-authentication" title="Permanent link">&para;</a></h2>
<p>The client applications need a certificate that is issued by the same certification authority that the GREP11 server uses. The process is similar- create a private key, pass that as input for the creation of a certificte signing request, and then pass that to the certification authority in order to receive a certificate.  We used these commands:</p>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>genrsa<span class="w"> </span>-out<span class="w"> </span>client-key.pem<span class="w"> </span><span class="m">2048</span>
</code></pre></div>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-key<span class="w"> </span>client-key.pem<span class="w"> </span>-out<span class="w"> </span>client.csr
</code></pre></div>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>x509<span class="w"> </span>-req<span class="w"> </span>-days<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-in<span class="w"> </span>client.csr<span class="w"> </span>-CA<span class="w"> </span>ca.pem<span class="w"> </span>-CAcreateserial<span class="w"> </span>-CAkey<span class="w"> </span>ca.key<span class="w"> </span>-out<span class="w"> </span>client.pem
</code></pre></div>
<p>Here is a listing of the client certificate that you will be using in the lab. It will be configured properly for you so that your client program can present it to the GREP11 server:</p>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>x509<span class="w"> </span>-in<span class="w"> </span>client.pem<span class="w"> </span>-noout<span class="w"> </span>-text
</code></pre></div>
<details class="example">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Certificate:
    Data:
        Version: 1 (0x0)
        Serial Number:
            7a:dc:83:ab:72:46:2f:30:b9:d2:71:b4:9b:00:43:4f:53:63:a7:ce
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: C = US, ST = Virginia, L = Herndon, O = IBM, OU = Advanced Technology Group - IBM Z, CN = ATG-Z HPVS CA, emailAddress = silliman@us.ibm.com
        Validity
            Not Before: Dec 10 19:28:28 2020 GMT
            Not After : Mar 20 19:28:28 2021 GMT
<span class="hll">        Subject: C = US, ST = Virginia, L = Herndon, O = IBM, OU = Advanced Technology Group - IBM Z, CN = GREP11 Lab Student, emailAddress = silliman@us.ibm.com
</span>        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (2048 bit)
                Modulus:
                    00:d2:4f:86:c1:d6:9a:6b:f4:2c:7d:6f:91:59:b9:
                    98:12:6e:d1:5f:ea:ca:90:b4:74:0e:dd:99:ce:20:
                    ca:f6:75:df:fe:54:76:ef:fd:3a:a2:f9:cf:15:0d:
                    1e:19:5c:e5:0f:55:50:ff:64:7f:2b:a6:1f:35:8b:
                    38:f8:f4:2a:a6:c7:66:0c:ef:17:d9:40:46:fb:d1:
                    ca:28:dd:a0:6b:08:28:b9:55:95:9d:cc:67:9b:f4:
                    26:da:04:76:fb:d3:02:e3:8e:af:f7:c3:4c:01:30:
                    04:47:e3:e3:0a:58:33:47:8e:11:50:1d:1a:ca:30:
                    a8:09:76:fc:b9:a7:86:05:2b:46:44:f6:dd:48:e2:
                    5e:64:78:8b:06:42:32:5f:cf:7d:e6:80:e1:32:94:
                    6f:fe:8a:b9:f5:a1:3a:c0:d5:3a:c7:5f:4e:e3:7b:
                    2e:0f:58:a2:35:26:57:0c:0d:c7:7f:2d:8f:8c:09:
                    84:ee:eb:d4:0e:da:5a:3a:e3:09:2f:f2:be:b9:b0:
                    48:cd:c7:d0:4c:03:d6:25:68:5d:5f:7e:3a:b1:9b:
                    4b:a4:09:b3:40:30:be:6d:be:9c:de:77:e7:18:4c:
                    ff:6d:cf:70:9c:37:bd:8e:5b:6d:75:1f:a5:c2:55:
                    ec:38:25:c9:cd:38:4b:8e:63:47:63:4e:e7:90:21:
                    6b:a1
                Exponent: 65537 (0x10001)
    Signature Algorithm: sha256WithRSAEncryption
        ac:89:54:fc:40:06:1f:84:99:08:f8:70:ab:b0:24:1d:b3:6c:
        a2:86:bd:b8:82:e3:6d:aa:c1:c7:7a:b8:3c:1d:59:80:89:92:
        57:07:ca:28:cd:80:de:11:e7:ed:d9:40:29:0b:90:1a:b7:9b:
        ed:b5:15:6a:6c:1c:31:3f:82:0f:01:1f:64:05:bb:12:16:67:
        d2:b2:3d:84:ef:74:34:56:80:11:69:ab:85:5b:43:ac:ba:13:
        e2:ca:b3:12:4a:39:ff:f1:4f:47:60:e9:16:49:75:34:95:1d:
        e0:51:c4:05:96:5e:1b:50:31:cf:ba:1a:a5:e1:1f:ed:8b:62:
        84:6d:a4:f3:6c:d4:20:d1:f1:b1:6e:79:de:57:c9:93:f7:12:
        68:86:45:dd:f4:2d:a9:c9:41:b4:6c:5e:79:01:5a:91:64:a1:
        01:14:c5:81:04:fb:64:7e:d1:42:ef:2c:e8:9f:6c:ba:b9:01:
        53:4b:32:30:0f:2a:30:4d:84:d1:11:a6:b6:cc:56:58:b0:1c:
        4f:ea:dc:3e:6e:4f:60:5b:ed:a1:0d:c8:f1:6b:dc:1a:05:00:
        ad:a9:72:ce:ff:d1:d6:ae:0a:a9:56:36:5a:ab:d0:33:41:59:
        80:8f:17:90:8a:71:f6:df:bd:6c:8e:4b:10:5d:5b:8f:94:9a:
        2d:03:85:0b
</code></pre></div>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the lab, each student will use a copy of the same client certificate. In most production use cases each client would use their own certificate which uniquely identifies them.</p>
</div>
<h2 id="grep11-lab-grep11-setup-list-crypto-domains-on-your-hyper-protect-virtual-servers-lpar">List Crypto Domains on your Hyper Protect Virtual Servers LPAR<a class="headerlink" href="#grep11-lab-grep11-setup-list-crypto-domains-on-your-hyper-protect-virtual-servers-lpar" title="Permanent link">&para;</a></h2>
<p>You can list your available domains with the Hyper Protect Virtual Server CLI:</p>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The command shown below is for reference only</strong>- it has already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>crypto<span class="w"> </span>list
</code></pre></div>
<details class="example" open="open">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code> hpvs crypto list
+---------------+--------+
| CRYPTO.DOMAIN | STATUS |
+---------------+--------+
| 08.0014       | online |
| 0a.0014       | online |
+---------------+--------+
</code></pre></div>
</details>
<p>The values shown in the <strong>CRYPTO.DOMAIN</strong> column are in hexadecimal.  So, translating to decimal, our LPAR is using Crypto Express 7S cards 8 and 10, with domain 20 in both cards assigned to our LPAR.  (A Crypto Express 7S card can have up to 85 domains- think of each domain as a "virtual" Crypto Express 7S card).</p>
<h2 id="grep11-lab-grep11-setup-create-yaml-or-json-configuration-files-for-grep11-server">Create YAML or JSON configuration files for GREP11 server<a class="headerlink" href="#grep11-lab-grep11-setup-create-yaml-or-json-configuration-files-for-grep11-server" title="Permanent link">&para;</a></h2>
<p>There are two alternative ways to start your GREP11 server:</p>
<ol>
<li>Using <code>hpvs deploy</code> with a YAML file as input</li>
<li>Using <code>hpvs vs create</code> with a JSON file as input</li>
</ol>
<p>I will show both the YAML and JSON files first, then I will show both methods of starting the GREP11 server.</p>
<h3 id="grep11-lab-grep11-setup-yaml-file-for-grep11-server-configuration">YAML file for GREP11 server configuration<a class="headerlink" href="#grep11-lab-grep11-setup-yaml-file-for-grep11-server-configuration" title="Permanent link">&para;</a></h3>
<p>This is the YAML file for a GREP11 server that will listen for client connections on port 9876, and will use domain 20 (hex 14) of Crypto Express 7S card 08:</p>
<details class="example">
<summary>GREP11 server YAML configuration file</summary>
<div class="highlight"><pre><span></span><code>version:<span class="w"> </span>v1<span class="w"> </span>
<span class="c1">#</span>
<span class="c1"># use this file with the &#39;hpvs deploy&#39; command, e.g.,</span>
<span class="c1">#</span>
<span class="c1">#  hpvs deploy --config $HOME/hpvs/config/grep11/vs_grep11_79-9876.yml </span>
<span class="c1">#</span>
type:<span class="w"> </span>virtualserver
virtualservers:
-<span class="w"> </span>name:<span class="w"> </span>grep11-08-0014-9876
host:<span class="w"> </span>atgzlpar79
repoid:<span class="w"> </span>hpcsKpGrep11_runq
imagetag:<span class="w"> </span><span class="m">1</span>.2.7.3
imagefile:<span class="w"> </span>hpcsKpGrep11_runq.tar.gz
crypto:
<span class="w">    </span>crypto_matrix:
<span class="hll"><span class="w">    </span>-<span class="w"> </span><span class="m">08</span>.0014
</span>environment:
-<span class="w"> </span>key:<span class="w"> </span>EP11SERVER_EP11CRYPTO_DOMAIN
<span class="hll"><span class="w">    </span>value:<span class="w"> </span><span class="s2">&quot;08.0014&quot;</span>
</span><span class="c1">#</span>
-<span class="w"> </span>key:<span class="w"> </span>EP11SERVER_EP11CRYPTO_CONNECTION_TLS_CERTFILEBYTES
<span class="w">    </span>value:<span class="w"> </span><span class="s2">&quot;@/home/hyper-protect-lab/hpvs/config/grep11/keys/grep11-server79-9876.pem&quot;</span>
-<span class="w"> </span>key:<span class="w"> </span>EP11SERVER_EP11CRYPTO_CONNECTION_TLS_KEYFILEBYTES
<span class="w">    </span>value:<span class="w"> </span><span class="s2">&quot;@/home/hyper-protect-lab/hpvs/config/grep11/keys/grep11-server79-9876-key.pem&quot;</span>
-<span class="w"> </span>key:<span class="w"> </span>EP11SERVER_EP11CRYPTO_CONNECTION_TLS_CACERTBYTES
<span class="w">    </span>value:<span class="w"> </span><span class="s2">&quot;@/home/hyper-protect-lab/hpvs/config/grep11/keys/atgz-hpvs-ca.pem&quot;</span>
-<span class="w"> </span>key:<span class="w"> </span>EP11SERVER_EP11CRYPTO_CONNECTION_TLS_ENABLED
<span class="w">    </span>value:<span class="w"> </span><span class="s2">&quot;true&quot;</span>
-<span class="w"> </span>key:<span class="w"> </span>EP11SERVER_EP11CRYPTO_CONNECTION_TLS_MUTUAL
<span class="w">    </span>value:<span class="w"> </span><span class="s2">&quot;true&quot;</span>
-<span class="w"> </span>key:<span class="w"> </span>EP11SERVER_EP11CRYPTO_ENABLED
<span class="w">    </span>value:<span class="w"> </span><span class="s2">&quot;true&quot;</span>
-<span class="w"> </span>key:<span class="w"> </span>TLS_GRPC_CERTS_DOMAIN_CRT
<span class="w">    </span>value:<span class="w"> </span><span class="s2">&quot;\\n&quot;</span>
-<span class="w"> </span>key:<span class="w"> </span>TLS_GRPC_CERTS_DOMAIN_KEY
<span class="w">    </span>value:<span class="w"> </span><span class="s2">&quot;\\n&quot;</span>
-<span class="w"> </span>key:<span class="w"> </span>TLS_GRPC_CERTS_ROOTCA_CRT
<span class="w">    </span>value:<span class="w"> </span><span class="s2">&quot;\\n&quot;</span>
ports:
<span class="hll">-<span class="w"> </span>hostport:<span class="w"> </span><span class="m">9876</span>
</span><span class="w">    </span>protocol:<span class="w"> </span>tcp
<span class="w">    </span>containerport:<span class="w"> </span><span class="m">9876</span>
</code></pre></div>
</details>
<h3 id="grep11-lab-grep11-setup-json-file-for-grep11-server-configuration">JSON file for GREP11 server configuration<a class="headerlink" href="#grep11-lab-grep11-setup-json-file-for-grep11-server-configuration" title="Permanent link">&para;</a></h3>
<p>This is a JSON file for a GREP11 server that will listen for client connections on port 9876, and will use domain 20 (hex 14) of Crypto Express 7S card 08:</p>
<details class="example">
<summary>GREP11 server JSON configuration file</summary>
<div class="highlight"><pre><span></span><code>{
<span class="hll">&quot;EP11SERVER_EP11CRYPTO_DOMAIN&quot;:&quot;08.0014&quot;,
</span>&quot;EP11SERVER_EP11CRYPTO_CONNECTION_TLS_CERTFILEBYTES&quot;:&quot;@/home/hyper-protect-lab/hpvs/config/grep11/keys/grep11-server79-9876.pem&quot;,
&quot;EP11SERVER_EP11CRYPTO_CONNECTION_TLS_KEYFILEBYTES&quot;:&quot;@/home/hyper-protect-lab/hpvs/config/grep11/keys/grep11-server79-9876-key.pem&quot;,
&quot;EP11SERVER_EP11CRYPTO_CONNECTION_TLS_CACERTBYTES&quot;:&quot;@/home/hyper-protect-lab/hpvs/config/grep11/keys/atgz-hpvs-ca.pem&quot;,
&quot;EP11SERVER_EP11CRYPTO_CONNECTION_TLS_ENABLED&quot;:true,
&quot;EP11SERVER_EP11CRYPTO_CONNECTION_TLS_MUTUAL&quot;:true,
&quot;EP11SERVER_EP11CRYPTO_ENABLED&quot;:true,
&quot;TLS_GRPC_CERTS_DOMAIN_CRT&quot;:&quot;\\n&quot;,
&quot;TLS_GRPC_CERTS_DOMAIN_KEY&quot;:&quot;\\n&quot;,
&quot;TLS_GRPC_CERTS_ROOTCA_CRT&quot;:&quot;\\n&quot;
}
</code></pre></div>
</details>
<h2 id="grep11-lab-grep11-setup-start-the-grep11-server">Start the GREP11 server<a class="headerlink" href="#grep11-lab-grep11-setup-start-the-grep11-server" title="Permanent link">&para;</a></h2>
<p>If you looked carefully at the JSON file and the YAML file in the previous section, you may have noticed that the YAML file contains more information than the JSON file contains.  As a result, the syntax is simpler for the command that uses the YAML file.  The command that uses the JSON file uses command line arguments to provide some of the information that the YAML file contained.  Compare the two methods:</p>
<div class="admonition reminder">
<p class="admonition-title">Reminder</p>
<p><strong>The commands shown below are for reference only</strong>- they have already been performed by the lab instructors in order to set up the lab environment for you.</p>
</div>
<details class="example" open="open">
<summary>Command to start the GREP11 server with the YAML file</summary>
<div class="highlight"><pre><span></span><code>hpvs deploy --config $HOME/hpvs/config/grep11/vs_grep11_79-9876.yml
</code></pre></div>
</details>
<details class="example" open="open">
<summary>Command to start the GREP11 server with the JSON file</summary>
<div class="highlight"><pre><span></span><code>hpvs vs create --name grep11-08-0014-9876 --repo hpcsKpGrep11_runq --tag 1.2.7.3 --crypto_matrix=08.0014 --cpu 2 --ram 2048 --envjsonpath ${HOME}/hpvs/config/grep11/grep11_env_08.0014.json --ports &quot;{containerport = 9876, protocol = tcp, hostport = 9876}&quot;
</code></pre></div>
</details>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Starting now, as you navigate to the next section of the lab, you should enter all the commands shown in the lab.</strong>  Only the commands in this section were for reference.</p>
</div>
<div class="footnote">
<hr />
<ol>
<li id="grep11-lab-grep11-setup-fn:1">
<p>The GREP11 server is a feature provided by Hyper Protect Virtual Servers. You are not required to use it. If you do not use this feature, you do not have to define Crypto Express domains to the LPAR.  You may wish to for other purposes, and you can use the other modes offered by Crypto Express cards for those purposes, but you must use EP11 mode for usage by the GREP11 server.&#160;<a class="footnote-backref" href="#grep11-lab-grep11-setup-fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="grep11-lab-grep11-display"><h1 id="grep11-lab-grep11-display-displaying-your-grep11-environment">Displaying your GREP11 environment<a class="headerlink" href="#grep11-lab-grep11-display-displaying-your-grep11-environment" title="Permanent link">&para;</a></h1>
<h2 id="grep11-lab-grep11-display-list-crypto-domains-on-your-hyper-protect-virtual-servers-lpar">List Crypto Domains on your Hyper Protect Virtual Servers LPAR<a class="headerlink" href="#grep11-lab-grep11-display-list-crypto-domains-on-your-hyper-protect-virtual-servers-lpar" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>List your available domains with the Hyper Protect Virtual Server CLI:</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>crypto<span class="w"> </span>list
</code></pre></div>
<details class="example" open="open">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code>hpvs crypto list
+---------------+--------+
| CRYPTO.DOMAIN | STATUS |
+---------------+--------+
| 08.0014       | in use |
| 0a.0014       | in use |
+---------------+--------+
</code></pre></div>
</details>
<p>A value of <em>in use</em> in the <strong>STATUS</strong> column indicates that each crypto domain has a GREP11 server connected to it.</p>
</li>
</ol>
<h2 id="grep11-lab-grep11-display-display-the-grep11-servers">Display the GREP11 servers<a class="headerlink" href="#grep11-lab-grep11-display-display-the-grep11-servers" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Display the virtual servers running on the Hyper Protect Virtual Servers LPAR:</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>vs<span class="w"> </span>list
</code></pre></div>
<details class="example" open="open">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code>+----------------------+---------+-------------+----------------------------------------------------------------------------------------------------------------+
| NAMES                | STATE   | STATUS      | IMAGE                                                                                                          |
+----------------------+---------+-------------+----------------------------------------------------------------------------------------------------------------+
| grep11-08-0014-9876  | running | Up 19 hours | docker-eu-public.artifactory.swg-devops.com/sys-zaas-team-hpcs-dev-docker-local/hpcs/grep11-ep11server:1.2.7.3 |
| grep11-0a-0014-19876 | running | Up 19 hours | docker-eu-public.artifactory.swg-devops.com/sys-zaas-team-hpcs-dev-docker-local/hpcs/grep11-ep11server:1.2.7.3 |
+----------------------+---------+-------------+----------------------------------------------------------------------------------------------------------------+
</code></pre></div>
</details>
<p>Observe that there are two servers listed whose name starts with <code>grep11</code>.  These are the two GREP11 servers that we have provided. One accessible from host port 9876 and one from host port 19876.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The list you see may differ from what is shown in our example, but you should see the two GREP11 servers whose names are highlighted in our example.</p>
</div>
</li>
<li>
<p>Display details about one of the GREP11 servers with this command:</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>vs<span class="w"> </span>show<span class="w"> </span>--name<span class="w"> </span>grep11-08-0014-9876
</code></pre></div>
<details class="example" open="open">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code>+-------------+------------------------------+
| PROPERTIES  | VALUES                       |
+-------------+------------------------------+
| Name        | grep11-08-0014-9876          |
| CPU         | 2                            |
| Memory      | 2048                         |
| State       | running                      |
| Status      | Up 19 hours                  |
| Networks    | Gateway:172.31.0.1           |
|             | IPAddress:172.31.0.2         |
|             | MacAddress:02:42:ac:1f:00:02 |
|             | Network:bridge               |
|             | Subnet:16                    |
| Ports       | LocalPort:9876/tcp           |
|             | GuestPort:9876               |
| Quotagroups | []                           |
+-------------+------------------------------+
</code></pre></div>
</details>
</li>
<li>
<p><strong>(Optional)</strong> Feel free to run the <code>hpvs vs show</code> command against the other GREP11 server.</p>
</li>
</ol>
<p>Please proceed to the next section of the lab.</p></section><section class="print-page" id="grep11-lab-run-grep11-samples"><h1 id="grep11-lab-run-grep11-samples-run-the-grep11-sample-code">Run the GREP11 Sample code<a class="headerlink" href="#grep11-lab-run-grep11-samples-run-the-grep11-sample-code" title="Permanent link">&para;</a></h1>
<h2 id="grep11-lab-run-grep11-samples-clone-the-github-repository-which-has-the-source-code">Clone the GitHub repository which has the source code<a class="headerlink" href="#grep11-lab-run-grep11-samples-clone-the-github-repository-which-has-the-source-code" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Change to the <code>/home/hyper-protect-lab/go/src/github.com/ibm-developer</code> directory</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/go/src/github.com/ibm-developer
</code></pre></div>
</li>
<li>
<p>Ensure you are in the directory mentioned in the prior step<sup id="fnref:1"><a class="footnote-ref" href="#grep11-lab-run-grep11-samples-fn:1">1</a></sup>. You may be able to tell from the command prompt. 
You can also enter the <code>pwd</code> ("print working directory") to be sure, e.g.,:</p>
<div class="highlight"><pre><span></span><code><span class="nb">pwd</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>/home/hyper-protect-lab/go/src/github.com/ibm-developer
</code></pre></div>
</details>
</li>
<li>
<p>Clone the GitHub repository used in this lab:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/silliman/ibm-cloud-hyperprotectcrypto.git
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Cloning into &#39;ibm-cloud-hyperprotectcrypto&#39;...
remote: Enumerating objects: 821, done.
remote: Counting objects: 100% (821/821), done.
remote: Compressing objects: 100% (551/551), done.
remote: Total 821 (delta 227), reused 821 (delta 227), pack-reused 0
Receiving objects: 100% (821/821), 9.30 MiB | 8.42 MiB/s, done.
Resolving deltas: 100% (227/227), done.
</code></pre></div>
</details>
</li>
<li>
<p>Change to the <code>ibm-cloud-hyperprotectcrypto</code> directory which the prior <code>git clone</code> command created:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>ibm-cloud-hyperprotectcrypto
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use the <code>pwd</code> command if you cannot already tell by your command prompt that you are in the <code>/home/hyper-protect-lab/go/src/github.com/ibm-developer/ibm-cloud-hyperprotectcrypto</code> directory.</p>
</div>
</li>
</ol>
<h2 id="grep11-lab-run-grep11-samples-run-the-grep11-sample-code_1">Run the GREP11 sample code<a class="headerlink" href="#grep11-lab-run-grep11-samples-run-the-grep11-sample-code_1" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Start Visual Studio Code within your current directory:</p>
<div class="highlight"><pre><span></span><code>code<span class="w"> </span>.<span class="w">  </span><span class="c1"># if typing by hand don&#39;t forget the period (for current directory)</span>
</code></pre></div>
<p>In a moment you should see the Visual Studio Code window with your current directory structure shown in the Explorer pane in the upper left corner of the window:</p>
<p><img alt="Open VS Code" src="../grep11-lab/images/grep11-0010_open-vscode.png" /></p>
</li>
<li>
<p>Expand the <code>golang</code> folder, and then expand the <code>examples</code> folder underneath it. Your Explorer pane should then look similar to this:</p>
<p><img alt="Navigate to golang/examples" src="../grep11-lab/images/grep11-0020_nav-golang-examples.png" /></p>
</li>
<li>
<p>From the Visual Studio Code menu, select <em>View</em> then <em>Terminal</em>, as shown below:</p>
<p><img alt="Select View-&gt;Terminal" src="../grep11-lab/images/grep11-0030_view-terminal.png" /></p>
</li>
<li>
<p>You will see a terminal appear within Visual Studio Code at the bottom:</p>
<p><img alt="Terminal" src="../grep11-lab/images/grep11-0040_terminal.png" /></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you hover your mouse over the line above the terminal, when it turns into the "double arrow" as highlighted in the above screen snippet, you can drag the line to resize your terminal window. This tip may come in handy for you during the course of the lab.</p>
</div>
</li>
<li>
<p>Change to the <code>golang/examples</code> directory within the Visual Studio Code terminal that you just opened:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>golang/examples
</code></pre></div>
<p>Your terminal will look like this:</p>
<p><img alt="Change to golang/examples" src="../grep11-lab/images/grep11-0050_cd-golang-examples.png" /></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>I have shown you how to use the Terminal window with Visual Studio Code, which you may find convenient.  Your Ubuntu Desktop also provides a Terminal application that you can use to open one or more terminal windows.  They behave the same, and which one you use is a personal choice, as long as you are in the correct directory that the instructions expect you to be in.</p>
<p>It is convenient to have a terminal window inside Visual Studio Code, but it comes at the expense of some screen real estate being taken away from the source code used in the exercises.</p>
<p>Use whichever method works best for you.</p>
</div>
</li>
<li>
<p>Test the GREP11 sample code:</p>
<div class="highlight"><pre><span></span><code>go<span class="w"> </span><span class="nb">test</span><span class="w"> </span>-v
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>=== RUN   Example_getMechanismInfo
--- PASS: Example_getMechanismInfo (0.29s)
=== RUN   Example_encryptAndDecrypt
--- PASS: Example_encryptAndDecrypt (0.84s)
=== RUN   Example_digest
--- PASS: Example_digest (0.55s)
=== RUN   Example_signAndVerifyUsingRSAKeyPair
--- PASS: Example_signAndVerifyUsingRSAKeyPair (0.50s)
=== RUN   Example_signAndVerifyUsingECDSAKeyPair
--- PASS: Example_signAndVerifyUsingECDSAKeyPair (0.52s)
=== RUN   Example_signAndVerifyToTestErrorHandling
--- PASS: Example_signAndVerifyToTestErrorHandling (0.51s)
=== RUN   Example_wrapAndUnwrapKey
--- PASS: Example_wrapAndUnwrapKey (0.41s)
=== RUN   Example_deriveKey
--- PASS: Example_deriveKey (0.61s)
=== RUN   Example_tls
--- PASS: Example_tls (0.40s)
PASS
ok      github.com/ibm-developer/ibm-cloud-hyperprotectcrypto/golang/examples   4.653s
</code></pre></div>
</details>
</li>
</ol>
<h2 id="grep11-lab-run-grep11-samples-explanation-of-grep11-sample-code">Explanation of GREP11 sample code<a class="headerlink" href="#grep11-lab-run-grep11-samples-explanation-of-grep11-sample-code" title="Permanent link">&para;</a></h2>
<p>The test used the <em>go test</em> subcommand, which does the following:</p>
<ol>
<li>
<p>It looks for any file in the current directory named <em>something*_test.go. There are two such files in our directory, *server_test.go</em> and <em>tls_test.go</em>.</p>
</li>
<li>
<p>It looks for functions in these files named Example_<em>something</em>, and executes these functions.</p>
</li>
<li>
<p>At the bottom of each of these functions, a series of comment lines, starting with a header line, specifies what the expected output from the function should be. If the output from the function call matches the lines (except for the header line), then the test passes.  Otherwise the test fails.</p>
</li>
</ol>
<p>In the explorer pane, click on <em>server_test.go</em> or <em>tls_test.go</em> and examine the source code to see these lines.  For example, lines 222-227 in <em>server_test.go</em> indicate what the expected output of the <em>Example_encryptAndDecrypt</em> function should be:</p>
<div class="highlight"><pre><span></span><code>//<span class="w"> </span>Output:
//<span class="w"> </span>Generated<span class="w"> </span>AES<span class="w"> </span>Key
//<span class="w"> </span>Generated<span class="w"> </span>IV
//<span class="w"> </span>Encrypted<span class="w"> </span>message
//<span class="w"> </span>Decrypted<span class="w"> </span>message
//<span class="w"> </span>Hello,<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>very<span class="w"> </span>long<span class="w"> </span>and<span class="w"> </span>creative<span class="w"> </span>message<span class="w"> </span>without<span class="w"> </span>any<span class="w"> </span>imagination
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Go is a compiled language, and there are no executable files in this directory-  the 'go test' command compiles the source code in the directory into an executable file in order to run the tests, and then cleans up afterwards by removing this executable.</p>
</div>
<p>Here is an itemization of the functions that our <code>go test -v</code> command tested, with a brief description of each.  Our lab exercises in the subsequent sections will go into a little more depth on some of the more interesting of these functions.</p>
<ol>
<li>
<p><em>Example_getMechanismInfo</em> gets a list of PKCS #11 Mechanisms and then retrieves information about one of them.  We will delve deeper into this in the first exercise.</p>
</li>
<li>
<p><em>Example_encryptAndDecrypt</em> creates a secret (i.e., symmetric) key, encrypts data with it, then decrypts it, and ensures the data was unchanged after going through the encryption and decryption.  We will look more into this in the second exercise.</p>
</li>
<li>
<p><em>Example_digest</em> creates a digest<sup id="fnref:2"><a class="footnote-ref" href="#grep11-lab-run-grep11-samples-fn:2">2</a></sup>, or hash, against some data. Digests are used in digital signatures, which the next two tests cover.</p>
</li>
<li>
<p><em>Example_signAndVerifyUsingRSAKeyPair</em> creates an RSA public and private key pair and uses the private key to create a digital signature and the public key to verify the digital signature.</p>
</li>
<li>
<p><em>Example_signAndVerifyUsingECDSAKeyPair</em> creates an elliptic curve public and private key pair and uses the private key to create a digital signature and uses the public key to verify the digital signature. We go into greater depth (and discuss the differences between RSA and Elliptic Curves) in the third exercise.</p>
</li>
<li>
<p><em>Example_signAndVerifyToTestErrorHandling</em> intentionally causes an error-  after a signature is created, the program modifies a byte in it, so that when the signature is verified later, an error occurs. The test passes because the expected error message is listed in the expected test output.</p>
</li>
<li>
<p><em>Example_wrapAndUnwrapKey</em> creates a public and private key pair and uses the public key to encrypt, or wrap, a symmetric key, which can then only be decrypted, or unwrapped, by the private key.  The fourth and final exercise covers this topic.</p>
</li>
<li>
<p><em>Example_deriveKey</em> illustrates a common algorithm where two sides of a connection each have a public and private key pair, and they use each other's public key in an algorithm that allows each of them to derive an identical secret, i.e., symmetric, key, without ever having sent that secret key across the connection.  This is a common use case because encryption and decryption with a symmetric key is much faster than encryption and decryption with public and private keys.  The two parties use relatively slow public key cryptography to derive this shared symmetric key at the beginning of their session, and then switch to using this symmetric key for the remainder of the session.  This function and all of the functions preceding it in this list are in the <em>server_test.go</em> source file.</p>
</li>
<li>
<p><em>Example_tls</em> creates an X.509 certificate, starts up an http server that uses this certificate, and has a client connect to the server with TLS authentication, which uses this certificate to establish a session.  This test is in the <em>tls_test.go</em> source file.</p>
</li>
</ol>
<p>Please proceed to the next section.</p>
<div class="footnote">
<hr />
<ol>
<li id="grep11-lab-run-grep11-samples-fn:1">
<p>The Go compiler has traditionally been very picky about where source code files must reside. This situation has eased recently with the introduction of <em>Go modules</em> in newer releases, but our lab is not using Go modules.  Go expects to find source files in the ${GOPATH}/src directory hierarchy, and if you do not have the GOPATH environment variable set, it expects fo find source files in the ${HOME}/go/src directory hierarchy.&#160;<a class="footnote-backref" href="#grep11-lab-run-grep11-samples-fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="grep11-lab-run-grep11-samples-fn:2">
<p>A hash is a fixed-length fingerprint for a set of input data of any size.  Since there are an infinite number of possible input combinations, and the hash is fixed-length, in theory two different sets of data could produce the same hash.  This is called a <em>collision</em>.  In practice, the hash is of sufficient size, and the algorithm to produce it sufficiently complex, that it is computationally infeasible to produce the same hash with two different sets of input. If it can be demonstrated that two different sets of input can produce the same fingerprint by a hashing algorithm, then that algorithm will be considered insecure and fall into disuse in favor of stronger hashing algorithms.&#160;<a class="footnote-backref" href="#grep11-lab-run-grep11-samples-fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div></section>
                        <h2 class='nav-section-title' id='section-run-the-lab-exercises'>
                            Run the Lab exercises <a class='headerlink' href='#section-run-the-lab-exercises' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="grep11-lab-exercise-overview"><h1 id="grep11-lab-exercise-overview-an-overview-of-the-exercises">An overview of the exercises<a class="headerlink" href="#grep11-lab-exercise-overview-an-overview-of-the-exercises" title="Permanent link">&para;</a></h1>
<p>Expand the <em>lab</em> folder in your Visual Studio Code explorer pane so that you can see the source code files in the folder, similar to what is shown in the screen snippet below:</p>
<p><img alt="Change to golang/lab" src="../grep11-lab/images/grep11-0060_cd-golang-lab.png" /></p>
<p>Running the <code>go test -v</code> command in the <em>golang/examples</em> directory was good for ensuring that our GREP11 server setup works and that our client application can access it.  But there is not a lot of output produced by this test, so we took the functions used in the test and added statements in many places to produce output for educational purposes.  We also added some flexibility to the functions by adding some function arguments that would let us modify function behavior, again, for educational purposes.</p>
<p>We left the <code>golang/examples</code> directory intact, and copied the source code into a new directory that we created, <code>golang/lab</code>, and made our program modifications in that directory. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These exercises are meant to illustrate various concepts for learning about the functionality that the GREP11 server and the Crypto Express card in EP11 mode provide, and are not meant to illustrate Go programming lanuage best practices.  In fact, we violated one best practice (DRY - Don't Repeat Yourself) when we copied the <em>examples</em> directory into the <em>lab</em> directory! </p>
<p>Feel free to copy our source code and use it as you see fit, but it is provided "as is", without support or warranty of any kind.</p>
</div>
<p>Other than adding a whole bunch of statements to print output, at a high level, the following changes in program structure were made after copying the source code from <em>golang/examples</em> into <em>golang/labs</em></p>
<ol>
<li>
<p>The routine to set the variables needed to connect to the GREP11 server was moved into a separate file, <em>callopt.go</em>.  This routine specifies the IP address and port where the GREP11 server is listening, and it also contains variables specifying the certificates and keys necessary to establish a session between our program and the GREP11 server using mutual TLS authentication.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The information in the <em>callopt.go</em> file is the type of information that would be provided by an administrator, such as the Hyper Protect Virtual Servers administrator for hostname or IP address and port for connection, and perhaps the same or a different security administrator for the certficates and keys necessary to successfully establish the connection with mutual TLS authentication.</p>
</div>
</li>
<li>
<p>A main() function, which is the entry point for the program, was created, in the file <em>main.go</em>.  It uses arguments to determine which of the four exercises to invoke.  (You can actually invoke any combination of them in one program invocation but in our lab instructions we only have you do one at a time).  We added some extra arguments that work with exercises two, three, and four, in order to illustrate concepts of interest.</p>
</li>
<li>
<p>There are four separate source files, <em>exercise1.go</em>, <em>exercise2.go</em>, <em>exercise3.go</em>, and <em>exercise4.go</em> each of which was created by copying one of the <em>Example_</em> test functions from <em>golang/examples/server_test.go</em>, modifying the name of the function to remove <em>Example_</em> from its name to reinforce the point that it was no longer a function suitable for using with the <em>go test</em> command.</p>
<ol>
<li><em>exercise1.go</em> began life as <em>Example_getMechanismInfo()</em></li>
<li><em>exercise2.go</em> started out as <em>Example_encryptAndDecrypt()</em></li>
<li><em>exercise3.go</em> was <em>Example_signAndVerifyUsingECDSAKeyPair()</em></li>
<li><em>exercise4.go</em> had its origins as <em>Example_wrapAndUnwrapKey()</em></li>
</ol>
</li>
<li>
<p>We deleted some of the files that we copied over that were not needed to run our lab exercises.</p>
</li>
</ol>
<p>It's time to start the first exercise.  Enjoy!</p></section><section class="print-page" id="grep11-lab-lab-exercise1"><h1 id="grep11-lab-lab-exercise1-exercise-1-list-mechanisms">Exercise 1 - List Mechanisms<a class="headerlink" href="#grep11-lab-lab-exercise1-exercise-1-list-mechanisms" title="Permanent link">&para;</a></h1>
<h2 id="grep11-lab-lab-exercise1-explanation-of-mechanisms">Explanation of Mechanisms<a class="headerlink" href="#grep11-lab-lab-exercise1-explanation-of-mechanisms" title="Permanent link">&para;</a></h2>
<p><em>Mechanisms</em> is the PKCS #11 standard's fancy word for <em>algorithms</em>.  </p>
<p>In the introduction of the <em>PKCS#11 Cryptographic Token Interface Base Specification 2.40</em> document, there is this statement: <em>Details of cryptographic mechanisms (algorithms) may be found in the associated PKCS#11 Mechanisms documents.</em></p>
<p>And then in the <em>PKCS#11 Cryptographic Token Interface Current Mechanisms Specification Version 2.40</em> it says <code>A mechanism specifies precisely how a certain cryptographic process is to be performed.</code></p>
<p>This exercise will list the mechanisms supported by the Crypto Express card in EP11 mode.</p>
<p>The program that you will invoke in this exercise issues a <em>GetMechanismList()</em> function call to the GREP11 server, and then it will iterate through the list returned, calling <em>GetMechanismInfo()</em> against each mechanism to obtain more info about it. </p>
<p>Run the program and then a brief discussion of the results will follow:</p>
<ol>
<li>
<p>You may wish to view the source code used by the lab exercises while running them.  It is handy to expand the <em>Outline</em> view in the left pane of Visual Studio Code which will show the various function and type definitions of the source code you have highlighted in the main portion of the Visual Studio Code window.  The Outline view may not be necessary for smaller source code files but it comes in handy for some of the larger source code files. The screen snippet below shows where the Outline view is:</p>
<p><img alt="Expand outling" src="../grep11-lab/images/grep11-0070_expand-outline.png" /></p>
</li>
<li>
<p>Change to the lab directory in your terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../lab
</code></pre></div>
</li>
<li>
<p>In the prior section, the <em>go test</em> command built the executable file it needed transparently to us. For our lab exercises, we need to build the executable binary.  We will use a single executable for all of the exercises, and invoke the various exercises through command line arguments. Build the executable now with this command:</p>
<div class="highlight"><pre><span></span><code>go<span class="w"> </span>build
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The absence of any messages is your indication of success!</p>
</div>
</li>
<li>
<p>The <code>go build</code> command should have created an excutable file that shares the name of the directory in which you are working- <code>lab</code>. List that file and you should see it has a recent date and timestamp.</p>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-l<span class="w"> </span>lab
</code></pre></div>
<details class="example" open="open">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code>-rwxr-xr-x<span class="w"> </span><span class="m">1</span><span class="w"> </span>hyper-protect-lab<span class="w"> </span>hyper-protect-lab<span class="w"> </span><span class="m">17545825</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">8</span><span class="w"> </span><span class="m">06</span>:26<span class="w"> </span>lab
</code></pre></div>
</details>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You may be doing this lab in a virtual machine whose clock is set for a time zone different from where you are. You can always issue the <code>date</code> command to see what time your virtual machine thinks it is at the moment.</p>
</div>
</li>
<li>
<p>Run the first exercise by passing the appropriate argument, shown below, to the <em>lab</em> program:</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex1
</code></pre></div>
<details class="example">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code>Got mechanism list of length 94:

Mechanism  0 : CKM_RSA_PKCS 
MinKeySize:512 MaxKeySize:4096 Flags:404224  

Mechanism  1 : CKM_RSA_PKCS_OAEP 
MinKeySize:512 MaxKeySize:4096 Flags:393984  

Mechanism  2 : CKM_RSA_PKCS_KEY_PAIR_GEN 
MinKeySize:512 MaxKeySize:4096 Flags:65536  

Mechanism  3 : CKM_RSA_X9_31_KEY_PAIR_GEN 
MinKeySize:512 MaxKeySize:4096 Flags:65536  

Mechanism  4 : CKM_RSA_PKCS_PSS 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  5 : CKM_SHA1_RSA_X9_31 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  6 : CKM_SHA1_RSA_PKCS 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  7 : CKM_SHA1_RSA_PKCS_PSS 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  8 : CKM_SHA256_RSA_PKCS 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  9 : CKM_SHA256_RSA_PKCS_PSS 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  10 : CKM_SHA224_RSA_PKCS 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  11 : CKM_SHA224_RSA_PKCS_PSS 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  12 : CKM_SHA384_RSA_PKCS 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  13 : CKM_SHA384_RSA_PKCS_PSS 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  14 : CKM_SHA512_RSA_PKCS 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  15 : CKM_SHA512_RSA_PKCS_PSS 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  16 : CKM_AES_KEY_GEN 
MinKeySize:16 MaxKeySize:32 Flags:32768  

Mechanism  17 : CKM_AES_ECB 
MinKeySize:16 MaxKeySize:32 Flags:768  

Mechanism  18 : CKM_AES_CBC 
MinKeySize:16 MaxKeySize:32 Flags:393984  

Mechanism  19 : CKM_AES_CBC_PAD 
MinKeySize:16 MaxKeySize:32 Flags:393984  

Mechanism  20 : CKM_DES2_KEY_GEN 
MinKeySize:16 MaxKeySize:16 Flags:32768  

Mechanism  21 : CKM_DES3_KEY_GEN 
MinKeySize:24 MaxKeySize:24 Flags:32768  

Mechanism  22 : CKM_DES3_ECB 
MinKeySize:16 MaxKeySize:24 Flags:768  

Mechanism  23 : CKM_DES3_CBC 
MinKeySize:16 MaxKeySize:24 Flags:393984  

Mechanism  24 : CKM_DES3_CBC_PAD 
MinKeySize:16 MaxKeySize:24 Flags:393984  

Mechanism  25 : CKM_GENERIC_SECRET_KEY_GEN 
MinKeySize:8 MaxKeySize:256 Flags:557056  

Mechanism  26 : CKM_SHA256 
Flags:1024  

Mechanism  27 : CKM_SHA256_KEY_DERIVATION 
Flags:524288  

Mechanism  28 : CKM_SHA256_HMAC 
MinKeySize:16 MaxKeySize:32 Flags:10240  

Mechanism  29 : CKM_SHA224 
Flags:1024  

Mechanism  30 : CKM_SHA224_KEY_DERIVATION 
Flags:524288  

Mechanism  31 : CKM_SHA224_HMAC 
MinKeySize:14 MaxKeySize:32 Flags:10240  

Mechanism  32 : CKM_SHA_1 
Flags:1024  

Mechanism  33 : CKM_SHA1_KEY_DERIVATION 
Flags:524288  

Mechanism  34 : CKM_SHA_1_HMAC 
MinKeySize:10 MaxKeySize:32 Flags:10240  

Mechanism  35 : CKM_SHA384 
Flags:1024  

Mechanism  36 : CKM_SHA384_KEY_DERIVATION 
Flags:524288  

Mechanism  37 : CKM_SHA384_HMAC 
MinKeySize:24 MaxKeySize:32 Flags:10240  

Mechanism  38 : CKM_SHA512 
Flags:1024  

Mechanism  39 : CKM_SHA512_KEY_DERIVATION 
Flags:524288  

Mechanism  40 : CKM_SHA512_HMAC 
MinKeySize:32 MaxKeySize:32 Flags:10240  

Mechanism  41 : CKM_SHA512_256 
Flags:1024  

Mechanism  42 : CKM_IBM_SHA512_256 
Flags:1024  

Mechanism  43 : CKM_SHA512_256_HMAC 
MinKeySize:16 MaxKeySize:32 Flags:10240  

Mechanism  44 : CKM_IBM_SHA512_256_HMAC 
MinKeySize:16 MaxKeySize:32 Flags:10240  

Mechanism  45 : CKM_SHA512_224 
Flags:1024  

Mechanism  46 : CKM_IBM_SHA512_224 
Flags:1024  

Mechanism  47 : CKM_SHA512_224_HMAC 
MinKeySize:14 MaxKeySize:32 Flags:10240  

Mechanism  48 : CKM_IBM_SHA512_224_HMAC 
MinKeySize:14 MaxKeySize:32 Flags:10240  

Mechanism  49 : CKM_EC_KEY_PAIR_GEN 
MinKeySize:192 MaxKeySize:521 Flags:26279936  

Mechanism  50 : CKM_ECDSA 
MinKeySize:192 MaxKeySize:521 Flags:26224640  

Mechanism  51 : CKM_ECDSA_SHA1 
MinKeySize:192 MaxKeySize:521 Flags:26224640  

Mechanism  52 : CKM_ECDH1_DERIVE 
MinKeySize:192 MaxKeySize:521 Flags:18350080  

Mechanism  53 : CKM_IBM_ECDH1_DERIVE_RAW 
MinKeySize:192 MaxKeySize:521 Flags:18350080  

Mechanism  54 : CKM_IBM_EC_MULTIPLY 
MinKeySize:192 MaxKeySize:521 Flags:256  

Mechanism  55 : CKM_DSA_PARAMETER_GEN 
MinKeySize:1024 MaxKeySize:3072 Flags:32768  

Mechanism  56 : CKM_DSA_KEY_PAIR_GEN 
MinKeySize:1024 MaxKeySize:3072 Flags:65536  

Mechanism  57 : CKM_DSA 
MinKeySize:1024 MaxKeySize:3072 Flags:10240  

Mechanism  58 : CKM_DSA_SHA1 
MinKeySize:1024 MaxKeySize:3072 Flags:10240  

Mechanism  59 : CKM_DH_PKCS_PARAMETER_GEN 
MinKeySize:1024 MaxKeySize:3072 Flags:32768  

Mechanism  60 : CKM_DH_PKCS_KEY_PAIR_GEN 
MinKeySize:1024 MaxKeySize:3072 Flags:65536  

Mechanism  61 : CKM_DH_PKCS_DERIVE 
MinKeySize:1024 MaxKeySize:3072 Flags:524288  

Mechanism  62 : CKM_IBM_DH_PKCS_DERIVE_RAW 
MinKeySize:1024 MaxKeySize:3072 Flags:524288  

Mechanism  63 : Mechanism(0x80010023) 
MinKeySize:256 MaxKeySize:256 Flags:75776  

Mechanism  64 : CKM_RSA_X9_31 
MinKeySize:512 MaxKeySize:4096 Flags:10240  

Mechanism  65 : CKM_PBE_SHA1_DES3_EDE_CBC 
MinKeySize:24 MaxKeySize:24 Flags:32768  

Mechanism  66 : CKM_IBM_SHA3_224 
Flags:1024  

Mechanism  67 : CKM_IBM_SHA3_256 
Flags:1024  

Mechanism  68 : CKM_IBM_SHA3_384 
Flags:1024  

Mechanism  69 : CKM_IBM_SHA3_512 
Flags:1024  

Mechanism  70 : Mechanism(0x80010025) 
MinKeySize:14 MaxKeySize:32 Flags:10240  

Mechanism  71 : Mechanism(0x80010026) 
MinKeySize:16 MaxKeySize:32 Flags:10240  

Mechanism  72 : Mechanism(0x80010027) 
MinKeySize:24 MaxKeySize:32 Flags:10240  

Mechanism  73 : Mechanism(0x80010028) 
MinKeySize:32 MaxKeySize:32 Flags:10240  

Mechanism  74 : CKM_IBM_ATTRIBUTEBOUND_WRAP 
MaxKeySize:4096 Flags:393216  

Mechanism  75 : Mechanism(0x1043) 
MinKeySize:192 MaxKeySize:521 Flags:26224640  

Mechanism  76 : CKM_IBM_ECDSA_SHA224 
MinKeySize:192 MaxKeySize:521 Flags:26224640  

Mechanism  77 : Mechanism(0x1044) 
MinKeySize:192 MaxKeySize:521 Flags:26224640  

Mechanism  78 : CKM_IBM_ECDSA_SHA256 
MinKeySize:192 MaxKeySize:521 Flags:26224640  

Mechanism  79 : Mechanism(0x1045) 
MinKeySize:192 MaxKeySize:521 Flags:26224640  

Mechanism  80 : CKM_IBM_ECDSA_SHA384 
MinKeySize:192 MaxKeySize:521 Flags:26224640  

Mechanism  81 : Mechanism(0x1046) 
MinKeySize:192 MaxKeySize:521 Flags:26224640  

Mechanism  82 : CKM_IBM_ECDSA_SHA512 
MinKeySize:192 MaxKeySize:521 Flags:26224640  

Mechanism  83 : Mechanism(0x80010031) 
MinKeySize:192 MaxKeySize:521 Flags:26224640  

Mechanism  84 : CKM_IBM_EC_C25519 
MinKeySize:256 MaxKeySize:256 Flags:18350080  

Mechanism  85 : CKM_IBM_EC_C448 
MinKeySize:448 MaxKeySize:448 Flags:18350080  

Mechanism  86 : CKM_IBM_EDDSA_SHA512 
MinKeySize:256 MaxKeySize:256 Flags:17836032  

Mechanism  87 : CKM_IBM_ED448_SHA3 
MinKeySize:448 MaxKeySize:448 Flags:17836032  

Mechanism  88 : CKM_IBM_EAC 
Flags:524288  

Mechanism  89 : CKM_IBM_RETAINKEY 
MaxKeySize:256 Flags:131072  

Mechanism  90 : CKM_IBM_CMAC 
MinKeySize:16 MaxKeySize:32 Flags:10240  

Mechanism  91 : CKM_AES_CMAC 
MinKeySize:16 MaxKeySize:32 Flags:10240  

Mechanism  92 : CKM_DES3_CMAC 
MinKeySize:16 MaxKeySize:24 Flags:10240  

Mechanism  93 : Mechanism(0x80070001) 
MinKeySize:16 MaxKeySize:64 Flags:524288  
</code></pre></div>
</details>
</li>
</ol>
<h2 id="grep11-lab-lab-exercise1-explanation-of-exercise-output">Explanation of exercise output<a class="headerlink" href="#grep11-lab-lab-exercise1-explanation-of-exercise-output" title="Permanent link">&para;</a></h2>
<p>Near the top of the output, you see the line:</p>
<p><code>Got mechanism list of length 94:</code> </p>
<p>This indicates there were 94 mechanisms returned by the call to <em>GetMechanismList()</em>.</p>
<p>Then, for each mechanism, two lines of output are created, one with the mechanism name, which usually start with <code>CKM_</code>.  The mechanism number has no significance, this is just an index number assigned by our lab program, starting at 0 and incremented by the program as it iterates over the list.</p>
<p>The information returned by <em>GetMechanismInfo()</em> includes the minimum key size and maximum key size for the mechanism, if applicable, and flags that are associated with the mechanism.  The numbers shown are in decimal, and the key sizes shown are in bytes.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you are doing this lab at your leisure on your own system, you could look in <em>golang/ep11/header_consts.go</em> and find the flags within lines 596 through 649 of that file.  You'd have to convert the decimal value shown to hexadecimal.  If you are taking this lab as part of a virtual event, do not take the time now to deconstruct these flags-  you can always do that later since this lab is publicly available.</p>
</div>
<p>Observe that the large majority of mechanisms in the list have a name starting with <em>CKM_</em>, while a handful, such as item 77, 79, 81, and others, do not.  It appears that if the mechanism is not listed in the <em>golang/ep11/header_consts.go</em> file, within lines 205 to 594, then it will not have a name starting with <em>CKM_</em>.</p>
<p>Note that the PKCS #11 specification does not mandate that an implementation support all defined mechanisms. Even within the subset of the 94 mechanisms that are supported by IBM's EP11 library, some are for algorithms that are considered rather outdated, and, in some cases, downright insecure.  For example, the SHA-1 cryptographic hash algorithm is considered insecure these days, so any mechanims in the list that have SHA1 or SHA_1 in their name (and there are some) should be avoided.</p>
<p>Let's move on to Exercise 2.</p></section><section class="print-page" id="grep11-lab-lab-exercise2"><h1 id="grep11-lab-lab-exercise2-exercise-2-encrypt-and-decrypt-data">Exercise 2 - Encrypt and Decrypt Data<a class="headerlink" href="#grep11-lab-lab-exercise2-exercise-2-encrypt-and-decrypt-data" title="Permanent link">&para;</a></h1>
<h2 id="grep11-lab-lab-exercise2-overview-of-exercise-2">Overview of Exercise 2<a class="headerlink" href="#grep11-lab-lab-exercise2-overview-of-exercise-2" title="Permanent link">&para;</a></h2>
<p>Exercise 2 creates an AES secret key and uses it to encrypt some <em>plaintext</em> data. Plaintext which has been encrypted is referred to as <em>ciphertext</em>.
This ciphertext is then decrypted back into plaintext using the same AES secret key that was used for encryption. The original plaintext is compared to- and is expected to be identical to- the plaintext that resulted from the encryption and decryption.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Plaintext data is often, but not necessarily, human-readable.  It is any data that could be of value to an adversary, if the adversary could obtain the data in its original, or plaintext, form.  Hence the need for encryption. If an adversary were to obtain ciphertext, it is unreadable and thus of little or no value to the adversary.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The PKCS #11 standard uses the phrase <em>secret key</em> often. <em>Secret key</em> is synonoymous with the term <em>symmetric key</em>, which is also a term commonly used in cryptography.  That is, a single key is used for both encryption and decryption.</p>
</div>
<ol>
<li>
<p>Run the second exercise:</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex2
</code></pre></div>
<details class="example">
<summary>Example Output</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="hll">Generated<span class="w"> </span>AES<span class="w"> </span>Key<span class="w"> </span>with<span class="w"> </span>mechanism<span class="w">  </span>CKM_AES_KEY_GEN
</span>
length<span class="w"> </span>of<span class="w"> </span>key<span class="w"> </span>blob<span class="w"> </span>is<span class="w"> </span><span class="m">256</span><span class="w"> </span>bytes
Key<span class="w"> </span>blob<span class="w"> </span>is<span class="w"> </span><span class="o">(</span>values<span class="w"> </span><span class="k">in</span><span class="w"> </span>decimal<span class="o">)</span>:
<span class="o">[</span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">176</span><span class="w"> </span><span class="m">130</span><span class="w"> </span><span class="m">49</span><span class="w"> </span><span class="m">65</span><span class="w"> </span><span class="m">141</span><span class="w"> </span><span class="m">152</span><span class="w"> </span><span class="m">246</span><span class="w"> </span><span class="m">85</span><span class="w"> </span><span class="m">132</span><span class="w"> </span><span class="m">150</span><span class="w"> </span><span class="m">183</span><span class="w"> </span><span class="m">226</span><span class="w"> </span><span class="m">212</span><span class="w"> </span><span class="m">36</span><span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">141</span><span class="w"> </span><span class="m">38</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">18</span><span class="w"> </span><span class="m">52</span><span class="w"> </span><span class="m">217</span><span class="w"> </span><span class="m">158</span><span class="w"> </span><span class="m">52</span><span class="w"> </span><span class="m">159</span><span class="w"> </span><span class="m">29</span><span class="w"> </span><span class="m">220</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">126</span><span class="w"> </span><span class="m">250</span><span class="w"> </span><span class="m">240</span><span class="w"> </span><span class="m">129</span><span class="w"> </span><span class="m">168</span><span class="w"> </span><span class="m">243</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">158</span><span class="w"> </span><span class="m">220</span><span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">158</span><span class="w"> </span><span class="m">254</span><span class="w"> </span><span class="m">73</span><span class="w"> </span><span class="m">111</span><span class="w"> </span><span class="m">45</span><span class="w"> </span><span class="m">102</span><span class="w"> </span><span class="m">230</span><span class="w"> </span><span class="m">162</span><span class="w"> </span><span class="m">209</span><span class="w"> </span><span class="m">246</span><span class="w"> </span><span class="m">93</span><span class="w"> </span><span class="m">216</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">108</span><span class="w"> </span><span class="m">223</span><span class="w"> </span><span class="m">116</span><span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="m">109</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">82</span><span class="w"> </span><span class="m">87</span><span class="w"> </span><span class="m">166</span><span class="w"> </span><span class="m">108</span><span class="w"> </span><span class="m">227</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">54</span><span class="w"> </span><span class="m">59</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">126</span><span class="w"> </span><span class="m">154</span><span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">159</span><span class="w"> </span><span class="m">250</span><span class="w"> </span><span class="m">161</span><span class="w"> </span><span class="m">203</span><span class="w"> </span><span class="m">128</span><span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">237</span><span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">218</span><span class="w"> </span><span class="m">243</span><span class="w"> </span><span class="m">169</span><span class="w"> </span><span class="m">235</span><span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">112</span><span class="w"> </span><span class="m">101</span><span class="w"> </span><span class="m">109</span><span class="w"> </span><span class="m">177</span><span class="w"> </span><span class="m">94</span><span class="w"> </span><span class="m">191</span><span class="w"> </span><span class="m">251</span><span class="w"> </span><span class="m">198</span><span class="w"> </span><span class="m">126</span><span class="w"> </span><span class="m">102</span><span class="w"> </span><span class="m">93</span><span class="w"> </span><span class="m">236</span><span class="w"> </span><span class="m">51</span><span class="w"> </span><span class="m">190</span><span class="w"> </span><span class="m">157</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">188</span><span class="w"> </span><span class="m">128</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">114</span><span class="w"> </span><span class="m">120</span><span class="w"> </span><span class="m">135</span><span class="w"> </span><span class="m">191</span><span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">42</span><span class="w"> </span><span class="m">191</span><span class="w"> </span><span class="m">209</span><span class="w"> </span><span class="m">135</span><span class="w"> </span><span class="m">168</span><span class="w"> </span><span class="m">241</span><span class="w"> </span><span class="m">228</span><span class="w"> </span><span class="m">137</span><span class="w"> </span><span class="m">121</span><span class="w"> </span><span class="m">180</span><span class="w"> </span><span class="m">140</span><span class="w"> </span><span class="m">113</span><span class="w"> </span><span class="m">211</span><span class="w"> </span><span class="m">159</span><span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">192</span><span class="w"> </span><span class="m">70</span><span class="w"> </span><span class="m">74</span><span class="w"> </span><span class="m">130</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">180</span><span class="w"> </span><span class="m">75</span><span class="w"> </span><span class="m">86</span><span class="w"> </span><span class="m">230</span><span class="w"> </span><span class="m">207</span><span class="w"> </span><span class="m">240</span><span class="w"> </span><span class="m">101</span><span class="w"> </span><span class="m">164</span><span class="w"> </span><span class="m">65</span><span class="w"> </span><span class="m">179</span><span class="w"> </span><span class="m">122</span><span class="w"> </span><span class="m">59</span><span class="w"> </span><span class="m">202</span><span class="w"> </span><span class="m">213</span><span class="w"> </span><span class="m">142</span><span class="w"> </span><span class="m">244</span><span class="w"> </span><span class="m">54</span><span class="w"> </span><span class="m">151</span><span class="w"> </span><span class="m">158</span><span class="w"> </span><span class="m">46</span><span class="w"> </span><span class="m">72</span><span class="w"> </span><span class="m">52</span><span class="w"> </span><span class="m">249</span><span class="w"> </span><span class="m">87</span><span class="w"> </span><span class="m">219</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">202</span><span class="w"> </span><span class="m">69</span><span class="w"> </span><span class="m">150</span><span class="w"> </span><span class="m">45</span><span class="w"> </span><span class="m">195</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">84</span><span class="w"> </span><span class="m">134</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">148</span><span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">70</span><span class="w"> </span><span class="m">144</span><span class="w"> </span><span class="m">235</span><span class="w"> </span><span class="m">236</span><span class="w"> </span><span class="m">141</span><span class="w"> </span><span class="m">234</span><span class="w"> </span><span class="m">135</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">120</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">180</span><span class="w"> </span><span class="m">69</span><span class="w"> </span><span class="m">84</span><span class="w"> </span><span class="m">35</span><span class="w"> </span><span class="m">73</span><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">71</span><span class="w"> </span><span class="m">208</span><span class="w"> </span><span class="m">212</span><span class="w"> </span><span class="m">143</span><span class="w"> </span><span class="m">135</span><span class="w"> </span><span class="m">222</span><span class="w"> </span><span class="m">115</span><span class="w"> </span><span class="m">85</span><span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">172</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">202</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">249</span><span class="w"> </span><span class="m">109</span><span class="w"> </span><span class="m">71</span><span class="w"> </span><span class="m">41</span><span class="w"> </span><span class="m">255</span><span class="w"> </span><span class="m">177</span><span class="w"> </span><span class="m">105</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">134</span><span class="w"> </span><span class="m">33</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">54</span><span class="w"> </span><span class="m">254</span><span class="w"> </span><span class="m">210</span><span class="o">]</span>

The<span class="w"> </span>above<span class="w"> </span>structure<span class="w"> </span>is<span class="w"> </span>what<span class="w"> </span>you<span class="w"> </span>would<span class="w"> </span>save<span class="w"> </span><span class="k">in</span><span class="w"> </span>order<span class="w"> </span>to<span class="w"> </span>persist<span class="w"> </span>this<span class="w"> </span>key<span class="w"> </span>blob.

Below<span class="w"> </span>is<span class="w"> </span>how<span class="w"> </span>the<span class="w"> </span>above<span class="w"> </span>structure<span class="w"> </span>would<span class="w"> </span>typically<span class="w"> </span>be<span class="w"> </span>saved,<span class="w"> </span><span class="k">in</span><span class="w"> </span>PEM<span class="w"> </span>Format:

-----BEGIN<span class="w"> </span>HSM<span class="w"> </span>ENCRYPTED<span class="w"> </span>AES<span class="w"> </span>SECRET<span class="w"> </span>KEY-----
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADsIIxQY2Y9lWElrfi1CQo
AAAAAAAAjSYAAAAAAAAAARI02Z40nx3cCn768IGo8w+e3CAenv5Jby1m5qLR9l3Y
yGzfdCBtAVJXpmzjFAk2Oxh+mg6f+qHLgBvtG9rzqesccGVtsV6/+8Z+Zl3sM76d
BLyAAXJ4h78WByq/0Yeo8eSJebSMcdOfGsBGSoIZtEtW5s/wZaRBs3o7ytWO9DaX
ni5INPlX2wvKRZYtw8hUhh6UFUaQ6+yN6ocEeAG0RVQjSRBH0NSPh95zVRoZrALK
DwL5bUcp/7FpFIYhCjb+0g<span class="o">==</span>
-----END<span class="w"> </span>HSM<span class="w"> </span>ENCRYPTED<span class="w"> </span>AES<span class="w"> </span>SECRET<span class="w"> </span>KEY-----

WK<span class="w"> </span>virtualization<span class="w"> </span>mask<span class="w"> </span>is<span class="w"> </span><span class="o">[</span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="o">]</span>
See<span class="w"> </span><span class="m">6</span>.2.2<span class="w"> </span>of<span class="w"> </span>page<span class="w"> </span><span class="m">179</span><span class="w"> </span>of<span class="w"> </span>http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

<span class="hll">WK<span class="w"> </span>ID<span class="w"> </span>is<span class="w"> </span><span class="o">[</span><span class="m">3</span><span class="w"> </span><span class="m">176</span><span class="w"> </span><span class="m">130</span><span class="w"> </span><span class="m">49</span><span class="w"> </span><span class="m">65</span><span class="w"> </span><span class="m">141</span><span class="w"> </span><span class="m">152</span><span class="w"> </span><span class="m">246</span><span class="w"> </span><span class="m">85</span><span class="w"> </span><span class="m">132</span><span class="w"> </span><span class="m">150</span><span class="w"> </span><span class="m">183</span><span class="w"> </span><span class="m">226</span><span class="w"> </span><span class="m">212</span><span class="w"> </span><span class="m">36</span><span class="w"> </span><span class="m">40</span><span class="o">]</span>
</span>See<span class="w"> </span><span class="m">6</span>.7.1<span class="w"> </span>on<span class="w"> </span>page<span class="w"> </span><span class="m">182</span><span class="w"> </span>of<span class="w">  </span>http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

Blob<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span><span class="o">[</span><span class="m">18</span><span class="w"> </span><span class="m">52</span><span class="o">]</span>
See<span class="w"> </span><span class="m">3</span>.1.1<span class="w"> </span>on<span class="w"> </span>page<span class="w"> </span><span class="m">141</span><span class="w"> </span>of<span class="w"> </span>http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

Initialization<span class="w"> </span>Vector<span class="w"> </span>is<span class="w"> </span><span class="o">[</span><span class="m">217</span><span class="w"> </span><span class="m">158</span><span class="w"> </span><span class="m">52</span><span class="w"> </span><span class="m">159</span><span class="w"> </span><span class="m">29</span><span class="w"> </span><span class="m">220</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">126</span><span class="w"> </span><span class="m">250</span><span class="w"> </span><span class="m">240</span><span class="w"> </span><span class="m">129</span><span class="w"> </span><span class="m">168</span><span class="w"> </span><span class="m">243</span><span class="w"> </span><span class="m">15</span><span class="o">]</span>

Encrypted<span class="w"> </span>part<span class="w"> </span>is<span class="w"> </span><span class="o">[</span><span class="m">158</span><span class="w"> </span><span class="m">220</span><span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">158</span><span class="w"> </span><span class="m">254</span><span class="w"> </span><span class="m">73</span><span class="w"> </span><span class="m">111</span><span class="w"> </span><span class="m">45</span><span class="w"> </span><span class="m">102</span><span class="w"> </span><span class="m">230</span><span class="w"> </span><span class="m">162</span><span class="w"> </span><span class="m">209</span><span class="w"> </span><span class="m">246</span><span class="w"> </span><span class="m">93</span><span class="w"> </span><span class="m">216</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">108</span><span class="w"> </span><span class="m">223</span><span class="w"> </span><span class="m">116</span><span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="m">109</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">82</span><span class="w"> </span><span class="m">87</span><span class="w"> </span><span class="m">166</span><span class="w"> </span><span class="m">108</span><span class="w"> </span><span class="m">227</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">54</span><span class="w"> </span><span class="m">59</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">126</span><span class="w"> </span><span class="m">154</span><span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">159</span><span class="w"> </span><span class="m">250</span><span class="w"> </span><span class="m">161</span><span class="w"> </span><span class="m">203</span><span class="w"> </span><span class="m">128</span><span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">237</span><span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">218</span><span class="w"> </span><span class="m">243</span><span class="w"> </span><span class="m">169</span><span class="w"> </span><span class="m">235</span><span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">112</span><span class="w"> </span><span class="m">101</span><span class="w"> </span><span class="m">109</span><span class="w"> </span><span class="m">177</span><span class="w"> </span><span class="m">94</span><span class="w"> </span><span class="m">191</span><span class="w"> </span><span class="m">251</span><span class="w"> </span><span class="m">198</span><span class="w"> </span><span class="m">126</span><span class="w"> </span><span class="m">102</span><span class="w"> </span><span class="m">93</span><span class="w"> </span><span class="m">236</span><span class="w"> </span><span class="m">51</span><span class="w"> </span><span class="m">190</span><span class="w"> </span><span class="m">157</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">188</span><span class="w"> </span><span class="m">128</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">114</span><span class="w"> </span><span class="m">120</span><span class="w"> </span><span class="m">135</span><span class="w"> </span><span class="m">191</span><span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">42</span><span class="w"> </span><span class="m">191</span><span class="w"> </span><span class="m">209</span><span class="w"> </span><span class="m">135</span><span class="w"> </span><span class="m">168</span><span class="w"> </span><span class="m">241</span><span class="w"> </span><span class="m">228</span><span class="w"> </span><span class="m">137</span><span class="w"> </span><span class="m">121</span><span class="w"> </span><span class="m">180</span><span class="w"> </span><span class="m">140</span><span class="w"> </span><span class="m">113</span><span class="w"> </span><span class="m">211</span><span class="w"> </span><span class="m">159</span><span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">192</span><span class="w"> </span><span class="m">70</span><span class="w"> </span><span class="m">74</span><span class="w"> </span><span class="m">130</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">180</span><span class="w"> </span><span class="m">75</span><span class="w"> </span><span class="m">86</span><span class="w"> </span><span class="m">230</span><span class="w"> </span><span class="m">207</span><span class="w"> </span><span class="m">240</span><span class="w"> </span><span class="m">101</span><span class="w"> </span><span class="m">164</span><span class="w"> </span><span class="m">65</span><span class="w"> </span><span class="m">179</span><span class="w"> </span><span class="m">122</span><span class="w"> </span><span class="m">59</span><span class="w"> </span><span class="m">202</span><span class="w"> </span><span class="m">213</span><span class="w"> </span><span class="m">142</span><span class="w"> </span><span class="m">244</span><span class="w"> </span><span class="m">54</span><span class="w"> </span><span class="m">151</span><span class="w"> </span><span class="m">158</span><span class="w"> </span><span class="m">46</span><span class="w"> </span><span class="m">72</span><span class="w"> </span><span class="m">52</span><span class="w"> </span><span class="m">249</span><span class="w"> </span><span class="m">87</span><span class="w"> </span><span class="m">219</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">202</span><span class="w"> </span><span class="m">69</span><span class="w"> </span><span class="m">150</span><span class="w"> </span><span class="m">45</span><span class="w"> </span><span class="m">195</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">84</span><span class="w"> </span><span class="m">134</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">148</span><span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">70</span><span class="w"> </span><span class="m">144</span><span class="w"> </span><span class="m">235</span><span class="w"> </span><span class="m">236</span><span class="w"> </span><span class="m">141</span><span class="w"> </span><span class="m">234</span><span class="w"> </span><span class="m">135</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">120</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">180</span><span class="w"> </span><span class="m">69</span><span class="w"> </span><span class="m">84</span><span class="o">]</span>

MAC<span class="w"> </span>is<span class="w"> </span><span class="o">[</span><span class="m">35</span><span class="w"> </span><span class="m">73</span><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">71</span><span class="w"> </span><span class="m">208</span><span class="w"> </span><span class="m">212</span><span class="w"> </span><span class="m">143</span><span class="w"> </span><span class="m">135</span><span class="w"> </span><span class="m">222</span><span class="w"> </span><span class="m">115</span><span class="w"> </span><span class="m">85</span><span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">172</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">202</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">249</span><span class="w"> </span><span class="m">109</span><span class="w"> </span><span class="m">71</span><span class="w"> </span><span class="m">41</span><span class="w"> </span><span class="m">255</span><span class="w"> </span><span class="m">177</span><span class="w"> </span><span class="m">105</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">134</span><span class="w"> </span><span class="m">33</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">54</span><span class="w"> </span><span class="m">254</span><span class="w"> </span><span class="m">210</span><span class="o">]</span>
MAC<span class="w"> </span>is<span class="w"> </span><span class="m">32</span><span class="w"> </span>bytes,<span class="w"> </span>see<span class="w"> </span>field<span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">3</span>.1<span class="w"> </span>on<span class="w"> </span>page<span class="w"> </span><span class="m">140</span><span class="w"> </span>of<span class="w"> </span>http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

Checksum<span class="w"> </span>is<span class="w"> </span><span class="o">[</span><span class="m">144</span><span class="w"> </span><span class="m">147</span><span class="w"> </span><span class="m">65</span><span class="o">]</span>,<span class="w"> </span>length<span class="w"> </span>of<span class="w"> </span>checksum<span class="w"> </span>is<span class="w"> </span><span class="m">3</span>


Original<span class="w"> </span>message,<span class="w"> </span>prior<span class="w"> </span>to<span class="w"> </span>any<span class="w"> </span>encryption<span class="w"> </span>or<span class="w"> </span>decryption<span class="w"> </span>operations:<span class="w">  </span>Hello,<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>very<span class="w"> </span>long<span class="w"> </span>and<span class="w"> </span>creative<span class="w"> </span>message<span class="w"> </span>without<span class="w"> </span>any<span class="w"> </span>imagination

<span class="k">in</span><span class="w"> </span>progress<span class="w"> </span>ciphertext<span class="w"> </span>is:
��!E�S���<span class="o">}</span>�p�!��

<span class="k">in</span><span class="w"> </span>progress<span class="w"> </span>ciphertext<span class="w"> </span>is:
��!E�S���<span class="o">}</span>�p�!��7I�Hd�i�7p�/N˽.�g��K�<span class="p">;</span>����_����NØtk���YH�^�

Final<span class="w"> </span>ciphertext<span class="w"> </span>is:
��!E�S���<span class="o">}</span>�p�!��7I�Hd�i�7p�/N˽.�g��K�<span class="p">;</span>����_����NØtk���YH�^���H�5f�!��&gt;-<span class="w"></span>c

In<span class="w"> </span>progress<span class="w"> </span>decryption<span class="w"> </span>is:


In<span class="w"> </span>progress<span class="w"> </span>decryption<span class="w"> </span>is:
Hello,<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>very<span class="w"> </span>long<span class="w"> </span>and<span class="w"> </span>creative<span class="w"> </span>message<span class="w"> </span>without<span class="w"> </span>any<span class="w"> </span>imag

Final<span class="w"> </span>decryption<span class="w"> </span>is:
Hello,<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>very<span class="w"> </span>long<span class="w"> </span>and<span class="w"> </span>creative<span class="w"> </span>message<span class="w"> </span>without<span class="w"> </span>any<span class="w"> </span>imagination

Original<span class="w"> </span>message<span class="w"> </span>equals<span class="w"> </span>decrypted<span class="w"> </span>message!

Original<span class="w"> </span>message:<span class="w">  </span>Hello,<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>very<span class="w"> </span>long<span class="w"> </span>and<span class="w"> </span>creative<span class="w"> </span>message<span class="w"> </span>without<span class="w"> </span>any<span class="w"> </span>imagination
Length<span class="w"> </span>of<span class="w"> </span>original<span class="w"> </span>message:<span class="w"> </span><span class="m">71</span>

Encrypted<span class="w"> </span>message
��!E�S���<span class="o">}</span>�p�!��7I�Hd�i�7p�/N˽.�g��K�<span class="p">;</span>����_����NØtk���YH�^���H�5f�!��&gt;-<span class="w"></span>c
Length<span class="w"> </span>of<span class="w"> </span>encrypted<span class="w"> </span>message:<span class="w"> </span><span class="m">80</span>

Decrypted<span class="w"> </span>message:<span class="w"> </span>Hello,<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>very<span class="w"> </span>long<span class="w"> </span>and<span class="w"> </span>creative<span class="w"> </span>message<span class="w"> </span>without<span class="w"> </span>any<span class="w"> </span>imagination
Length<span class="w"> </span>of<span class="w"> </span>decrypted<span class="w"> </span>message:<span class="w"> </span><span class="m">71</span>
</code></pre></div></td></tr></table></div>
</details>
<p>The mechanism used to generate the key is <em>CKM_AES_KEY_GEN</em> which informs us that we wish to generate an AES secret key.</p>
<p>The length of the key blob is 256 bytes.  Notice that this key blob contains metadata used by the EP11 library, so it contains much more than the actual key, which is 256 bits, not bytes.  In fact we can't even see the key in cleartext form.  It is encrypted within the key blob by the Crypto Express 7S card domain's <em>root wrapping key</em>. The only place the key we created is ever available in the clear is while it is being used inside the Crypto Express 7S card, because the root wrapping key never leaves the card.</p>
<p>The ID of the root wrapping key of the Crypto Express 7S card domain is listed in the output in the line that starts with <em>WK ID is</em>.  This ID is the first sixteen bytes of the hash of the key. It is not the full hash, and even if it was, you cannot retrieve the original data from the hash, so the root wrapping key remains secret.</p>
<p>The ID of the root wrapping key for our Crypto Express 7S card domain is</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="m">3</span><span class="w"> </span><span class="m">176</span><span class="w"> </span><span class="m">130</span><span class="w"> </span><span class="m">49</span><span class="w"> </span><span class="m">65</span><span class="w"> </span><span class="m">141</span><span class="w"> </span><span class="m">152</span><span class="w"> </span><span class="m">246</span><span class="w"> </span><span class="m">85</span><span class="w"> </span><span class="m">132</span><span class="w"> </span><span class="m">150</span><span class="w"> </span><span class="m">183</span><span class="w"> </span><span class="m">226</span><span class="w"> </span><span class="m">212</span><span class="w"> </span><span class="m">36</span><span class="w"> </span><span class="m">40</span><span class="o">]</span>
</code></pre></div>
<p>As you perform the exercises in this lab, you may notice that any time I print out the <em>WK ID</em>, it will always be this value.</p>
<p>The encryption in this exercise takes place in multiple calls.  One may either encrypt all of the data in a single call to a function named <em>Encrypt()</em>, or may make multiple calls by performing one or more calls to <em>EncryptUpdate()</em> followed by a call to <em>EncryptFinal()</em>.  This sample program uses the latter approach, so in the output you see two lines that say <em>In progress ciphertext is</em> that show the results so far after each <em>EncryptUpdate()</em> call and then a line that says <em>Final ciphertext is</em> after the call to <em>EncryptFinal()</em>.  Decryption follows the same pattern-  two calls to <em>DecryptUpdate()</em> followed by a call to <em>DecryptFinal()</em>, and the output in the program indicates this.</p>
</li>
<li>
<p>The program for this exercise defaults to a key length of 256 bits.  Try running with a key length of 128 bits:</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex2<span class="w"> </span>--keyLength<span class="w"> </span><span class="m">128</span>
</code></pre></div>
<details class="example">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Generated AES Key with mechanism  CKM_AES_KEY_GEN

length of key blob is 256 bytes
Key blob is (values in decimal):
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 0 0 0 0 0 0 141 38 0 0 0 0 0 0 0 1 18 52 3 221 177 141 112 242 216 176 144 18 6 175 10 206 202 162 226 99 67 216 88 101 201 3 114 172 228 151 134 15 141 183 46 209 125 119 136 246 196 223 189 56 243 204 100 151 226 149 160 128 229 255 216 226 133 171 65 244 16 197 245 172 136 232 118 184 206 173 34 79 215 214 202 250 8 237 80 168 235 252 137 221 202 76 92 21 176 127 119 178 212 220 235 169 231 144 203 67 92 32 243 99 83 171 234 198 118 71 201 176 223 202 214 117 107 152 139 105 99 39 22 243 21 20 173 175 57 84 114 199 115 225 125 30 230 123 50 120 157 37 32 151 24 77 118 170 12 222 17 3 53 7 177 238 226 18 192 102 80 131 223 195 188 205 133 31 172 138 123 48 4 244 81 224 205 165 108 128 163 226 55 208 117 70 166 128 111 166 213 158]

The above structure is what you would save in order to persist this key blob.

Below is how the above structure would typically be saved, in PEM Format:

-----BEGIN HSM ENCRYPTED AES SECRET KEY-----
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADsIIxQY2Y9lWElrfi1CQo
AAAAAAAAjSYAAAAAAAAAARI0A92xjXDy2LCQEgavCs7KouJjQ9hYZckDcqzkl4YP
jbcu0X13iPbE370488xkl+KVoIDl/9jihatB9BDF9ayI6Ha4zq0iT9fWyvoI7VCo
6/yJ3cpMXBWwf3ey1NzrqeeQy0NcIPNjU6vqxnZHybDfytZ1a5iLaWMnFvMVFK2v
OVRyx3PhfR7mezJ4nSUglxhNdqoM3hEDNQex7uISwGZQg9/DvM2FH6yKezAE9FHg
zaVsgKPiN9B1RqaAb6bVng==
-----END HSM ENCRYPTED AES SECRET KEY-----

WK virtualization mask is [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
See 6.2.2 of page 179 of http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

WK ID is [3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40]
See 6.7.1 on page 182 of  http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

Blob version is [18 52]
See 3.1.1 on page 141 of http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

Initialization Vector is [3 221 177 141 112 242 216 176 144 18 6 175 10 206]

Encrypted part is [202 162 226 99 67 216 88 101 201 3 114 172 228 151 134 15 141 183 46 209 125 119 136 246 196 223 189 56 243 204 100 151 226 149 160 128 229 255 216 226 133 171 65 244 16 197 245 172 136 232 118 184 206 173 34 79 215 214 202 250 8 237 80 168 235 252 137 221 202 76 92 21 176 127 119 178 212 220 235 169 231 144 203 67 92 32 243 99 83 171 234 198 118 71 201 176 223 202 214 117 107 152 139 105 99 39 22 243 21 20 173 175 57 84 114 199 115 225 125 30 230 123 50 120 157 37 32 151 24 77 118 170 12 222 17 3 53 7 177 238 226 18 192 102]

MAC is [80 131 223 195 188 205 133 31 172 138 123 48 4 244 81 224 205 165 108 128 163 226 55 208 117 70 166 128 111 166 213 158]
MAC is 32 bytes, see field 15 in 3.1 on page 140 of http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

Checksum is [132 58 194], length of checksum is 3


Original message, prior to any encryption or decryption operations:  Hello, this is a very long and creative message without any imagination

in progress ciphertext is:
���[�F�Vl

in progress ciphertext is:
���[̶:���l
        �.�W�+�]n,�#�-��{������4��uj��!�
                                            v

Final ciphertext is:
���[̶:���l
        �.�W�+�]n,�#�-��{������4��uj��!�
                                            v��7Ѵ��,��5-��

In progress decryption is:


In progress decryption is:
Hello, this is a very long and creative message without any imag

Final decryption is:
Hello, this is a very long and creative message without any imagination

Original message equals decrypted message!

Original message:  Hello, this is a very long and creative message without any imagination
Length of original message: 71

Encrypted message
���[̶:���l
        �.�W�+�]n,�#�-��{������4��uj��!�
                                            v��7Ѵ��,��5-��
Length of encrypted message: 80

Decrypted message: Hello, this is a very long and creative message without any imagination
Length of decrypted message: 71
</code></pre></div>
</details>
<p>Our first run of this program used a key length of 256 bits, and this run used a key length of 128 bits.  Notice that the key blob itself is still 256 bytes in length. </p>
<p>By the way, the gibberish printed out in the encrypted message portion of the output is because a byte of ciphertext is likely to contain any value from 0 to 255 and only a portion of those will turn out to be printable characters if you try to treat it as if it was a character string and try to print it out like this program does-  you may see one or more lines, if one of the ciphertext bytes produced happens to be the value of a linefeed character, and if it is a carriage return without a line feed it may have "overwritten" some of the preceding gibberish.  Real life use cases aren't typically going to require you to print ciphertext as this program did for education purposes.</p>
</li>
<li>
<p>Try with a key length of 192 bits:</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex2<span class="w"> </span>--keyLength<span class="w"> </span><span class="m">192</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Output not shown here, it should be similar to the prior two commands.</p>
</div>
</li>
<li>
<p>Try with a key length of 384 bits:</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex2<span class="w"> </span>--keyLength<span class="w"> </span><span class="m">384</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>panic: GenerateKey Error: rpc error: code = Unknown desc = CKR_KEY_SIZE_RANGE

goroutine 1 [running]:
main.encryptAndDecrypt(0x180, 0xa28e3b, 0x47)
    /home/hyper-protect-lab/go/src/github.com/ibm-developer/ibm-cloud-hyperprotectcrypto/golang/lab/exercise2.go:55 +0x2c89
main.main()
    /home/hyper-protect-lab/go/src/github.com/ibm-developer/ibm-cloud-hyperprotectcrypto/golang/lab/main.go:73 +0x3a3
</code></pre></div>
</details>
<p>Don't panic!  (Even if Go did).  I meant for this to happen.</p>
<p>This exercise uses the <em>CKM_AES_KEY_GEN</em> mechanism.  (This is in the first line of the program output).  If we run exercise one again and pipe its output to grep, with a fancy argument to print one extra line, we can see that the minimum key size is 128 bits and the maximum key size is 256 bits.  Try it:</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex1<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>CKM_AES_KEY_GEN<span class="w"> </span>--after-context<span class="w"> </span><span class="m">1</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The minimum and maximum key sizes are shown in bytes, so you must multiply the values shown by eight to get the sizes in bits.</p>
</div>
</li>
<li>
<p>So our key size must be in a range from 128 to 256 bits.  Let's try a key length of 224 bits:</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex2<span class="w"> </span>--keyLength<span class="w"> </span><span class="m">224</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>panic: GenerateKey Error: rpc error: code = Unknown desc = CKR_KEY_SIZE_RANGE

goroutine 1 [running]:
main.encryptAndDecrypt(0xe0, 0xa28e3b, 0x47)
    /home/hyper-protect-lab/go/src/github.com/ibm-developer/ibm-cloud-hyperprotectcrypto/golang/lab/exercise2.go:55 +0x2c89
main.main()
    /home/hyper-protect-lab/go/src/github.com/ibm-developer/ibm-cloud-hyperprotectcrypto/golang/lab/main.go:73 +0x3a3
</code></pre></div>
</details>
<p>Is this the new math where 224 is not between 128 and 256? No. What's going on here is that the AES standard supports keys of a certain length-  128, 192, and 256 bits. So while the mechanism information told us the minimum and maximum key size, the expectation is that the programmer knows a little bit about the AES standard when using it!</p>
</li>
<li>
<p>Would you like to encrypt and decrypt your own text?  Try it like this-  feel free to copy and paste what is provided here, or substitute your own witty banter for the value of the <code>--plaintext</code> argument.</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex2<span class="w"> </span>--plaintext<span class="w"> </span><span class="s2">&quot;The quick brown fox jumped over the lazy dog&quot;</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Output not shown, but you should see the message being encrypted and decrypted.  Unless...</p>
</div>
<div class="admonition troubleshooting">
<p class="admonition-title">Troubleshooting</p>
<p>If you received this message in your output, <code>panic: Failed Encrypt [rpc error: code = Unknown desc = CKR_ARGUMENTS_BAD]</code>,
then there is a pretty good chance that you supplied a plaintext value less than twenty-one characters in length.</p>
<p>This exercise was based on the sample code, which performs the encryption in two steps.
The first step passed the first twenty bytes of input to the crypto card, and the second step passed the remainder of
the input. The input was hard-coded and of length greater than twenty bytes, so the sample does not have logic to handle input of twenty bytes or less. The sample has not been modified to handle the case where that second pass isn't needed. </p>
<p>Don't worry, in the real world, you can probably solve this problem if you throw enough money at it. :-)</p>
</div>
</li>
</ol></section><section class="print-page" id="grep11-lab-lab-exercise3"><h1 id="grep11-lab-lab-exercise3-exercise-3-sign-and-verify-data">Exercise 3 - Sign and Verify Data<a class="headerlink" href="#grep11-lab-lab-exercise3-exercise-3-sign-and-verify-data" title="Permanent link">&para;</a></h1>
<h2 id="grep11-lab-lab-exercise3-overview-of-exercise-3">Overview of Exercise 3<a class="headerlink" href="#grep11-lab-lab-exercise3-overview-of-exercise-3" title="Permanent link">&para;</a></h2>
<p>Exercise three uses <em>public key cryptography</em> to demonstrate signing of data and then verifying the signature.</p>
<p>Other terms often used that are associated with public key cryptography are <em>asymmetric keys</em> or <em>public and private key pairs</em>.</p>
<p>The major characteristic is that an asymmetric key is actually a pair of keys that are related.  One key is called the public key and can be shared with anyone.  The other key is called the private key and is kept secret. </p>
<p>These key pairs can be used for encryption and decryption, as well as for creating and verifying digital signatures.</p>
<h2 id="grep11-lab-lab-exercise3-public-key-cryptography-in-simple-terms">Public key cryptography in simple terms<a class="headerlink" href="#grep11-lab-lab-exercise3-public-key-cryptography-in-simple-terms" title="Permanent link">&para;</a></h2>
<div class="admonition note">
<p class="admonition-title">Public key cryptography and encryption</p>
<p>When using public key cryptography, the assumption is that anybody in the world could have your public key, but you have kept your private key to yourself.</p>
<p>For encryption, anybody who has your public key could encrypt data with it and send you that encrypted data, or ciphertext. If an adversary possessed the ciphertext, they could not decrypt it.  Only you, with your private key, can decrypt it.</p>
<p>Technically, you could encrypt data with your private key that holders of your public key could decrypt, but this use case doesn't make sense- since anybody could have your public key, you have not managed to achieve privacy with your encryption.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Public key cryptography and digital signatures</p>
<p>Your private key can be used to allow you to digitally "sign" data, which is an attestation that you have seen the data that you have signed, analagous to your signing by pen a letter or contract on a piece of paper. </p>
<p>There are different digital signature algorithms, but in general, they follow the following pattern.  Assume you want to digitally sign some data you send to somebody:</p>
<ol>
<li>You create a digest, or hash, over some data, using some algorithm.  This hash uniquely identifies the data.</li>
<li>You encrypt this hash with your private key. This is your digital signature.</li>
<li>You send the data, and your digital signature, to the intended recipient.</li>
<li>The recipient calculates the digest, or hash, of the data, using the same algorithm that you used in step 1. If the data has remained intact in transit, they will calculate the same hash that you did in step 1.</li>
<li>They then decrypt your signature (from step 2) with your public key. This retrieves in plaintext the hash you signed in step 2.</li>
<li>If the hash they calculated in step 4 matches the hash that you encrypted with your private key in step 2 (and retrieved by them in step 5), then it is proof that you have seen the data they have received.</li>
</ol>
<p>The fundamental assumption is that you have kept your private key in your sole possession. If an adversary stole your private key they could impersonate you.</p>
<p>Also, observe that the validity of this digital signature is independent of whether or not the data that you send is plaintext or ciphertext.</p>
</div>
<p>The two most commonly used forms of public key cryptography are <em>RSA</em> cryptography and <em>elliptic curve</em> cryptography. </p>
<p><a href="https://tools.ietf.org/html/rfc8017" target="_blank">RSA cryptography</a> was developed first and is built upon the difficulty of factoring the product of two very large prime numbers. It is easy for a computer to find two very large prime numbers and multiply them together to obtain a product.  On the other hand, given this product, it is extremely difficult, if not impossible, for even today's powerful computers to figure out what two prime numbers were used to produce that product! It seems like a preposterous statement, but it's true!</p>
<p><a href="https://csrc.nist.gov/Projects/elliptic-curve-cryptography" target="_blank">Elliptic curve cryptography</a> is based on algebraic equations called elliptic curves. The idea is that a mathematical addition function can be defined on this curve, such that it is very easy for a computer to do a large number of additions on the curve which results in a point on the curve. But if you give someone the equation for the curve, and the point on the curve that you have calculated, but you don't tell them how many additions you did to calculate this point, even today's powerful computers cannot figure out how many additions were performed!  It seems like a preposterous statement, but it's true!</p>
<p>In simple terms, an RSA public key contains the product of the two primes, and the RSA private key contains the hidden information- the two primes. An elliptic curve public key contains all of the information about the curve, including the point that was calculated, except for the number of additions used to calculate the point, while the elliptic curve private key includes the hidden information- the number of additions that were used to create the point.</p>
<p>If I multiplied two small prime numbers like 7 x 13 and gave you the product 91, it probably wouldn't take you too long to factor it back to 7 and 13.  Computers need to use incredibliy large prime numbers in order to calculate a product that another computer can't quickly factor.  That is why RSA keys are usually 2048 or 4096 bits in length.  You can create smaller RSA keys but today's computers can factor the product contained in the public key quicker, the smaller the key.</p>
<p>On the other hand, the size of elliptic curve public keys can be much smaller than RSA public keys, and provide the equivalent strength. That is, a relatively small-sized elliptic curve key is just as difficult for a computer to crack by brute force than it is for a much larger-sized RSA key.  </p>
<p>For this reason, elliptic curve cryptography is becoming increasingly popular- the smaller key size means less computational power is needed to work with these keys, so they are more efficient and use less power, which is more appealing for devices that are typically drawing on battery power, like smartphones and tablets.</p>
<p>EP11 supports both RSA and elliptic curve cryptography, as you saw in the GREP11 sample.  This exercise will dig a little deeper into elliptic curves.</p>
<h2 id="grep11-lab-lab-exercise3-run-exercise-3">Run Exercise 3<a class="headerlink" href="#grep11-lab-lab-exercise3-run-exercise-3" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Run the third exercise:</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex3
</code></pre></div>
<details class="example">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>selected curve P521 with ObjectID of 1.3.132.0.35
Curve ObjectID in ASN.1 BER encoding is [6 5 43 129 4 0 35]

Generated ECDSA PKCS key pair with mechanism  CKM_EC_KEY_PAIR_GEN

key pair public key blob length is 286 bytes

key pair public key blob is [48 129 155 48 16 6 7 42 134 72 206 61 2 1 6 5 43 129 4 0 35 3 129 134 0 4 1 251 93 197 238 11 2 165 14 39 212 27 175 77 65 78 70 252 221 242 195 236 163 3 63 184 70 158 146 51 22 230 181 30 78 101 47 150 133 100 197 101 31 144 59 192 199 237 14 94 86 237 73 52 79 1 45 220 65 57 113 117 113 173 220 70 0 48 137 50 146 141 22 219 122 151 69 232 10 132 29 121 198 108 226 233 9 117 185 16 125 236 113 235 136 54 127 109 229 150 26 117 63 231 242 158 101 248 86 80 17 69 31 217 156 122 140 30 75 132 155 187 35 148 239 49 81 172 10 210 181 169 4 16 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 4 32 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 8 255 72 74 131 146 172 234 187 4 8 0 0 0 0 0 0 0 1 4 20 16 1 0 0 0 1 128 128 0 1 128 128 128 1 0 10 0 0 0 1 4 32 217 93 11 148 136 24 62 138 168 213 244 131 187 81 107 102 114 120 167 70 193 179 233 4 32 228 144 160 232 167 125 167]

key pair private key blob length is 896 bytes

key pair private key blob is [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 0 0 0 0 0 0 1 38 0 0 0 0 0 0 0 1 18 52 145 242 100 209 252 135 97 118 108 26 68 196 204 214 35 186 208 121 174 78 194 146 179 179 92 26 100 178 30 39 144 58 232 153 47 120 177 131 143 109 255 143 188 55 83 243 168 100 93 113 176 50 33 176 209 178 137 124 13 64 217 65 230 242 127 41 206 53 149 52 238 111 241 174 206 137 141 251 17 145 233 76 219 82 103 108 35 168 57 114 44 179 164 157 12 81 167 193 171 27 42 69 50 108 161 45 227 151 199 15 59 120 177 122 62 66 95 9 115 57 85 29 132 224 146 162 177 224 143 36 125 126 210 113 18 73 145 60 48 109 176 162 41 145 33 242 93 154 122 118 216 252 111 7 253 207 195 227 151 15 112 99 44 177 14 14 193 35 199 207 79 29 219 88 146 132 3 80 128 196 150 37 18 7 192 185 68 38 158 232 84 145 198 24 210 154 34 157 76 53 244 18 31 194 99 80 36 31 225 41 141 69 135 116 43 239 186 193 84 112 103 110 56 148 66 115 76 202 125 45 15 86 124 24 19 247 208 131 51 37 186 172 94 58 155 214 238 131 253 48 86 125 62 240 123 236 237 88 76 218 21 215 202 210 90 29 119 239 2 237 11 242 202 214 116 98 88 90 15 0 12 170 20 96 132 49 224 57 22 113 123 27 19 173 121 50 99 116 175 20 153 192 223 84 121 17 154 88 74 118 245 131 21 179 162 154 44 182 15 66 240 9 154 118 1 122 101 101 103 14 207 47 167 133 152 187 147 221 241 84 223 72 136 243 239 77 65 121 219 208 223 95 175 139 39 100 52 227 185 126 22 143 41 183 28 57 63 238 117 196 172 63 131 116 248 74 165 132 160 77 148 174 44 102 91 29 49 74 230 85 215 83 154 130 46 164 163 212 85 82 103 5 205 233 181 126 160 118 154 65 120 155 89 224 218 132 99 158 134 210 225 219 252 254 167 208 170 164 148 97 226 25 236 152 47 113 74 5 73 177 157 60 120 4 62 87 17 116 190 73 132 124 17 61 46 63 12 184 8 74 177 100 119 151 58 163 126 181 199 95 202 99 112 64 55 97 66 138 83 168 62 160 62 8 160 148 126 215 124 65 228 200 122 192 129 121 18 135 244 95 4 94 0 231 246 49 195 181 35 72 161 110 97 180 135 111 33 28 173 49 235 8 58 56 217 31 159 195 61 195 34 10 160 111 224 53 22 175 9 79 39 142 46 43 91 210 69 183 229 68 114 86 142 221 196 206 234 143 244 49 236 231 253 226 95 36 14 131 74 48 31 144 4 254 235 158 189 98 28 1 100 181 19 139 69 29 166 136 227 85 21 131 130 138 197 249 29 222 65 128 252 16 217 121 157 232 150 126 54 245 116 145 127 175 167 125 46 94 214 38 224 85 172 87 97 163 231 181 218 248 103 211 224 79 122 157 160 76 54 242 13 46 182 10 105 119 6 51 91 11 116 120 2 188 148 108 191 158 100 28 40 158 212 35 94 53 6 59 84 216 207 101 112 40 178 164 252 110 116 39 59 78 78 7 204 241 147 2 234 244 153 214 32 151 187 250 112 162 173 136 214 67 114 195 102 170 240 228 160 123 41 178 7 2 147 66 5 236 100 170 198 233 8 218 163 244 224 211 8 127 36 60 220 185 158 17 171 78 156 168 141 73 86 146 47 252 55 247 12 105 21 170 199 27 69 149 217 78 89 37 125 246 220 29 177 15 18 78 153 170 123 109 248 47 4 130 121 174 88 44 96 61 71 208 112 34 236 111 189 240 195 15 45 176 84 140 35 171 110 124 164 98 0 122 173 69 82 27 118 51 226 30 193 106 51 21 83 194 189 110 18 92 156 198 221 189 211 84 220 207]

Some of the fields in the private key blob follow: 

WK ID is [3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40]
See 6.7.1 of page 182 of  http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

Blob version is [18 52]
See 3.1.1 on page 141 of http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

IV is [145 242 100 209 252 135 97 118 108 26 68 196 204 214]

Encrypted part is [35 186 208 121 174 78 194 146 179 179 92 26 100 178 30 39 144 58 232 153 47 120 177 131 143 109 255 143 188 55 83 243 168 100 93 113 176 50 33 176 209 178 137 124 13 64 217 65 230 242 127 41 206 53 149 52 238 111 241 174 206 137 141 251 17 145 233 76 219 82 103 108 35 168 57 114 44 179 164 157 12 81 167 193 171 27 42 69 50 108 161 45 227 151 199 15 59 120 177 122 62 66 95 9 115 57 85 29 132 224 146 162 177 224 143 36 125 126 210 113 18 73 145 60 48 109 176 162 41 145 33 242 93 154 122 118 216 252 111 7 253 207 195 227 151 15 112 99 44 177 14 14 193 35 199 207 79 29 219 88 146 132 3 80 128 196 150 37 18 7 192 185 68 38 158 232 84 145 198 24 210 154 34 157 76 53 244 18 31 194 99 80 36 31 225 41 141 69 135 116 43 239 186 193 84 112 103 110 56 148 66 115 76 202 125 45 15 86 124 24 19 247 208 131 51 37 186 172 94 58 155 214 238 131 253 48 86 125 62 240 123 236 237 88 76 218 21 215 202 210 90 29 119 239 2 237 11 242 202 214 116 98 88 90 15 0 12 170 20 96 132 49 224 57 22 113 123 27 19 173 121 50 99 116 175 20 153 192 223 84 121 17 154 88 74 118 245 131 21 179 162 154 44 182 15 66 240 9 154 118 1 122 101 101 103 14 207 47 167 133 152 187 147 221 241 84 223 72 136 243 239 77 65 121 219 208 223 95 175 139 39 100 52 227 185 126 22 143 41 183 28 57 63 238 117 196 172 63 131 116 248 74 165 132 160 77 148 174 44 102 91 29 49 74 230 85 215 83 154 130 46 164 163 212 85 82 103 5 205 233 181 126 160 118 154 65 120 155 89 224 218 132 99 158 134 210 225 219 252 254 167 208 170 164 148 97 226 25 236 152 47 113 74 5 73 177 157 60 120 4 62 87 17 116 190 73 132 124 17 61 46 63 12 184 8 74 177 100 119 151 58 163 126 181 199 95 202 99 112 64 55 97 66 138 83 168 62 160 62 8 160 148 126 215 124 65 228 200 122 192 129 121 18 135 244 95 4 94 0 231 246 49 195 181 35 72 161 110 97 180 135 111 33 28 173 49 235 8 58 56 217 31 159 195 61 195 34 10 160 111 224 53 22 175 9 79 39 142 46 43 91 210 69 183 229 68 114 86 142 221 196 206 234 143 244 49 236 231 253 226 95 36 14 131 74 48 31 144 4 254 235 158 189 98 28 1 100 181 19 139 69 29 166 136 227 85 21 131 130 138 197 249 29 222 65 128 252 16 217 121 157 232 150 126 54 245 116 145 127 175 167 125 46 94 214 38 224 85 172 87 97 163 231 181 218 248 103 211 224 79 122 157 160 76 54 242 13 46 182 10 105 119 6 51 91 11 116 120 2 188 148 108 191 158 100 28 40 158 212 35 94 53 6 59 84 216 207 101 112 40 178 164 252 110 116 39 59 78 78 7 204 241 147 2 234 244 153 214 32 151 187 250 112 162 173 136 214 67 114 195 102 170 240 228 160 123 41 178 7 2 147 66 5 236 100 170 198 233 8 218 163 244 224 211 8 127 36 60 220 185 158 17 171 78 156 168 141 73 86 146 47 252 55 247 12 105 21 170 199 27 69 149 217 78 89 37 125 246 220 29 177 15 18 78 153 170 123 109 248 47 4 130 121 174 88 44 96 61 71 208 112 34 236 111 189 240 195 15 45 176 84 140 35 171]

MAC is [110 124 164 98 0 122 173 69 82 27 118 51 226 30 193 106 51 21 83 194 189 110 18 92 156 198 221 189 211 84 220 207]
MAC is 32 bytes, see field 15 in 3.1 on page 140 of http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

-----BEGIN HSM ENCRYPTED PRIVATE KEY-----
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADsIIxQY2Y9lWElrfi1CQo
AAAAAAAAASYAAAAAAAAAARI0kfJk0fyHYXZsGkTEzNYjutB5rk7CkrOzXBpksh4n
kDromS94sYOPbf+PvDdT86hkXXGwMiGw0bKJfA1A2UHm8n8pzjWVNO5v8a7OiY37
EZHpTNtSZ2wjqDlyLLOknQxRp8GrGypFMmyhLeOXxw87eLF6PkJfCXM5VR2E4JKi
seCPJH1+0nESSZE8MG2woimRIfJdmnp22PxvB/3Pw+OXD3BjLLEODsEjx89PHdtY
koQDUIDEliUSB8C5RCae6FSRxhjSmiKdTDX0Eh/CY1AkH+EpjUWHdCvvusFUcGdu
OJRCc0zKfS0PVnwYE/fQgzMluqxeOpvW7oP9MFZ9PvB77O1YTNoV18rSWh137wLt
C/LK1nRiWFoPAAyqFGCEMeA5FnF7GxOteTJjdK8UmcDfVHkRmlhKdvWDFbOimiy2
D0LwCZp2AXplZWcOzy+nhZi7k93xVN9IiPPvTUF529DfX6+LJ2Q047l+Fo8ptxw5
P+51xKw/g3T4SqWEoE2UrixmWx0xSuZV11Oagi6ko9RVUmcFzem1fqB2mkF4m1ng
2oRjnobS4dv8/qfQqqSUYeIZ7JgvcUoFSbGdPHgEPlcRdL5JhHwRPS4/DLgISrFk
d5c6o361x1/KY3BAN2FCilOoPqA+CKCUftd8QeTIesCBeRKH9F8EXgDn9jHDtSNI
oW5htIdvIRytMesIOjjZH5/DPcMiCqBv4DUWrwlPJ44uK1vSRbflRHJWjt3EzuqP
9DHs5/3iXyQOg0owH5AE/uuevWIcAWS1E4tFHaaI41UVg4KKxfkd3kGA/BDZeZ3o
ln429XSRf6+nfS5e1ibgVaxXYaPntdr4Z9PgT3qdoEw28g0utgppdwYzWwt0eAK8
lGy/nmQcKJ7UI141BjtU2M9lcCiypPxudCc7Tk4HzPGTAur0mdYgl7v6cKKtiNZD
csNmqvDkoHspsgcCk0IF7GSqxukI2qP04NMIfyQ83LmeEatOnKiNSVaSL/w39wxp
FarHG0WV2U5ZJX323B2xDxJOmap7bfgvBIJ5rlgsYD1H0HAi7G+98MMPLbBUjCOr
bnykYgB6rUVSG3Yz4h7BajMVU8K9bhJcnMbdvdNU3M8=
-----END HSM ENCRYPTED PRIVATE KEY-----

-----BEGIN PUBLIC KEY-----
MIGbMBAGByqGSM49AgEGBSuBBAAjA4GGAAQB+13F7gsCpQ4n1BuvTUFORvzd8sPs
owM/uEaekjMW5rUeTmUvloVkxWUfkDvAx+0OXlbtSTRPAS3cQTlxdXGt3EYAMIky
ko0W23qXRegKhB15xmzi6Ql1uRB97HHriDZ/beWWGnU/5/KeZfhWUBFFH9mceowe
S4SbuyOU7zFRrArStakEEAOwgjFBjZj2VYSWt+LUJCgEIAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAABAj/SEqDkqzquwQIAAAAAAAAAAEEFBABAAAAAYCA
AAGAgIABAAoAAAABBCDZXQuUiBg+iqjV9IO7UWtmcninRsGz6QQg5JCg6Kd9pw==
-----END PUBLIC KEY-----

Data signed
Signature verified
</code></pre></div>
</details>
<p>The first line of the output shows the Object ID of the curve that was used. These Object IDs are assigned by standards bodies. The Object ID used here is <code>1.3.132.0.35</code>.  Stick 1.3.132.0.35 in your favorite Google machine and see what you find. Or take my word for it that this identifies the <em>secp521r1</em> curve.</p>
<p>The second line of the output shows ASN.1 BER encoding of 1.3.132.0.35, which is <em>6 5 43 129 4 0 35</em>.  If you were to look up how ASN.1 BER encoding works, your first question would be, "Why?".  Don't go there now.  But I bring it up because you will notice that a few lines down in the output, in the <em>key pair public key blob</em> section, you'll see that encoded string, <em>6 5 43 129 4 0 35</em>, about 14 bytes from the beginning.  In fact, while the whole point of using the GREP11 server and the Crypto Express 7S cards is to keep secrets from an adversary, the information shown in the <em>key pair public key blob</em> section is "in the clear"- you could give this to your adversary without fear of having your secrets compromised.</p>
<p>The list of decimal bytes of these keys is mostly gibberish to us humans, I'm not sure why I even bothered to print them out, but take a look at the output at the end, where there are several lines between a header and footer for HSM ENCRYPTED PRIVATE KEY (BEGIN and END), and several lines between a header and footer for a PUBLIC KEY.</p>
<p>To use these keys in the future, you would need to persist both of these to separate files. You wouldn't have a reason to give your adversary the HSM ENCRYPTED PRIVATE KEY, but, if he did obtain it, it would be of no value to him unless he was able to access your Crypto Express 7S card that had the same root wrapping key. The contents of this file are encrypted and are usuable only within the Crypto Express card that created it, or in another Crypto Express card that had the same root wrapping key.</p>
<p>Since the PUBLIC KEY is, by definition, shareable with the world, we can use the common <code>openssl</code> utility to look at it. </p>
<p>Try it like this:</p>
<ol>
<li>
<p>Copy the lines from near the bottom of your output that have your public key , including the <em>BEGIN PUBLIC KEY</em> and <em>END PUBLIC KEY</em> header and footer lines, and the dashes, into your clipboard</p>
</li>
<li>
<p>In a terminal window,  type <code>echo "</code> (that is a single pair of double-quotes) and then paste your clipboard contents onto the command line</p>
</li>
<li>
<p>Type <code>" | openssl ec -in - -pubin -noout -text</code> and then press Enter</p>
</li>
</ol>
<details class="example">
<summary>You should see output similar to this:</summary>
<div class="highlight"><pre><span></span><code>read EC key
Public-Key: (521 bit)
pub:
    04:00:59:fe:0c:b3:d0:6e:b2:d7:b0:c0:05:86:66:
    dd:62:bc:fe:96:5c:fa:08:6d:f3:be:5f:6d:a1:3d:
    8f:40:13:83:23:ec:34:e4:e5:20:6c:f9:75:34:bd:
    30:cd:be:1f:5b:aa:ee:44:99:d9:ae:69:50:24:c7:
    82:7c:f4:f2:18:d1:b0:00:be:5c:64:f5:dd:16:79:
    eb:d4:9c:28:ae:43:9b:f4:13:a4:f3:db:3c:a2:e5:
    52:bb:0f:9f:e1:c4:a4:c1:29:63:4e:bc:2f:73:4c:
    da:fd:4f:42:63:0d:3d:9d:bb:29:76:57:85:13:57:
    3a:ae:8f:20:64:0a:cf:c2:f1:41:d3:fc:8a
ASN1 OID: secp521r1
NIST CURVE: P-521
</code></pre></div>
</details>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you are a Linux guru you could create a file with <em>vi</em> and copy the key into the file, and then provide that as input to the openssl command, e.g., <code>openssl ec -in baz -pubin -noout -text</code> if <em>baz</em> was the file you created.</p>
</div>
<p>In the exercise output I first printed the public key as an array of decimal numbers (worthless!),  then I printed it in PEM-encoded format (boring!) but now you see the key in hexadecimal format (that's incredible!!). You also get the added bonus of knowing it's a legit public key since the <code>openssl</code> utility made sense of it.</p>
</li>
<li>
<p>Try  using a different curve:</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex3<span class="w"> </span>--curve<span class="w"> </span>P224
</code></pre></div>
<details class="example">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>selected curve P224 with ObjectID of 1.3.132.0.33
Curve ObjectID in ASN.1 BER encoding is [6 5 43 129 4 0 33]

Generated ECDSA PKCS key pair with mechanism  CKM_EC_KEY_PAIR_GEN

key pair public key blob length is 208 bytes

key pair public key blob is [48 78 48 16 6 7 42 134 72 206 61 2 1 6 5 43 129 4 0 33 3 58 0 4 177 164 170 83 241 4 140 49 236 115 12 22 130 206 48 90 174 181 135 16 59 31 11 122 14 254 13 172 129 64 249 1 40 44 231 155 52 110 38 67 175 244 45 81 157 5 213 125 224 199 126 65 251 200 159 53 4 16 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 4 32 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 8 6 63 231 63 240 230 179 88 4 8 0 0 0 0 0 0 0 1 4 20 16 1 0 0 0 1 128 128 0 1 128 128 128 1 0 10 0 0 0 1 4 32 90 61 58 127 30 244 119 154 65 27 170 14 182 232 45 237 92 61 188 238 138 237 84 7 5 209 228 172 195 235 219 189]

key pair private key blob length is 544 bytes

key pair private key blob is [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 0 0 0 0 0 0 1 38 0 0 0 0 0 0 0 1 18 52 1 7 210 186 20 15 180 182 68 217 17 251 23 142 218 85 206 228 75 16 37 108 9 47 216 5 160 29 100 235 78 164 63 25 232 181 251 214 113 69 26 198 9 222 119 149 66 64 233 183 172 93 96 41 223 99 201 110 138 227 51 26 197 166 9 8 190 40 129 254 49 89 54 38 209 21 60 137 118 113 174 145 254 145 152 119 73 114 11 144 41 25 106 152 140 167 192 88 82 199 100 234 18 255 129 213 111 25 126 2 200 3 44 90 252 84 48 191 106 98 2 77 78 7 165 189 227 52 167 78 188 5 185 254 178 206 180 171 47 110 54 38 87 16 191 167 134 237 48 49 153 168 54 225 251 75 223 3 55 239 48 119 76 89 103 20 30 222 104 167 219 210 46 17 75 224 196 191 55 238 236 156 205 119 182 199 12 58 144 248 124 216 181 38 11 17 139 144 123 31 108 76 171 91 154 112 6 160 188 2 181 110 212 46 66 153 211 21 184 1 51 194 12 245 73 155 192 206 80 213 51 187 166 3 207 127 151 127 59 158 192 7 92 113 247 118 108 55 217 84 183 34 24 144 57 215 193 96 179 93 2 190 84 85 119 199 179 96 119 2 9 160 231 251 214 187 5 206 224 207 111 52 58 181 131 237 11 245 106 181 223 217 240 98 162 190 11 116 18 46 225 218 17 130 79 19 4 171 94 129 197 59 201 54 63 31 60 90 84 225 223 121 94 173 42 103 3 204 128 187 143 209 78 80 151 157 90 44 76 20 254 18 96 197 70 36 135 24 13 156 77 112 196 22 35 123 199 169 17 195 156 0 212 50 140 50 126 70 132 126 149 172 94 173 49 156 173 207 208 109 166 88 148 204 25 122 119 58 130 215 130 101 13 235 96 29 210 130 229 51 232 250 206 124 162 68 112 3 191 129 184 195 34 186 72 103 159 228 155 244 43 108 205 37 82 176 243 200 233 88 91 31 243 33 232 44 178 19 57 182 239 63 238 130 33 1 127 250 215 109 121 187 134 218 173 74 112 88 230 152 90 147 20 43 28 254 173 28 25 255 0 147 78 51 231 175 190 29]

Some of the fields in the private key blob follow: 

WK ID is [3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40]
See 6.7.1 of page 182 of  http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

Blob version is [18 52]
See 3.1.1 on page 141 of http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

IV is [1 7 210 186 20 15 180 182 68 217 17 251 23 142]

Encrypted part is [218 85 206 228 75 16 37 108 9 47 216 5 160 29 100 235 78 164 63 25 232 181 251 214 113 69 26 198 9 222 119 149 66 64 233 183 172 93 96 41 223 99 201 110 138 227 51 26 197 166 9 8 190 40 129 254 49 89 54 38 209 21 60 137 118 113 174 145 254 145 152 119 73 114 11 144 41 25 106 152 140 167 192 88 82 199 100 234 18 255 129 213 111 25 126 2 200 3 44 90 252 84 48 191 106 98 2 77 78 7 165 189 227 52 167 78 188 5 185 254 178 206 180 171 47 110 54 38 87 16 191 167 134 237 48 49 153 168 54 225 251 75 223 3 55 239 48 119 76 89 103 20 30 222 104 167 219 210 46 17 75 224 196 191 55 238 236 156 205 119 182 199 12 58 144 248 124 216 181 38 11 17 139 144 123 31 108 76 171 91 154 112 6 160 188 2 181 110 212 46 66 153 211 21 184 1 51 194 12 245 73 155 192 206 80 213 51 187 166 3 207 127 151 127 59 158 192 7 92 113 247 118 108 55 217 84 183 34 24 144 57 215 193 96 179 93 2 190 84 85 119 199 179 96 119 2 9 160 231 251 214 187 5 206 224 207 111 52 58 181 131 237 11 245 106 181 223 217 240 98 162 190 11 116 18 46 225 218 17 130 79 19 4 171 94 129 197 59 201 54 63 31 60 90 84 225 223 121 94 173 42 103 3 204 128 187 143 209 78 80 151 157 90 44 76 20 254 18 96 197 70 36 135 24 13 156 77 112 196 22 35 123 199 169 17 195 156 0 212 50 140 50 126 70 132 126 149 172 94 173 49 156 173 207 208 109 166 88 148 204 25 122 119 58 130 215 130 101 13 235 96 29 210 130 229 51 232 250 206 124 162 68 112 3 191 129 184 195 34 186 72 103 159 228 155 244 43 108 205 37 82 176 243 200 233 88 91 31 243 33 232 44 178 19 57 182 239 63 238 130 33 1]

MAC is [127 250 215 109 121 187 134 218 173 74 112 88 230 152 90 147 20 43 28 254 173 28 25 255 0 147 78 51 231 175 190 29]
MAC is 32 bytes, see field 15 in 3.1 on page 140 of http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

-----BEGIN HSM ENCRYPTED PRIVATE KEY-----
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADsIIxQY2Y9lWElrfi1CQo
AAAAAAAAASYAAAAAAAAAARI0AQfSuhQPtLZE2RH7F47aVc7kSxAlbAkv2AWgHWTr
TqQ/Gei1+9ZxRRrGCd53lUJA6besXWAp32PJborjMxrFpgkIviiB/jFZNibRFTyJ
dnGukf6RmHdJcguQKRlqmIynwFhSx2TqEv+B1W8ZfgLIAyxa/FQwv2piAk1OB6W9
4zSnTrwFuf6yzrSrL242JlcQv6eG7TAxmag24ftL3wM37zB3TFlnFB7eaKfb0i4R
S+DEvzfu7JzNd7bHDDqQ+HzYtSYLEYuQex9sTKtbmnAGoLwCtW7ULkKZ0xW4ATPC
DPVJm8DOUNUzu6YDz3+XfzuewAdccfd2bDfZVLciGJA518Fgs10CvlRVd8ezYHcC
CaDn+9a7Bc7gz280OrWD7Qv1arXf2fBior4LdBIu4doRgk8TBKtegcU7yTY/Hzxa
VOHfeV6tKmcDzIC7j9FOUJedWixMFP4SYMVGJIcYDZxNcMQWI3vHqRHDnADUMowy
fkaEfpWsXq0xnK3P0G2mWJTMGXp3OoLXgmUN62Ad0oLlM+j6znyiRHADv4G4wyK6
SGef5Jv0K2zNJVKw88jpWFsf8yHoLLITObbvP+6CIQF/+tdtebuG2q1KcFjmmFqT
FCsc/q0cGf8Ak04z56++HQ==
-----END HSM ENCRYPTED PRIVATE KEY-----

-----BEGIN PUBLIC KEY-----
ME4wEAYHKoZIzj0CAQYFK4EEACEDOgAEsaSqU/EEjDHscwwWgs4wWq61hxA7Hwt6
Dv4NrIFA+QEoLOebNG4mQ6/0LVGdBdV94Md+QfvInzUEEAOwgjFBjZj2VYSWt+LU
JCgEIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAgGP+c/8OazWAQI
AAAAAAAAAAEEFBABAAAAAYCAAAGAgIABAAoAAAABBCBaPTp/HvR3mkEbqg626C3t
XD287ortVAcF0eSsw+vbvQ==
-----END PUBLIC KEY-----

Data signed
Signature verified
</code></pre></div>
</details>
</li>
<li>
<p>Try the P256 curve:</p>
<div class="highlight"><pre><span></span><code>./lab --ex3 --curve P256
</code></pre></div>
<details class="example">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code>selected curve P256 with ObjectID of 1.2.840.10045.3.1.7
Curve ObjectID in ASN.1 BER encoding is [6 8 42 134 72 206 61 3 1 7]

Generated ECDSA PKCS key pair with mechanism  CKM_EC_KEY_PAIR_GEN

key pair public key blob length is 219 bytes

key pair public key blob is [48 89 48 19 6 7 42 134 72 206 61 2 1 6 8 42 134 72 206 61 3 1 7 3 66 0 4 110 106 106 221 176 75 119 181 154 179 115 108 192 148 127 80 203 20 154 165 194 20 40 117 94 117 223 125 118 133 226 230 18 128 20 46 239 61 241 136 41 9 78 202 124 188 192 93 181 229 245 210 78 187 156 152 192 132 255 162 17 51 187 117 4 16 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 4 32 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 8 203 203 135 115 66 126 231 150 4 8 0 0 0 0 0 0 0 1 4 20 16 1 0 0 0 1 128 128 0 1 128 128 128 1 0 10 0 0 0 1 4 32 117 106 180 43 131 151 71 204 222 211 38 32 214 138 208 98 235 7 172 87 236 205 51 122 54 65 64 58 70 89 127 218]

key pair private key blob length is 576 bytes

key pair private key blob is [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 0 0 0 0 0 0 1 38 0 0 0 0 0 0 0 1 18 52 234 153 96 242 234 92 129 26 151 136 72 248 23 66 196 52 4 170 78 111 124 89 151 169 22 232 12 154 65 246 71 238 229 101 98 135 230 50 24 66 130 82 190 65 48 151 138 8 183 43 229 56 95 235 90 163 68 81 9 77 56 28 104 192 150 105 31 193 133 24 224 125 104 86 165 104 162 87 247 209 66 173 168 45 232 4 229 134 211 133 24 229 196 10 32 90 129 146 138 115 39 163 206 102 141 49 142 143 55 114 160 210 56 132 237 137 157 136 203 0 20 217 144 233 140 198 26 179 60 218 95 201 29 214 100 144 55 226 195 23 83 105 50 175 174 214 216 130 2 71 17 191 197 26 180 89 147 168 61 236 49 230 64 190 217 199 13 244 173 182 255 91 144 51 231 177 252 232 210 156 130 70 14 30 129 255 82 247 162 116 213 100 248 100 190 125 48 3 168 85 249 192 75 26 221 95 113 27 1 123 130 248 176 164 140 61 141 190 157 241 193 100 2 180 163 73 141 252 213 35 213 158 95 46 85 0 94 159 101 16 31 97 109 63 64 35 238 255 208 175 121 180 84 162 66 210 119 10 131 119 187 27 116 152 2 41 62 175 176 244 123 70 42 51 244 113 238 102 113 195 54 242 80 148 90 145 226 10 180 122 94 143 119 125 187 118 7 28 184 214 205 205 97 18 71 235 186 245 199 246 57 3 208 121 40 73 6 28 64 217 154 216 108 59 46 158 80 133 8 196 11 223 201 199 234 77 99 219 238 244 6 254 96 55 5 88 109 181 57 85 82 64 67 46 13 114 56 74 117 215 61 161 26 37 221 210 18 229 131 11 232 38 101 190 54 241 253 217 100 80 205 45 113 51 237 105 252 159 11 126 74 152 22 138 45 30 188 157 151 101 139 134 16 221 153 56 216 167 210 214 79 150 96 170 83 161 118 219 162 45 113 179 106 87 147 99 222 42 122 194 24 249 53 210 222 206 2 74 232 110 135 6 12 110 53 2 15 144 180 185 58 249 41 54 36 128 61 116 221 158 154 95 142 32 213 89 48 209 47 155 239 2 142 171 218 207 130 140 18 125 86 224 20 5 4 83 108 163 82 243 62 254 77 103 87 90 32 112 50 169 54 139 200 219 92 84 191 177 139 94]

Some of the fields in the private key blob follow: 

WK ID is [3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40]
See 6.7.1 of page 182 of  http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

Blob version is [18 52]
See 3.1.1 on page 141 of http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

IV is [234 153 96 242 234 92 129 26 151 136 72 248 23 66]

Encrypted part is [196 52 4 170 78 111 124 89 151 169 22 232 12 154 65 246 71 238 229 101 98 135 230 50 24 66 130 82 190 65 48 151 138 8 183 43 229 56 95 235 90 163 68 81 9 77 56 28 104 192 150 105 31 193 133 24 224 125 104 86 165 104 162 87 247 209 66 173 168 45 232 4 229 134 211 133 24 229 196 10 32 90 129 146 138 115 39 163 206 102 141 49 142 143 55 114 160 210 56 132 237 137 157 136 203 0 20 217 144 233 140 198 26 179 60 218 95 201 29 214 100 144 55 226 195 23 83 105 50 175 174 214 216 130 2 71 17 191 197 26 180 89 147 168 61 236 49 230 64 190 217 199 13 244 173 182 255 91 144 51 231 177 252 232 210 156 130 70 14 30 129 255 82 247 162 116 213 100 248 100 190 125 48 3 168 85 249 192 75 26 221 95 113 27 1 123 130 248 176 164 140 61 141 190 157 241 193 100 2 180 163 73 141 252 213 35 213 158 95 46 85 0 94 159 101 16 31 97 109 63 64 35 238 255 208 175 121 180 84 162 66 210 119 10 131 119 187 27 116 152 2 41 62 175 176 244 123 70 42 51 244 113 238 102 113 195 54 242 80 148 90 145 226 10 180 122 94 143 119 125 187 118 7 28 184 214 205 205 97 18 71 235 186 245 199 246 57 3 208 121 40 73 6 28 64 217 154 216 108 59 46 158 80 133 8 196 11 223 201 199 234 77 99 219 238 244 6 254 96 55 5 88 109 181 57 85 82 64 67 46 13 114 56 74 117 215 61 161 26 37 221 210 18 229 131 11 232 38 101 190 54 241 253 217 100 80 205 45 113 51 237 105 252 159 11 126 74 152 22 138 45 30 188 157 151 101 139 134 16 221 153 56 216 167 210 214 79 150 96 170 83 161 118 219 162 45 113 179 106 87 147 99 222 42 122 194 24 249 53 210 222 206 2 74 232 110 135 6 12 110 53 2 15 144 180 185 58 249 41 54 36 128 61 116 221 158 154 95 142 32 213 89 48 209 47 155 239 2 142 171 218 207 130 140]

MAC is [18 125 86 224 20 5 4 83 108 163 82 243 62 254 77 103 87 90 32 112 50 169 54 139 200 219 92 84 191 177 139 94]
MAC is 32 bytes, see field 15 in 3.1 on page 140 of http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

-----BEGIN HSM ENCRYPTED PRIVATE KEY-----
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADsIIxQY2Y9lWElrfi1CQo
AAAAAAAAASYAAAAAAAAAARI06plg8upcgRqXiEj4F0LENASqTm98WZepFugMmkH2
R+7lZWKH5jIYQoJSvkEwl4oItyvlOF/rWqNEUQlNOBxowJZpH8GFGOB9aFalaKJX
99FCragt6ATlhtOFGOXECiBagZKKcyejzmaNMY6PN3Kg0jiE7YmdiMsAFNmQ6YzG
GrM82l/JHdZkkDfiwxdTaTKvrtbYggJHEb/FGrRZk6g97DHmQL7Zxw30rbb/W5Az
57H86NKcgkYOHoH/UveidNVk+GS+fTADqFX5wEsa3V9xGwF7gviwpIw9jb6d8cFk
ArSjSY381SPVnl8uVQBen2UQH2FtP0Aj7v/Qr3m0VKJC0ncKg3e7G3SYAik+r7D0
e0YqM/Rx7mZxwzbyUJRakeIKtHpej3d9u3YHHLjWzc1hEkfruvXH9jkD0HkoSQYc
QNma2Gw7Lp5QhQjEC9/Jx+pNY9vu9Ab+YDcFWG21OVVSQEMuDXI4SnXXPaEaJd3S
EuWDC+gmZb428f3ZZFDNLXEz7Wn8nwt+SpgWii0evJ2XZYuGEN2ZONin0tZPlmCq
U6F226ItcbNqV5Nj3ip6whj5NdLezgJK6G6HBgxuNQIPkLS5OvkpNiSAPXTdnppf
jiDVWTDRL5vvAo6r2s+CjBJ9VuAUBQRTbKNS8z7+TWdXWiBwMqk2i8jbXFS/sYte
-----END HSM ENCRYPTED PRIVATE KEY-----

-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEbmpq3bBLd7Was3NswJR/UMsUmqXC
FCh1XnXffXaF4uYSgBQu7z3xiCkJTsp8vMBdteX10k67nJjAhP+iETO7dQQQA7CC
MUGNmPZVhJa34tQkKAQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE
CMvLh3NCfueWBAgAAAAAAAAAAQQUEAEAAAABgIAAAYCAgAEACgAAAAEEIHVqtCuD
l0fM3tMmINaK0GLrB6xX7M0zejZBQDpGWX/a
-----END PUBLIC KEY-----

Data signed
Signature verified
</code></pre></div>
</details>
</li>
<li>
<p>Finally, try the fourth suupported curve, P384:</p>
<div class="highlight"><pre><span></span><code>./lab --ex3 --curve P384
</code></pre></div>
<details class="example">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code>selected curve P384 with ObjectID of 1.3.132.0.34
Curve ObjectID in ASN.1 BER encoding is [6 5 43 129 4 0 34]

Generated ECDSA PKCS key pair with mechanism  CKM_EC_KEY_PAIR_GEN

key pair public key blob length is 248 bytes

key pair public key blob is [48 118 48 16 6 7 42 134 72 206 61 2 1 6 5 43 129 4 0 34 3 98 0 4 20 236 106 175 76 209 142 54 136 119 12 96 68 207 237 15 207 93 133 101 224 190 191 207 252 8 13 111 41 146 195 110 245 102 246 21 126 198 152 204 142 142 123 85 205 73 71 95 199 156 111 125 60 137 24 103 37 211 215 222 89 119 181 242 0 63 164 49 14 7 40 199 86 111 168 136 8 249 164 117 253 72 33 144 66 15 126 131 230 42 32 37 210 78 27 99 4 16 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 4 32 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 8 31 146 195 59 47 0 221 196 4 8 0 0 0 0 0 0 0 1 4 20 16 1 0 0 0 1 128 128 0 1 128 128 128 1 0 10 0 0 0 1 4 32 166 134 66 17 102 8 140 118 31 64 4 242 234 134 34 72 132 116 245 10 224 174 74 101 243 172 223 184 156 51 28 103]

key pair private key blob length is 720 bytes

key pair private key blob is [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 0 0 0 0 0 0 1 38 0 0 0 0 0 0 0 1 18 52 153 221 86 12 9 88 111 233 79 50 0 98 38 116 119 42 179 162 115 61 69 173 2 50 40 5 241 34 125 95 215 44 94 60 200 193 50 47 70 234 63 92 12 149 107 163 199 247 244 21 145 94 176 100 72 240 241 146 134 62 70 238 188 1 31 91 136 108 73 110 218 192 207 194 239 183 109 245 140 135 33 148 169 75 112 120 9 173 218 117 181 74 141 98 52 108 110 115 135 113 187 153 210 17 27 101 149 108 233 171 190 217 178 69 154 188 13 79 167 107 197 222 34 246 90 23 80 87 71 32 39 100 100 38 41 239 210 168 65 58 118 220 16 7 32 148 54 163 80 1 199 139 165 132 161 234 172 7 87 11 31 106 203 50 250 123 9 145 5 40 155 103 123 16 113 60 61 210 215 238 164 150 191 97 200 231 170 17 180 184 90 104 114 10 114 61 129 222 6 139 56 248 177 110 10 53 234 143 90 10 149 134 174 170 32 237 224 29 124 102 218 206 171 105 10 18 16 233 191 119 26 12 167 215 135 23 95 83 89 171 154 14 249 247 35 202 88 83 220 5 191 52 71 15 64 20 21 62 55 241 158 98 38 95 137 193 201 253 122 71 25 10 128 22 53 60 199 175 192 194 104 68 187 83 136 228 246 102 194 153 119 139 178 33 170 80 237 242 75 179 107 184 194 221 45 216 161 217 150 100 224 22 7 94 142 242 114 3 52 237 105 123 39 61 185 226 37 38 159 64 208 219 25 170 246 223 126 122 120 135 86 193 101 6 105 148 156 12 77 162 221 200 34 202 29 228 198 5 193 112 96 95 16 225 1 6 41 252 234 218 227 64 95 16 221 124 2 4 42 209 138 212 11 35 149 12 240 152 187 36 87 60 156 4 138 76 214 193 233 17 174 49 119 133 96 215 49 137 139 45 36 162 230 79 83 100 87 83 13 159 146 143 170 144 34 248 76 97 244 226 63 124 122 121 35 177 81 219 119 21 42 42 40 92 37 220 93 118 245 215 76 129 128 251 187 202 225 112 82 171 55 8 158 70 93 209 70 31 31 251 22 170 11 215 35 190 122 0 48 146 182 84 180 106 192 119 0 227 114 134 98 247 100 13 30 56 20 232 87 56 120 132 197 194 244 138 6 31 224 220 50 114 202 129 226 170 8 168 37 184 206 16 11 55 229 59 26 38 6 74 4 191 232 77 70 242 232 80 3 144 192 248 102 68 155 22 34 97 12 221 63 106 55 248 185 169 207 239 178 95 71 220 127 87 74 14 241 233 45 248 208 51 92 103 59 39 218 52 53 177 164 7 135 195 99 49 135 89 18 132 8 185 51 41 0 0 210 46 166 22 59 21 223 44 65 60 83 41 211 102 10 123 89 57 98 87 183 212 197 96 149 236 104 175 109 207 180 77 52 123 170 159 77 29 255 146 246 94 95 71 63 156 183 227 45 82 160 148 152 87 53 42 161 58]

Some of the fields in the private key blob follow: 

WK ID is [3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40]
See 6.7.1 of page 182 of  http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

Blob version is [18 52]
See 3.1.1 on page 141 of http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

IV is [153 221 86 12 9 88 111 233 79 50 0 98 38 116]

Encrypted part is [119 42 179 162 115 61 69 173 2 50 40 5 241 34 125 95 215 44 94 60 200 193 50 47 70 234 63 92 12 149 107 163 199 247 244 21 145 94 176 100 72 240 241 146 134 62 70 238 188 1 31 91 136 108 73 110 218 192 207 194 239 183 109 245 140 135 33 148 169 75 112 120 9 173 218 117 181 74 141 98 52 108 110 115 135 113 187 153 210 17 27 101 149 108 233 171 190 217 178 69 154 188 13 79 167 107 197 222 34 246 90 23 80 87 71 32 39 100 100 38 41 239 210 168 65 58 118 220 16 7 32 148 54 163 80 1 199 139 165 132 161 234 172 7 87 11 31 106 203 50 250 123 9 145 5 40 155 103 123 16 113 60 61 210 215 238 164 150 191 97 200 231 170 17 180 184 90 104 114 10 114 61 129 222 6 139 56 248 177 110 10 53 234 143 90 10 149 134 174 170 32 237 224 29 124 102 218 206 171 105 10 18 16 233 191 119 26 12 167 215 135 23 95 83 89 171 154 14 249 247 35 202 88 83 220 5 191 52 71 15 64 20 21 62 55 241 158 98 38 95 137 193 201 253 122 71 25 10 128 22 53 60 199 175 192 194 104 68 187 83 136 228 246 102 194 153 119 139 178 33 170 80 237 242 75 179 107 184 194 221 45 216 161 217 150 100 224 22 7 94 142 242 114 3 52 237 105 123 39 61 185 226 37 38 159 64 208 219 25 170 246 223 126 122 120 135 86 193 101 6 105 148 156 12 77 162 221 200 34 202 29 228 198 5 193 112 96 95 16 225 1 6 41 252 234 218 227 64 95 16 221 124 2 4 42 209 138 212 11 35 149 12 240 152 187 36 87 60 156 4 138 76 214 193 233 17 174 49 119 133 96 215 49 137 139 45 36 162 230 79 83 100 87 83 13 159 146 143 170 144 34 248 76 97 244 226 63 124 122 121 35 177 81 219 119 21 42 42 40 92 37 220 93 118 245 215 76 129 128 251 187 202 225 112 82 171 55 8 158 70 93 209 70 31 31 251 22 170 11 215 35 190 122 0 48 146 182 84 180 106 192 119 0 227 114 134 98 247 100 13 30 56 20 232 87 56 120 132 197 194 244 138 6 31 224 220 50 114 202 129 226 170 8 168 37 184 206 16 11 55 229 59 26 38 6 74 4 191 232 77 70 242 232 80 3 144 192 248 102 68 155 22 34 97 12 221 63 106 55 248 185 169 207 239 178 95 71 220 127 87 74 14 241 233 45 248 208 51 92 103 59 39 218 52 53 177 164 7 135 195 99 49 135 89 18 132 8 185 51 41 0 0 210 46 166 22 59 21 223 44 65 60 83 41 211 102 10 123 89 57 98 87 183 212 197 96 149 236]

MAC is [104 175 109 207 180 77 52 123 170 159 77 29 255 146 246 94 95 71 63 156 183 227 45 82 160 148 152 87 53 42 161 58]
MAC is 32 bytes, see field 15 in 3.1 on page 140 of http://public.dhe.ibm.com/security/cryptocards/pciecc4/EP11/docs/ep11-structure.pdf

-----BEGIN HSM ENCRYPTED PRIVATE KEY-----
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADsIIxQY2Y9lWElrfi1CQo
AAAAAAAAASYAAAAAAAAAARI0md1WDAlYb+lPMgBiJnR3KrOicz1FrQIyKAXxIn1f
1yxePMjBMi9G6j9cDJVro8f39BWRXrBkSPDxkoY+Ru68AR9biGxJbtrAz8Lvt231
jIchlKlLcHgJrdp1tUqNYjRsbnOHcbuZ0hEbZZVs6au+2bJFmrwNT6drxd4i9loX
UFdHICdkZCYp79KoQTp23BAHIJQ2o1ABx4ulhKHqrAdXCx9qyzL6ewmRBSibZ3sQ
cTw90tfupJa/YcjnqhG0uFpocgpyPYHeBos4+LFuCjXqj1oKlYauqiDt4B18ZtrO
q2kKEhDpv3caDKfXhxdfU1mrmg759yPKWFPcBb80Rw9AFBU+N/GeYiZficHJ/XpH
GQqAFjU8x6/AwmhEu1OI5PZmwpl3i7IhqlDt8kuza7jC3S3YodmWZOAWB16O8nID
NO1peyc9ueIlJp9A0NsZqvbffnp4h1bBZQZplJwMTaLdyCLKHeTGBcFwYF8Q4QEG
Kfzq2uNAXxDdfAIEKtGK1AsjlQzwmLskVzycBIpM1sHpEa4xd4Vg1zGJiy0kouZP
U2RXUw2fko+qkCL4TGH04j98enkjsVHbdxUqKihcJdxddvXXTIGA+7vK4XBSqzcI
nkZd0UYfH/sWqgvXI756ADCStlS0asB3AONyhmL3ZA0eOBToVzh4hMXC9IoGH+Dc
MnLKgeKqCKgluM4QCzflOxomBkoEv+hNRvLoUAOQwPhmRJsWImEM3T9qN/i5qc/v
sl9H3H9XSg7x6S340DNcZzsn2jQ1saQHh8NjMYdZEoQIuTMpAADSLqYWOxXfLEE8
UynTZgp7WTliV7fUxWCV7Givbc+0TTR7qp9NHf+S9l5fRz+ct+MtUqCUmFc1KqE6
-----END HSM ENCRYPTED PRIVATE KEY-----

-----BEGIN PUBLIC KEY-----
MHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEFOxqr0zRjjaIdwxgRM/tD89dhWXgvr/P
/AgNbymSw271ZvYVfsaYzI6Oe1XNSUdfx5xvfTyJGGcl09feWXe18gA/pDEOByjH
Vm+oiAj5pHX9SCGQQg9+g+YqICXSThtjBBADsIIxQY2Y9lWElrfi1CQoBCAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQIH5LDOy8A3cQECAAAAAAAAAAB
BBQQAQAAAAGAgAABgICAAQAKAAAAAQQgpoZCEWYIjHYfQATy6oYiSIR09Qrgrkpl
86zfuJwzHGc=
-----END PUBLIC KEY-----

Data signed
Signature verified
</code></pre></div>
</details>
</li>
<li>
<p>Each of the curves had a number in its name that indicates how large the key is, in bits.  We worked with 224-, 256-, 384-, and 521-bit keys  (yes that is 521 bits and not 512 bits but don't ask me why-  I first have to get smart enough to understand it myself before I get smart enough to explain it to you coherently- besides, I'm sure Google has the answer).  I am smart enough to know that there are 8 bits in a byte and while the key lengths in cryptographic algorithms are usually expressed in bits,  the lengths in our exercise output for the various blobs are expressed in bytes.  And there's nothing wrong with that, because our key blobs have lots of other metadata and attributes and fields besides just the key itself.  That's why I purposely referred to them as key blobs and not keys.</p>
<p>Try this handy "one-line script" that runs this exercise four times, once for each curve, and then pipes the output to <em>egrep</em> so that we can pick out some lines of interest.  You can see how the curve strength impacts the size of the public and private key blobs:</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="k">for</span><span class="w"> </span>curve<span class="w"> </span><span class="k">in</span><span class="w"> </span>P224<span class="w"> </span>P256<span class="w"> </span>P384<span class="w"> </span>P521<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w">  </span>./lab<span class="w"> </span>--ex3<span class="w"> </span>--curve<span class="w"> </span><span class="si">${</span><span class="nv">curve</span><span class="si">}</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">done</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-ie<span class="w"> </span><span class="s1">&#39;curve|key blob length&#39;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Expected Output</summary>
<div class="highlight"><pre><span></span><code>selected curve P224 with ObjectID of 1.3.132.0.33
Curve ObjectID in ASN.1 BER encoding is [6 5 43 129 4 0 33]
key pair public key blob length is 208 bytes
key pair private key blob length is 544 bytes
selected curve P256 with ObjectID of 1.2.840.10045.3.1.7
Curve ObjectID in ASN.1 BER encoding is [6 8 42 134 72 206 61 3 1 7]
key pair public key blob length is 219 bytes
key pair private key blob length is 576 bytes
selected curve P384 with ObjectID of 1.3.132.0.34
Curve ObjectID in ASN.1 BER encoding is [6 5 43 129 4 0 34]
key pair public key blob length is 248 bytes
key pair private key blob length is 720 bytes
selected curve P521 with ObjectID of 1.3.132.0.35
Curve ObjectID in ASN.1 BER encoding is [6 5 43 129 4 0 35]
key pair public key blob length is 286 bytes
key pair private key blob length is 896 bytes
</code></pre></div>
</details>
<p>It makes sense that the larger key sizes produce bigger key blobs.  If I ever figure out enough to give a full accounting of the difference in blob sizes, I'll update the lab.  If you ever figure it out, please create a GitHub pull request with the answer.</p>
</li>
</ol>
<p>Let's move on to our fourth and final exercise.</p></section><section class="print-page" id="grep11-lab-lab-exercise4"><h1 id="grep11-lab-lab-exercise4-exercise-4-wrap-and-unwrap-a-key">Exercise 4 - Wrap and Unwrap a Key<a class="headerlink" href="#grep11-lab-lab-exercise4-exercise-4-wrap-and-unwrap-a-key" title="Permanent link">&para;</a></h1>
<h2 id="grep11-lab-lab-exercise4-overview-of-exercise-4">Overview of Exercise 4<a class="headerlink" href="#grep11-lab-lab-exercise4-overview-of-exercise-4" title="Permanent link">&para;</a></h2>
<p>Data that is not encrypted is referred to as plaintext.  Data that is encrypted is referred to as ciphertext.</p>
<p>Whether this data is human readable text, like this sentence, or binary data (like a lot of the output in our exercises!), or whatever, is usually of little concern to encryption and decryption algorithms.  The input is just a bunch of bits- either <em>1</em> or <em>0</em>. </p>
<p>Keys themselves are just a bunch of bits- <em>1</em>'s and <em>0</em>'s.  Can you encrypt and decrypt keys with other keys?  You sure can. There's nothing magical about that. But, like all disciplines, cryptographers have special terms for encrypting and decrypting keys- they use the term <em>wrapping</em> a key to refer to encrypting a key, and <em>unwrapping</em> a key refers to decrypting a key. There are valid reasons to make the distinction- for example, the PKCS #11 standard allows you to assign attributes to keys, and you can create keys such that they can or cannot wrap or unwrap keys, and you may wish to create different keys for different purposes. In fact, it is considered best practice to not use the same key to encrypt both data and keys, so using different terminology- <em>encrypting data</em> versus <em>wrapping keys</em> allows for easier separation of duties and may make key management easier.</p>
<p>In this exercise, the following use case will be demonstrated- securely transmitting a secret key so that both parties have the same secret key and can use it for encryption during a session:</p>
<ol>
<li>Sender wishes to send a secret (i.e., symmetric) key to a recipient.  </li>
<li>Sender generates a secret key and wraps it with the recipient's public key</li>
<li>Sender sends the wrapped key to the recipient-  this is safe since it is wrapped with the recipient's public key</li>
<li>Recipient receives the wrapped key, and unwraps it with her private key</li>
</ol>
<h2 id="grep11-lab-lab-exercise4-run-exercise-4">Run Exercise 4<a class="headerlink" href="#grep11-lab-lab-exercise4-run-exercise-4" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Run the fourth exercise:</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex4
</code></pre></div>
<details class="example">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Generated AES key
Generated PKCS RSA key pair

the AES key prior to being wrapped is:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 0 0 0 0 0 0 141 37 0 0 0 0 0 0 0 1 18 52 228 123 210 48 148 72 67 55 62 73 210 121 66 247 116 178 245 24 106 221 115 156 71 47 218 46 103 246 124 74 119 150 39 244 103 45 22 196 216 35 98 215 63 143 111 10 217 35 1 34 26 127 84 98 120 216 45 88 92 129 231 135 244 57 118 125 8 141 119 168 29 141 122 29 224 59 1 244 174 182 103 220 131 195 114 27 143 94 112 118 185 49 140 147 51 10 26 16 150 95 130 1 239 21 212 148 246 182 10 159 243 69 233 30 202 254 52 241 146 79 66 44 9 199 32 56 113 169 227 133 51 177 98 204 240 57 244 188 254 99 38 243 227 153 119 170 28 38 109 86 197 175 193 64 255 113 106 40 94 90 204 5 241 135 72 79 76 42 166 180 59 93 91 62 94 248 153 138 201 11 2 155 224 41 66 230 89 253 94 74]

the checksum of the AES key is: [147 241 235]

the AES key has been wrapped with a PKCS RSA Public Key
The AES key has been unwrapped with the PKCS Private Key corresponding to the PKCS Public Key we used to wrap it with.

the AES key after being wrapped and unwrapped is:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 0 0 0 0 0 0 12 0 0 0 0 0 0 0 0 1 18 52 206 249 87 66 227 239 81 119 120 21 113 29 123 27 2 52 241 6 31 39 195 183 118 39 98 185 255 179 31 44 217 72 38 56 126 190 23 230 112 120 180 74 27 118 70 9 145 247 109 197 15 92 126 232 161 192 140 63 241 178 29 188 70 79 29 240 6 39 76 22 244 149 99 241 220 160 157 40 58 42 255 121 3 181 9 118 15 96 170 49 208 117 127 248 187 202 226 92 76 198 142 164 39 85 247 74 203 28 50 106 162 144 217 93 110 120 157 126 106 37 202 133 10 133 162 89 201 186 210 12 93 124 74 231 120 172 149 134 196 232 247 5 228 92 146 119 245 115 107 124 153 218 87 65 119 80 131 101 53 219 210 111 107 216 117 6 45 153 176 221 49 121 208 77 164 68 230 219 190 45 238 82 201 112 126 205 97 110 201 187 28 240 134 33 223 206 209 45 207 159 132 178 222 232 63 160]

the checksum of the unwrapped AES key is: [147 241 235 0 0 1 0]
</code></pre></div>
</details>
<p>I mentioned in the overview of this exercise that you can assign attributes to keys when you create them. The code for this exercise, by default, assigns an attribute that allows the public key it creates to wrap keys, and it assigns an attribute to the private key to allow it to unwrap keys. </p>
</li>
<li>
<p>Run this command which will cause the program to set the applicable attribute for the private key such that it is not allowed to unwrap a key. Observe in the output that, while the wrap operation proceeds, the unwrap fails:</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex4<span class="w"> </span>--unwrap<span class="o">=</span><span class="nb">false</span>
</code></pre></div>
<details class="example">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code>Generated AES key
Generated PKCS RSA key pair

the AES key prior to being wrapped is:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 0 0 0 0 0 0 141 37 0 0 0 0 0 0 0 1 18 52 120 27 243 16 225 139 153 149 120 188 137 72 50 120 131 243 65 98 62 77 65 60 178 184 93 56 192 2 202 179 211 210 240 252 246 171 56 100 172 203 61 233 216 102 186 60 207 208 1 173 188 223 4 45 199 93 159 251 80 32 171 131 10 228 235 131 98 191 70 58 116 218 179 225 62 235 136 76 246 39 55 21 247 126 181 47 3 130 64 70 198 91 136 21 133 177 138 190 118 139 183 195 32 110 107 230 101 253 127 40 171 124 1 146 32 138 11 148 175 180 54 21 123 51 144 234 167 228 218 128 47 74 26 203 250 95 110 208 47 245 229 198 164 121 76 226 138 122 31 168 169 251 74 149 174 62 88 86 122 204 149 195 200 41 139 250 0 242 226 34 193 78 32 151 250 220 249 249 106 106 231 217 34 139 118 29 206 140 217 75]

the checksum of the AES key is: [79 136 190]

the AES key has been wrapped with a PKCS RSA Public Key
panic: Unwrap AES key error: rpc error: code = Unknown desc = CKR_KEY_FUNCTION_NOT_PERMITTED

goroutine 1 [running]:
main.wrapAndUnwrapKey(0xc420030001)
        /home/hyper-protect-lab/go/src/github.com/ibm-developer/ibm-cloud-hyperprotectcrypto/golang/lab/exercise4.go:110 +0x1543
main.main()
        /home/hyper-protect-lab/go/src/github.com/ibm-developer/ibm-cloud-hyperprotectcrypto/golang/lab/main.go:79 +0x35e
</code></pre></div>
</details>
</li>
<li>
<p>This command will cause the public key to be created without the ability to wrap a key. The command will fail when trying to wrap the key:</p>
<div class="highlight"><pre><span></span><code>./lab<span class="w"> </span>--ex4<span class="w"> </span>--wrap<span class="o">=</span><span class="nb">false</span>
</code></pre></div>
<details class="example">
<summary>Example output</summary>
<div class="highlight"><pre><span></span><code>Generated AES key
Generated PKCS RSA key pair

the AES key prior to being wrapped is:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 176 130 49 65 141 152 246 85 132 150 183 226 212 36 40 0 0 0 0 0 0 141 37 0 0 0 0 0 0 0 1 18 52 94 240 28 56 111 164 179 172 71 8 202 169 163 165 249 244 192 122 26 215 148 231 8 62 1 127 152 148 45 31 45 189 172 0 97 131 35 17 231 104 88 103 196 2 96 167 213 198 9 62 10 241 154 128 94 206 4 229 36 89 125 38 231 94 155 212 43 90 44 253 221 170 164 83 13 228 232 156 205 205 183 65 252 45 183 191 75 243 56 130 64 170 140 197 150 91 224 229 88 47 185 97 138 145 93 241 181 206 4 141 225 214 249 62 21 4 83 105 12 209 109 187 124 171 112 222 107 44 203 204 240 23 236 60 27 190 248 201 189 3 112 89 163 28 91 254 220 95 74 11 247 137 54 107 93 106 21 199 166 152 208 200 151 220 233 4 125 105 139 235 83 211 121 166 15 209 229 173 92 2 74 50 107 41 73 150 197 116 162 37]

the checksum of the AES key is: [229 2 226]

panic: Wrap AES key error: rpc error: code = Unknown desc = CKR_KEY_FUNCTION_NOT_PERMITTED

goroutine 1 [running]:
main.wrapAndUnwrapKey(0xc420030100)
        /home/hyper-protect-lab/go/src/github.com/ibm-developer/ibm-cloud-hyperprotectcrypto/golang/lab/exercise4.go:90 +0x1553
main.main()
        /home/hyper-protect-lab/go/src/github.com/ibm-developer/ibm-cloud-hyperprotectcrypto/golang/lab/main.go:79 +0x35e
</code></pre></div>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The public key has been prevented from wrapping a key, but it could still be used to encrypt data.</p>
</div>
<p>Congratulations for reaching the end of the lab!</p>
<p>We hope you have gotten a taste of the functionality offered by the Crypto Express cards and made accessible to you via the GREP11 server feature of Hyper Protect Virtual Servers. And if you know a bit more about security after doing this lab than you did before, we're pleased about that!</p>
<p>We welome your suggestions for improvements or enhancements to the lab.</p>
<p>Please do not forget to take your survey for the Webinar and your survey about your Workshop Manager/SkyTap experience.
Here is the link for the Workshop Manager/SkyTap survey: <a href="https://www.surveygizmo.com/s3/5541805/Workshop-Manager-Survey?ws=https://ibm.biz/BdfBrR" target="_blank">Workshop Manager survey</a></p>
</li>
</ol></section><h1 class='nav-section-title-end'>Ended: Run the Lab exercises</h1><h1 class='nav-section-title-end'>Ended: GREP11 Lab</h1>
                        <h1 class='nav-section-title' id='section-secure-image-build-lab'>
                            Secure Image Build Lab <a class='headerlink' href='#section-secure-image-build-lab' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="prerequisites"><h1 id="prerequisites-prerequisites">Prerequisites<a class="headerlink" href="#prerequisites-prerequisites" title="Permanent link">&para;</a></h1>
<h2 id="prerequisites-create-a-github-account">Create a GitHub account<a class="headerlink" href="#prerequisites-create-a-github-account" title="Permanent link">&para;</a></h2>
<p>You will need to have a GitHub account in order to complete this lab. If you do not already have one, you can create a free account <a href="https://github.com/join?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F&amp;source=header-home" target="_blank">here</a>.</p>
<h2 id="prerequisites-create-a-docker-account">Create a Docker account<a class="headerlink" href="#prerequisites-create-a-docker-account" title="Permanent link">&para;</a></h2>
<p>Create a Docker account (if you don't already have one) following the instructions <a href="https://docs.docker.com/docker-id/" target="_blank">here</a>.</p>
<h2 id="prerequisites-create-a-docker-access-token">Create a Docker access token<a class="headerlink" href="#prerequisites-create-a-docker-access-token" title="Permanent link">&para;</a></h2>
<p>Create an access token for Docker Hub access during the lab (you will delete it after finishing the lab) following the instructions <a href="https://docs.docker.com/docker-hub/access-tokens/#create-an-access-token" target="_blank">here</a>. If you already have a Docker account and already have a Docker access token, we recommend that you create a new access token just for this lab instead of using any existing ones.</p></section><section class="print-page" id="securebuild-lab-overview"><h1 id="securebuild-lab-overview-hyper-protect-virtual-servers-hpvs-lab-process-overview">Hyper Protect Virtual Servers (HPVS) Lab Process Overview<a class="headerlink" href="#securebuild-lab-overview-hyper-protect-virtual-servers-hpvs-lab-process-overview" title="Permanent link">&para;</a></h1>
<h2 id="securebuild-lab-overview-prerequisites">Prerequisites<a class="headerlink" href="#securebuild-lab-overview-prerequisites" title="Permanent link">&para;</a></h2>
<p>See the <a href="#prerequisites" target="_blank"><code>Prerequisites</code> page</a> to complete the prerequisites for this lab. This includes creating accounts and credentials to access the Source Code Management (SCM) <a href="https://github.com" target="_blank">GitHub</a> and the Docker Image Management (Docker Registry) <a href="https://hub.docker.com/" target="_blank">Docker Hub</a> for the lab.</p>
<h2 id="securebuild-lab-overview-the-big-picture">The Big Picture<a class="headerlink" href="#securebuild-lab-overview-the-big-picture" title="Permanent link">&para;</a></h2>
<p>Here is a big picture of what is going on in the lab (i.e. lab architecture).</p>
<p><img alt="Secure Build Big Picture" src="../securebuild-lab/Overview_Images/SecureBuild_BigPicture.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Student 1 and Student 2 in the illustration are 2 example students. In the actual lab, more students will be present.</p>
</div>
<p>The 5 different pieces of this puzzle:</p>
<ol>
<li><a href="#securebuild-lab-overview-setup">SETUP</a></li>
<li><a href="#securebuild-lab-overview-build">BUILD</a></li>
<li><a href="#securebuild-lab-overview-register">REGISTER</a></li>
<li><a href="#securebuild-lab-overview-deploy">DEPLOY</a></li>
<li><a href="#securebuild-lab-overview-access">ACCESS</a></li>
</ol>
<p>(and how to <a href="#securebuild-lab-overview-cleanup">CLEAN UP</a>) are explained in more detail in their respective sections below.</p>
<h3 id="securebuild-lab-overview-setup">SETUP<a class="headerlink" href="#securebuild-lab-overview-setup" title="Permanent link">&para;</a></h3>
<p>Configure your environment with the necessary credentials to connect to <a href="https://github.com" target="_blank">GitHub</a> and <a href="https://hub.docker.com/" target="_blank">Docker Hub</a> respectively (<a href="#securebuild-lab-securebuild-setup" target="_blank">see <code>Configuring your Environment</code></a>).</p>
<h3 id="securebuild-lab-overview-build">BUILD<a class="headerlink" href="#securebuild-lab-overview-build" title="Permanent link">&para;</a></h3>
<p>Securely build a Docker Image for the <a href="https://github.com/IBM/secure-bitcoin-wallet" target="_blank">Secure Electrum Bitcoin Wallet Application</a>. (<a href="#securebuild-lab-create-server" target="_blank">see <code>Create your HPVS Secure Build Server</code></a> and <a href="#securebuild-lab-build" target="_blank"><code>Securely Build your Application</code></a>). This uses the Secure Build Process detailed below<sup id="fnref:1"><a class="footnote-ref" href="#securebuild-lab-overview-fn:1">1</a></sup>:</p>
<p><img alt="Secure Build Overview" src="../securebuild-lab/Overview_Images/Secure_Build_Overview.png" /></p>
<div class="admonition tip">
<p class="admonition-title">Securely Seeding Docker Content Trust</p>
<p>This Secure Build Process leverages a <strong>Hyper Protect Virtual Server</strong>, called the Secure Build Server, to establish trust and security in the <a href="https://docs.docker.com/engine/security/trust/content_trust/" target="_blank">Docker Content Trust</a> process. This ensures images verified using the <a href="https://docs.docker.com/notary/service_architecture/" target="_blank">Notary service architecture</a> were safely built and signed. This is done by generating the repository and root keys used to establish trust with the <a href="https://docs.docker.com/notary/service_architecture/" target="_blank">Notary Service</a> inside of the Secure Build Server to guarantee that the initial keys used for a repository are trusted on first use (solving the <a href="https://en.wikipedia.org/wiki/Trust_on_first_use" target="_blank">TOFU</a> problem).</p>
<p>However, those aren't the  only keys used throughout the lab. The table below illustrates all of the different keys used throughout the secure build process, what they do, how they are created, and who is ultimately responsible for them.</p>
</div>
<details class="example" open="open">
<summary>List of the keys employed during the Secure Build Lab in order of creation. <sup id="fnref:2"><a class="footnote-ref" href="#securebuild-lab-overview-fn:2">2</a></sup></summary>
<table>
<thead>
<tr>
<th>Key Name</th>
<th>Key Type</th>
<th>Key Function</th>
<th align="center">Private Key Location</th>
<th>How Created</th>
<th>Owner</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>HPVS Registry CLI Encryption Key</code></td>
<td><a href="https://en.bitcoinwiki.org/wiki/Advanced_Encryption_Standard_(AES)" target="_blank">AES</a> 256 bit key</td>
<td>Encrypts the Docker token you provide as part of the <code>hpvs registry add</code> command in <a href="#securebuild-lab-securebuild-setup-add-docker-registry-to-use-for-secure-build" target="_blank">this section of the lab</a></td>
<td align="center"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M220.8 123.3c1 .5 1.8 1.7 3 1.7 1.1 0 2.8-.4 2.9-1.5.2-1.4-1.9-2.3-3.2-2.9-1.7-.7-3.9-1-5.5-.1-.4.2-.8.7-.6 1.1.3 1.3 2.3 1.1 3.4 1.7zm-21.9 1.7c1.2 0 2-1.2 3-1.7 1.1-.6 3.1-.4 3.5-1.6.2-.4-.2-.9-.6-1.1-1.6-.9-3.8-.6-5.5.1-1.3.6-3.4 1.5-3.2 2.9.1 1 1.8 1.5 2.8 1.4zM420 403.8c-3.6-4-5.3-11.6-7.2-19.7-1.8-8.1-3.9-16.8-10.5-22.4-1.3-1.1-2.6-2.1-4-2.9-1.3-.8-2.7-1.5-4.1-2 9.2-27.3 5.6-54.5-3.7-79.1-11.4-30.1-31.3-56.4-46.5-74.4-17.1-21.5-33.7-41.9-33.4-72C311.1 85.4 315.7.1 234.8 0 132.4-.2 158 103.4 156.9 135.2c-1.7 23.4-6.4 41.8-22.5 64.7-18.9 22.5-45.5 58.8-58.1 96.7-6 17.9-8.8 36.1-6.2 53.3-6.5 5.8-11.4 14.7-16.6 20.2-4.2 4.3-10.3 5.9-17 8.3s-14 6-18.5 14.5c-2.1 3.9-2.8 8.1-2.8 12.4 0 3.9.6 7.9 1.2 11.8 1.2 8.1 2.5 15.7.8 20.8-5.2 14.4-5.9 24.4-2.2 31.7 3.8 7.3 11.4 10.5 20.1 12.3 17.3 3.6 40.8 2.7 59.3 12.5 19.8 10.4 39.9 14.1 55.9 10.4 11.6-2.6 21.1-9.6 25.9-20.2 12.5-.1 26.3-5.4 48.3-6.6 14.9-1.2 33.6 5.3 55.1 4.1.6 2.3 1.4 4.6 2.5 6.7v.1c8.3 16.7 23.8 24.3 40.3 23 16.6-1.3 34.1-11 48.3-27.9 13.6-16.4 36-23.2 50.9-32.2 7.4-4.5 13.4-10.1 13.9-18.3.4-8.2-4.4-17.3-15.5-29.7zM223.7 87.3c9.8-22.2 34.2-21.8 44-.4 6.5 14.2 3.6 30.9-4.3 40.4-1.6-.8-5.9-2.6-12.6-4.9 1.1-1.2 3.1-2.7 3.9-4.6 4.8-11.8-.2-27-9.1-27.3-7.3-.5-13.9 10.8-11.8 23-4.1-2-9.4-3.5-13-4.4-1-6.9-.3-14.6 2.9-21.8zM183 75.8c10.1 0 20.8 14.2 19.1 33.5-3.5 1-7.1 2.5-10.2 4.6 1.2-8.9-3.3-20.1-9.6-19.6-8.4.7-9.8 21.2-1.8 28.1 1 .8 1.9-.2-5.9 5.5-15.6-14.6-10.5-52.1 8.4-52.1zm-13.6 60.7c6.2-4.6 13.6-10 14.1-10.5 4.7-4.4 13.5-14.2 27.9-14.2 7.1 0 15.6 2.3 25.9 8.9 6.3 4.1 11.3 4.4 22.6 9.3 8.4 3.5 13.7 9.7 10.5 18.2-2.6 7.1-11 14.4-22.7 18.1-11.1 3.6-19.8 16-38.2 14.9-3.9-.2-7-1-9.6-2.1-8-3.5-12.2-10.4-20-15-8.6-4.8-13.2-10.4-14.7-15.3-1.4-4.9 0-9 4.2-12.3zm3.3 334c-2.7 35.1-43.9 34.4-75.3 18-29.9-15.8-68.6-6.5-76.5-21.9-2.4-4.7-2.4-12.7 2.6-26.4v-.2c2.4-7.6.6-16-.6-23.9-1.2-7.8-1.8-15 .9-20 3.5-6.7 8.5-9.1 14.8-11.3 10.3-3.7 11.8-3.4 19.6-9.9 5.5-5.7 9.5-12.9 14.3-18 5.1-5.5 10-8.1 17.7-6.9 8.1 1.2 15.1 6.8 21.9 16l19.6 35.6c9.5 19.9 43.1 48.4 41 68.9zm-1.4-25.9c-4.1-6.6-9.6-13.6-14.4-19.6 7.1 0 14.2-2.2 16.7-8.9 2.3-6.2 0-14.9-7.4-24.9-13.5-18.2-38.3-32.5-38.3-32.5-13.5-8.4-21.1-18.7-24.6-29.9s-3-23.3-.3-35.2c5.2-22.9 18.6-45.2 27.2-59.2 2.3-1.7.8 3.2-8.7 20.8-8.5 16.1-24.4 53.3-2.6 82.4.6-20.7 5.5-41.8 13.8-61.5 12-27.4 37.3-74.9 39.3-112.7 1.1.8 4.6 3.2 6.2 4.1 4.6 2.7 8.1 6.7 12.6 10.3 12.4 10 28.5 9.2 42.4 1.2 6.2-3.5 11.2-7.5 15.9-9 9.9-3.1 17.8-8.6 22.3-15 7.7 30.4 25.7 74.3 37.2 95.7 6.1 11.4 18.3 35.5 23.6 64.6 3.3-.1 7 .4 10.9 1.4 13.8-35.7-11.7-74.2-23.3-84.9-4.7-4.6-4.9-6.6-2.6-6.5 12.6 11.2 29.2 33.7 35.2 59 2.8 11.6 3.3 23.7.4 35.7 16.4 6.8 35.9 17.9 30.7 34.8-2.2-.1-3.2 0-4.2 0 3.2-10.1-3.9-17.6-22.8-26.1-19.6-8.6-36-8.6-38.3 12.5-12.1 4.2-18.3 14.7-21.4 27.3-2.8 11.2-3.6 24.7-4.4 39.9-.5 7.7-3.6 18-6.8 29-32.1 22.9-76.7 32.9-114.3 7.2zm257.4-11.5c-.9 16.8-41.2 19.9-63.2 46.5-13.2 15.7-29.4 24.4-43.6 25.5s-26.5-4.8-33.7-19.3c-4.7-11.1-2.4-23.1 1.1-36.3 3.7-14.2 9.2-28.8 9.9-40.6.8-15.2 1.7-28.5 4.2-38.7 2.6-10.3 6.6-17.2 13.7-21.1.3-.2.7-.3 1-.5.8 13.2 7.3 26.6 18.8 29.5 12.6 3.3 30.7-7.5 38.4-16.3 9-.3 15.7-.9 22.6 5.1 9.9 8.5 7.1 30.3 17.1 41.6 10.6 11.6 14 19.5 13.7 24.6zM173.3 148.7c2 1.9 4.7 4.5 8 7.1 6.6 5.2 15.8 10.6 27.3 10.6 11.6 0 22.5-5.9 31.8-10.8 4.9-2.6 10.9-7 14.8-10.4s5.9-6.3 3.1-6.6-2.6 2.6-6 5.1c-4.4 3.2-9.7 7.4-13.9 9.8-7.4 4.2-19.5 10.2-29.9 10.2s-18.7-4.8-24.9-9.7c-3.1-2.5-5.7-5-7.7-6.9-1.5-1.4-1.9-4.6-4.3-4.9-1.4-.1-1.8 3.7 1.7 6.5z"/></svg></span> <br> Client Linux VM (i.e. Skytap for the lab)</td>
<td>This symmetric key is hardcoded in the HPVS CLI binary file downloaded on the Skytap instance prior to the lab</td>
<td>IBM HPVS Developers</td>
</tr>
<tr>
<td><code>GitHub</code> <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"/></svg></span> <code>SSH Key</code></td>
<td><a href="https://www.drdobbs.com/rsa-digital-signatures/184404605" target="_blank">RSA</a> 4096 bit key pair</td>
<td>Provides SSH access to GitHub account to clone repositories via SSH</td>
<td align="center"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M220.8 123.3c1 .5 1.8 1.7 3 1.7 1.1 0 2.8-.4 2.9-1.5.2-1.4-1.9-2.3-3.2-2.9-1.7-.7-3.9-1-5.5-.1-.4.2-.8.7-.6 1.1.3 1.3 2.3 1.1 3.4 1.7zm-21.9 1.7c1.2 0 2-1.2 3-1.7 1.1-.6 3.1-.4 3.5-1.6.2-.4-.2-.9-.6-1.1-1.6-.9-3.8-.6-5.5.1-1.3.6-3.4 1.5-3.2 2.9.1 1 1.8 1.5 2.8 1.4zM420 403.8c-3.6-4-5.3-11.6-7.2-19.7-1.8-8.1-3.9-16.8-10.5-22.4-1.3-1.1-2.6-2.1-4-2.9-1.3-.8-2.7-1.5-4.1-2 9.2-27.3 5.6-54.5-3.7-79.1-11.4-30.1-31.3-56.4-46.5-74.4-17.1-21.5-33.7-41.9-33.4-72C311.1 85.4 315.7.1 234.8 0 132.4-.2 158 103.4 156.9 135.2c-1.7 23.4-6.4 41.8-22.5 64.7-18.9 22.5-45.5 58.8-58.1 96.7-6 17.9-8.8 36.1-6.2 53.3-6.5 5.8-11.4 14.7-16.6 20.2-4.2 4.3-10.3 5.9-17 8.3s-14 6-18.5 14.5c-2.1 3.9-2.8 8.1-2.8 12.4 0 3.9.6 7.9 1.2 11.8 1.2 8.1 2.5 15.7.8 20.8-5.2 14.4-5.9 24.4-2.2 31.7 3.8 7.3 11.4 10.5 20.1 12.3 17.3 3.6 40.8 2.7 59.3 12.5 19.8 10.4 39.9 14.1 55.9 10.4 11.6-2.6 21.1-9.6 25.9-20.2 12.5-.1 26.3-5.4 48.3-6.6 14.9-1.2 33.6 5.3 55.1 4.1.6 2.3 1.4 4.6 2.5 6.7v.1c8.3 16.7 23.8 24.3 40.3 23 16.6-1.3 34.1-11 48.3-27.9 13.6-16.4 36-23.2 50.9-32.2 7.4-4.5 13.4-10.1 13.9-18.3.4-8.2-4.4-17.3-15.5-29.7zM223.7 87.3c9.8-22.2 34.2-21.8 44-.4 6.5 14.2 3.6 30.9-4.3 40.4-1.6-.8-5.9-2.6-12.6-4.9 1.1-1.2 3.1-2.7 3.9-4.6 4.8-11.8-.2-27-9.1-27.3-7.3-.5-13.9 10.8-11.8 23-4.1-2-9.4-3.5-13-4.4-1-6.9-.3-14.6 2.9-21.8zM183 75.8c10.1 0 20.8 14.2 19.1 33.5-3.5 1-7.1 2.5-10.2 4.6 1.2-8.9-3.3-20.1-9.6-19.6-8.4.7-9.8 21.2-1.8 28.1 1 .8 1.9-.2-5.9 5.5-15.6-14.6-10.5-52.1 8.4-52.1zm-13.6 60.7c6.2-4.6 13.6-10 14.1-10.5 4.7-4.4 13.5-14.2 27.9-14.2 7.1 0 15.6 2.3 25.9 8.9 6.3 4.1 11.3 4.4 22.6 9.3 8.4 3.5 13.7 9.7 10.5 18.2-2.6 7.1-11 14.4-22.7 18.1-11.1 3.6-19.8 16-38.2 14.9-3.9-.2-7-1-9.6-2.1-8-3.5-12.2-10.4-20-15-8.6-4.8-13.2-10.4-14.7-15.3-1.4-4.9 0-9 4.2-12.3zm3.3 334c-2.7 35.1-43.9 34.4-75.3 18-29.9-15.8-68.6-6.5-76.5-21.9-2.4-4.7-2.4-12.7 2.6-26.4v-.2c2.4-7.6.6-16-.6-23.9-1.2-7.8-1.8-15 .9-20 3.5-6.7 8.5-9.1 14.8-11.3 10.3-3.7 11.8-3.4 19.6-9.9 5.5-5.7 9.5-12.9 14.3-18 5.1-5.5 10-8.1 17.7-6.9 8.1 1.2 15.1 6.8 21.9 16l19.6 35.6c9.5 19.9 43.1 48.4 41 68.9zm-1.4-25.9c-4.1-6.6-9.6-13.6-14.4-19.6 7.1 0 14.2-2.2 16.7-8.9 2.3-6.2 0-14.9-7.4-24.9-13.5-18.2-38.3-32.5-38.3-32.5-13.5-8.4-21.1-18.7-24.6-29.9s-3-23.3-.3-35.2c5.2-22.9 18.6-45.2 27.2-59.2 2.3-1.7.8 3.2-8.7 20.8-8.5 16.1-24.4 53.3-2.6 82.4.6-20.7 5.5-41.8 13.8-61.5 12-27.4 37.3-74.9 39.3-112.7 1.1.8 4.6 3.2 6.2 4.1 4.6 2.7 8.1 6.7 12.6 10.3 12.4 10 28.5 9.2 42.4 1.2 6.2-3.5 11.2-7.5 15.9-9 9.9-3.1 17.8-8.6 22.3-15 7.7 30.4 25.7 74.3 37.2 95.7 6.1 11.4 18.3 35.5 23.6 64.6 3.3-.1 7 .4 10.9 1.4 13.8-35.7-11.7-74.2-23.3-84.9-4.7-4.6-4.9-6.6-2.6-6.5 12.6 11.2 29.2 33.7 35.2 59 2.8 11.6 3.3 23.7.4 35.7 16.4 6.8 35.9 17.9 30.7 34.8-2.2-.1-3.2 0-4.2 0 3.2-10.1-3.9-17.6-22.8-26.1-19.6-8.6-36-8.6-38.3 12.5-12.1 4.2-18.3 14.7-21.4 27.3-2.8 11.2-3.6 24.7-4.4 39.9-.5 7.7-3.6 18-6.8 29-32.1 22.9-76.7 32.9-114.3 7.2zm257.4-11.5c-.9 16.8-41.2 19.9-63.2 46.5-13.2 15.7-29.4 24.4-43.6 25.5s-26.5-4.8-33.7-19.3c-4.7-11.1-2.4-23.1 1.1-36.3 3.7-14.2 9.2-28.8 9.9-40.6.8-15.2 1.7-28.5 4.2-38.7 2.6-10.3 6.6-17.2 13.7-21.1.3-.2.7-.3 1-.5.8 13.2 7.3 26.6 18.8 29.5 12.6 3.3 30.7-7.5 38.4-16.3 9-.3 15.7-.9 22.6 5.1 9.9 8.5 7.1 30.3 17.1 41.6 10.6 11.6 14 19.5 13.7 24.6zM173.3 148.7c2 1.9 4.7 4.5 8 7.1 6.6 5.2 15.8 10.6 27.3 10.6 11.6 0 22.5-5.9 31.8-10.8 4.9-2.6 10.9-7 14.8-10.4s5.9-6.3 3.1-6.6-2.6 2.6-6 5.1c-4.4 3.2-9.7 7.4-13.9 9.8-7.4 4.2-19.5 10.2-29.9 10.2s-18.7-4.8-24.9-9.7c-3.1-2.5-5.7-5-7.7-6.9-1.5-1.4-1.9-4.6-4.3-4.9-1.4-.1-1.8 3.7 1.7 6.5z"/></svg></span> <br> Client Linux VM (i.e. Skytap for the lab) as well as the secure build server</td>
<td>In <a href="#securebuild-lab-securebuild-setup-create-ssh-key-and-grant-github-access" target="_blank">this section</a> of the <code>SETUP</code> process</td>
<td>ISV or application developer</td>
</tr>
<tr>
<td><code>Secure Build Server Client Certificate and Key</code></td>
<td><a href="https://www.drdobbs.com/rsa-digital-signatures/184404605" target="_blank">RSA</a> key pair</td>
<td>securely communicate with the secure build server over the Secure Build REST API</td>
<td align="center"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M220.8 123.3c1 .5 1.8 1.7 3 1.7 1.1 0 2.8-.4 2.9-1.5.2-1.4-1.9-2.3-3.2-2.9-1.7-.7-3.9-1-5.5-.1-.4.2-.8.7-.6 1.1.3 1.3 2.3 1.1 3.4 1.7zm-21.9 1.7c1.2 0 2-1.2 3-1.7 1.1-.6 3.1-.4 3.5-1.6.2-.4-.2-.9-.6-1.1-1.6-.9-3.8-.6-5.5.1-1.3.6-3.4 1.5-3.2 2.9.1 1 1.8 1.5 2.8 1.4zM420 403.8c-3.6-4-5.3-11.6-7.2-19.7-1.8-8.1-3.9-16.8-10.5-22.4-1.3-1.1-2.6-2.1-4-2.9-1.3-.8-2.7-1.5-4.1-2 9.2-27.3 5.6-54.5-3.7-79.1-11.4-30.1-31.3-56.4-46.5-74.4-17.1-21.5-33.7-41.9-33.4-72C311.1 85.4 315.7.1 234.8 0 132.4-.2 158 103.4 156.9 135.2c-1.7 23.4-6.4 41.8-22.5 64.7-18.9 22.5-45.5 58.8-58.1 96.7-6 17.9-8.8 36.1-6.2 53.3-6.5 5.8-11.4 14.7-16.6 20.2-4.2 4.3-10.3 5.9-17 8.3s-14 6-18.5 14.5c-2.1 3.9-2.8 8.1-2.8 12.4 0 3.9.6 7.9 1.2 11.8 1.2 8.1 2.5 15.7.8 20.8-5.2 14.4-5.9 24.4-2.2 31.7 3.8 7.3 11.4 10.5 20.1 12.3 17.3 3.6 40.8 2.7 59.3 12.5 19.8 10.4 39.9 14.1 55.9 10.4 11.6-2.6 21.1-9.6 25.9-20.2 12.5-.1 26.3-5.4 48.3-6.6 14.9-1.2 33.6 5.3 55.1 4.1.6 2.3 1.4 4.6 2.5 6.7v.1c8.3 16.7 23.8 24.3 40.3 23 16.6-1.3 34.1-11 48.3-27.9 13.6-16.4 36-23.2 50.9-32.2 7.4-4.5 13.4-10.1 13.9-18.3.4-8.2-4.4-17.3-15.5-29.7zM223.7 87.3c9.8-22.2 34.2-21.8 44-.4 6.5 14.2 3.6 30.9-4.3 40.4-1.6-.8-5.9-2.6-12.6-4.9 1.1-1.2 3.1-2.7 3.9-4.6 4.8-11.8-.2-27-9.1-27.3-7.3-.5-13.9 10.8-11.8 23-4.1-2-9.4-3.5-13-4.4-1-6.9-.3-14.6 2.9-21.8zM183 75.8c10.1 0 20.8 14.2 19.1 33.5-3.5 1-7.1 2.5-10.2 4.6 1.2-8.9-3.3-20.1-9.6-19.6-8.4.7-9.8 21.2-1.8 28.1 1 .8 1.9-.2-5.9 5.5-15.6-14.6-10.5-52.1 8.4-52.1zm-13.6 60.7c6.2-4.6 13.6-10 14.1-10.5 4.7-4.4 13.5-14.2 27.9-14.2 7.1 0 15.6 2.3 25.9 8.9 6.3 4.1 11.3 4.4 22.6 9.3 8.4 3.5 13.7 9.7 10.5 18.2-2.6 7.1-11 14.4-22.7 18.1-11.1 3.6-19.8 16-38.2 14.9-3.9-.2-7-1-9.6-2.1-8-3.5-12.2-10.4-20-15-8.6-4.8-13.2-10.4-14.7-15.3-1.4-4.9 0-9 4.2-12.3zm3.3 334c-2.7 35.1-43.9 34.4-75.3 18-29.9-15.8-68.6-6.5-76.5-21.9-2.4-4.7-2.4-12.7 2.6-26.4v-.2c2.4-7.6.6-16-.6-23.9-1.2-7.8-1.8-15 .9-20 3.5-6.7 8.5-9.1 14.8-11.3 10.3-3.7 11.8-3.4 19.6-9.9 5.5-5.7 9.5-12.9 14.3-18 5.1-5.5 10-8.1 17.7-6.9 8.1 1.2 15.1 6.8 21.9 16l19.6 35.6c9.5 19.9 43.1 48.4 41 68.9zm-1.4-25.9c-4.1-6.6-9.6-13.6-14.4-19.6 7.1 0 14.2-2.2 16.7-8.9 2.3-6.2 0-14.9-7.4-24.9-13.5-18.2-38.3-32.5-38.3-32.5-13.5-8.4-21.1-18.7-24.6-29.9s-3-23.3-.3-35.2c5.2-22.9 18.6-45.2 27.2-59.2 2.3-1.7.8 3.2-8.7 20.8-8.5 16.1-24.4 53.3-2.6 82.4.6-20.7 5.5-41.8 13.8-61.5 12-27.4 37.3-74.9 39.3-112.7 1.1.8 4.6 3.2 6.2 4.1 4.6 2.7 8.1 6.7 12.6 10.3 12.4 10 28.5 9.2 42.4 1.2 6.2-3.5 11.2-7.5 15.9-9 9.9-3.1 17.8-8.6 22.3-15 7.7 30.4 25.7 74.3 37.2 95.7 6.1 11.4 18.3 35.5 23.6 64.6 3.3-.1 7 .4 10.9 1.4 13.8-35.7-11.7-74.2-23.3-84.9-4.7-4.6-4.9-6.6-2.6-6.5 12.6 11.2 29.2 33.7 35.2 59 2.8 11.6 3.3 23.7.4 35.7 16.4 6.8 35.9 17.9 30.7 34.8-2.2-.1-3.2 0-4.2 0 3.2-10.1-3.9-17.6-22.8-26.1-19.6-8.6-36-8.6-38.3 12.5-12.1 4.2-18.3 14.7-21.4 27.3-2.8 11.2-3.6 24.7-4.4 39.9-.5 7.7-3.6 18-6.8 29-32.1 22.9-76.7 32.9-114.3 7.2zm257.4-11.5c-.9 16.8-41.2 19.9-63.2 46.5-13.2 15.7-29.4 24.4-43.6 25.5s-26.5-4.8-33.7-19.3c-4.7-11.1-2.4-23.1 1.1-36.3 3.7-14.2 9.2-28.8 9.9-40.6.8-15.2 1.7-28.5 4.2-38.7 2.6-10.3 6.6-17.2 13.7-21.1.3-.2.7-.3 1-.5.8 13.2 7.3 26.6 18.8 29.5 12.6 3.3 30.7-7.5 38.4-16.3 9-.3 15.7-.9 22.6 5.1 9.9 8.5 7.1 30.3 17.1 41.6 10.6 11.6 14 19.5 13.7 24.6zM173.3 148.7c2 1.9 4.7 4.5 8 7.1 6.6 5.2 15.8 10.6 27.3 10.6 11.6 0 22.5-5.9 31.8-10.8 4.9-2.6 10.9-7 14.8-10.4s5.9-6.3 3.1-6.6-2.6 2.6-6 5.1c-4.4 3.2-9.7 7.4-13.9 9.8-7.4 4.2-19.5 10.2-29.9 10.2s-18.7-4.8-24.9-9.7c-3.1-2.5-5.7-5-7.7-6.9-1.5-1.4-1.9-4.6-4.3-4.9-1.4-.1-1.8 3.7 1.7 6.5z"/></svg></span> <br> Client Linux VM (i.e. Skytap for the lab)</td>
<td>Generated in <a href="#securebuild-lab-create-server-create-certificate-and-key-for-server-side-certificate-checking-in-tls" target="_blank">this section of the lab</a> and the public key is passed to the server when creating the secure build server</td>
<td>ISV or application developer or Cloud Admin</td>
</tr>
<tr>
<td><code>Repository Registration Signing Key</code></td>
<td><a href="https://www.drdobbs.com/rsa-digital-signatures/184404605" target="_blank">RSA</a> 4096 bit key pair (encrypted using GPG utility) (signatures use <a href="https://en.bitcoinwiki.org/wiki/SHA-256" target="_blank">SHA256</a> hashing)</td>
<td>The private key signs the repository definition file and the public key verifies this signature. Needed to create and update repositories defined on a Hyper Protect Virtual Servers appliance</td>
<td align="center"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M220.8 123.3c1 .5 1.8 1.7 3 1.7 1.1 0 2.8-.4 2.9-1.5.2-1.4-1.9-2.3-3.2-2.9-1.7-.7-3.9-1-5.5-.1-.4.2-.8.7-.6 1.1.3 1.3 2.3 1.1 3.4 1.7zm-21.9 1.7c1.2 0 2-1.2 3-1.7 1.1-.6 3.1-.4 3.5-1.6.2-.4-.2-.9-.6-1.1-1.6-.9-3.8-.6-5.5.1-1.3.6-3.4 1.5-3.2 2.9.1 1 1.8 1.5 2.8 1.4zM420 403.8c-3.6-4-5.3-11.6-7.2-19.7-1.8-8.1-3.9-16.8-10.5-22.4-1.3-1.1-2.6-2.1-4-2.9-1.3-.8-2.7-1.5-4.1-2 9.2-27.3 5.6-54.5-3.7-79.1-11.4-30.1-31.3-56.4-46.5-74.4-17.1-21.5-33.7-41.9-33.4-72C311.1 85.4 315.7.1 234.8 0 132.4-.2 158 103.4 156.9 135.2c-1.7 23.4-6.4 41.8-22.5 64.7-18.9 22.5-45.5 58.8-58.1 96.7-6 17.9-8.8 36.1-6.2 53.3-6.5 5.8-11.4 14.7-16.6 20.2-4.2 4.3-10.3 5.9-17 8.3s-14 6-18.5 14.5c-2.1 3.9-2.8 8.1-2.8 12.4 0 3.9.6 7.9 1.2 11.8 1.2 8.1 2.5 15.7.8 20.8-5.2 14.4-5.9 24.4-2.2 31.7 3.8 7.3 11.4 10.5 20.1 12.3 17.3 3.6 40.8 2.7 59.3 12.5 19.8 10.4 39.9 14.1 55.9 10.4 11.6-2.6 21.1-9.6 25.9-20.2 12.5-.1 26.3-5.4 48.3-6.6 14.9-1.2 33.6 5.3 55.1 4.1.6 2.3 1.4 4.6 2.5 6.7v.1c8.3 16.7 23.8 24.3 40.3 23 16.6-1.3 34.1-11 48.3-27.9 13.6-16.4 36-23.2 50.9-32.2 7.4-4.5 13.4-10.1 13.9-18.3.4-8.2-4.4-17.3-15.5-29.7zM223.7 87.3c9.8-22.2 34.2-21.8 44-.4 6.5 14.2 3.6 30.9-4.3 40.4-1.6-.8-5.9-2.6-12.6-4.9 1.1-1.2 3.1-2.7 3.9-4.6 4.8-11.8-.2-27-9.1-27.3-7.3-.5-13.9 10.8-11.8 23-4.1-2-9.4-3.5-13-4.4-1-6.9-.3-14.6 2.9-21.8zM183 75.8c10.1 0 20.8 14.2 19.1 33.5-3.5 1-7.1 2.5-10.2 4.6 1.2-8.9-3.3-20.1-9.6-19.6-8.4.7-9.8 21.2-1.8 28.1 1 .8 1.9-.2-5.9 5.5-15.6-14.6-10.5-52.1 8.4-52.1zm-13.6 60.7c6.2-4.6 13.6-10 14.1-10.5 4.7-4.4 13.5-14.2 27.9-14.2 7.1 0 15.6 2.3 25.9 8.9 6.3 4.1 11.3 4.4 22.6 9.3 8.4 3.5 13.7 9.7 10.5 18.2-2.6 7.1-11 14.4-22.7 18.1-11.1 3.6-19.8 16-38.2 14.9-3.9-.2-7-1-9.6-2.1-8-3.5-12.2-10.4-20-15-8.6-4.8-13.2-10.4-14.7-15.3-1.4-4.9 0-9 4.2-12.3zm3.3 334c-2.7 35.1-43.9 34.4-75.3 18-29.9-15.8-68.6-6.5-76.5-21.9-2.4-4.7-2.4-12.7 2.6-26.4v-.2c2.4-7.6.6-16-.6-23.9-1.2-7.8-1.8-15 .9-20 3.5-6.7 8.5-9.1 14.8-11.3 10.3-3.7 11.8-3.4 19.6-9.9 5.5-5.7 9.5-12.9 14.3-18 5.1-5.5 10-8.1 17.7-6.9 8.1 1.2 15.1 6.8 21.9 16l19.6 35.6c9.5 19.9 43.1 48.4 41 68.9zm-1.4-25.9c-4.1-6.6-9.6-13.6-14.4-19.6 7.1 0 14.2-2.2 16.7-8.9 2.3-6.2 0-14.9-7.4-24.9-13.5-18.2-38.3-32.5-38.3-32.5-13.5-8.4-21.1-18.7-24.6-29.9s-3-23.3-.3-35.2c5.2-22.9 18.6-45.2 27.2-59.2 2.3-1.7.8 3.2-8.7 20.8-8.5 16.1-24.4 53.3-2.6 82.4.6-20.7 5.5-41.8 13.8-61.5 12-27.4 37.3-74.9 39.3-112.7 1.1.8 4.6 3.2 6.2 4.1 4.6 2.7 8.1 6.7 12.6 10.3 12.4 10 28.5 9.2 42.4 1.2 6.2-3.5 11.2-7.5 15.9-9 9.9-3.1 17.8-8.6 22.3-15 7.7 30.4 25.7 74.3 37.2 95.7 6.1 11.4 18.3 35.5 23.6 64.6 3.3-.1 7 .4 10.9 1.4 13.8-35.7-11.7-74.2-23.3-84.9-4.7-4.6-4.9-6.6-2.6-6.5 12.6 11.2 29.2 33.7 35.2 59 2.8 11.6 3.3 23.7.4 35.7 16.4 6.8 35.9 17.9 30.7 34.8-2.2-.1-3.2 0-4.2 0 3.2-10.1-3.9-17.6-22.8-26.1-19.6-8.6-36-8.6-38.3 12.5-12.1 4.2-18.3 14.7-21.4 27.3-2.8 11.2-3.6 24.7-4.4 39.9-.5 7.7-3.6 18-6.8 29-32.1 22.9-76.7 32.9-114.3 7.2zm257.4-11.5c-.9 16.8-41.2 19.9-63.2 46.5-13.2 15.7-29.4 24.4-43.6 25.5s-26.5-4.8-33.7-19.3c-4.7-11.1-2.4-23.1 1.1-36.3 3.7-14.2 9.2-28.8 9.9-40.6.8-15.2 1.7-28.5 4.2-38.7 2.6-10.3 6.6-17.2 13.7-21.1.3-.2.7-.3 1-.5.8 13.2 7.3 26.6 18.8 29.5 12.6 3.3 30.7-7.5 38.4-16.3 9-.3 15.7-.9 22.6 5.1 9.9 8.5 7.1 30.3 17.1 41.6 10.6 11.6 14 19.5 13.7 24.6zM173.3 148.7c2 1.9 4.7 4.5 8 7.1 6.6 5.2 15.8 10.6 27.3 10.6 11.6 0 22.5-5.9 31.8-10.8 4.9-2.6 10.9-7 14.8-10.4s5.9-6.3 3.1-6.6-2.6 2.6-6 5.1c-4.4 3.2-9.7 7.4-13.9 9.8-7.4 4.2-19.5 10.2-29.9 10.2s-18.7-4.8-24.9-9.7c-3.1-2.5-5.7-5-7.7-6.9-1.5-1.4-1.9-4.6-4.3-4.9-1.4-.1-1.8 3.7 1.7 6.5z"/></svg></span> <br> Client Linux VM (i.e. Skytap for the lab)</td>
<td>By the <a href="https://gnupg.org/gph/en/manual.html" target="_blank">GnuPG utility</a> using the <code>gpg --generate-key</code> command in <a href="#securebuild-lab-build-create-repository-registration-gpg-signing-key" target="_blank">this section of the lab</a></td>
<td>ISV or application developer</td>
</tr>
<tr>
<td><code>Root Key</code></td>
<td><a href="https://en.bitcoinwiki.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" target="_blank">ECDSA</a> (NIST P-256 curve) 256 bit key pair (signatures use <a href="https://en.bitcoinwiki.org/wiki/SHA-256" target="_blank">SHA256</a> hashing)</td>
<td>Signs the <code>root.json</code> metadata file which specifies which keys are valid for image signing, snapshots, and timestamps for a given secure build server</td>
<td align="center"><img alt="hpvs logo" src="../images/hpvs-logo.svg" /> <br> Encrypted in Secure Build Server Quotagroup</td>
<td>In response to the <code>hpvs sb build</code> command, Docker Content Trust CLI generates this key on the secure build server on first push to remote Docker repository in <a href="#securebuild-lab-build-build-application" target="_blank">this section of lab</a></td>
<td>ISV or application developer</td>
</tr>
<tr>
<td><code>Image Signing "Targets" Key</code></td>
<td><a href="https://en.bitcoinwiki.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" target="_blank">ECDSA</a> (NIST P-256 curve) 256 bit key pair (signatures use <a href="https://en.bitcoinwiki.org/wiki/SHA-256" target="_blank">SHA256</a> hashing)</td>
<td>Signs the <code>targets.json</code> metadata file which specifies the hashes of securely built Docker images</td>
<td align="center"><img alt="hpvs logo" src="../images/hpvs-logo.svg" /> <br> Encrypted in Secure Build Server Quotagroup</td>
<td>In response to the <code>hpvs sb build</code> command, Docker Content Trust CLI generates this key on the secure build server on first push to a remote Docker repository in <a href="#securebuild-lab-build-build-application" target="_blank">this section of lab</a></td>
<td>ISV or application developer</td>
</tr>
<tr>
<td><code>Snapshot Key</code></td>
<td><a href="https://en.bitcoinwiki.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" target="_blank">ECDSA</a> (NIST P-256 curve) 256 bit key pair (signatures use <a href="https://en.bitcoinwiki.org/wiki/SHA-256" target="_blank">SHA256</a> hashing)</td>
<td>Signs the <code>snapshot.json</code> metadata file which specifies the filenames, sizes, and hashes of the <code>targets.json</code> and <code>root.json</code> metadata files to prevent mix and match attacks</td>
<td align="center"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg></span> <br> Stored encrypted using <a href="https://github.com/dvsekhvalnov/jose2go" target="_blank">Javascript Object Signing and Encryption</a> in the image registry's signer database <a href="https://docs.docker.com/notary/service_architecture/#architecture-and-components" target="_blank">see Notary Service Architecture for more detail</a></td>
<td>By the Notary server on the first push to a given Docker repository (triggered by <code>hpvs sb build</code> in <a href="#securebuild-lab-build-build-application" target="_blank">this section of the lab.</a>)</td>
<td>Image registry administrator</td>
</tr>
<tr>
<td><code>Timestamp Key</code></td>
<td><a href="https://en.bitcoinwiki.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" target="_blank">ECDSA</a> (NIST P-256 curve) 256 bit key pair (signatures use <a href="https://en.bitcoinwiki.org/wiki/SHA-256" target="_blank">SHA256</a> hashing)</td>
<td>Frequently signs the <code>timestamp.json</code> metadata file which specifies the hash and size of the <code>snapshot.json</code> file at the current time to provide freshness guarantees without needing to re-download content on the client side</td>
<td align="center"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg></span> <br> Stored encrypted using <a href="https://github.com/dvsekhvalnov/jose2go" target="_blank">Javascript Object Signing and Encryption</a> in the image registry's signer database <a href="https://docs.docker.com/notary/service_architecture/#architecture-and-components" target="_blank">see Notary Service Architecture for more detail</a></td>
<td>Initially by the Notary server on the first push to a given Docker repository (triggered by <code>hpvs sb build</code> in <a href="#securebuild-lab-build-build-application" target="_blank">this section of the lab.</a>) This key has the shortest expiry time and is frequently rotated by the image registry's Notary server</td>
<td>Image registry administrator</td>
</tr>
<tr>
<td><code>Manifest Signing Key</code></td>
<td><a href="https://www.drdobbs.com/rsa-digital-signatures/184404605" target="_blank">RSA</a> 2048 bit key pair (signatures use <a href="https://en.bitcoinwiki.org/wiki/SHA-256" target="_blank">SHA256</a> hashing)</td>
<td>The secure build server uses the private key to sign the manifest bundle which contains the source code used to build the docker image, any ssh keys (the public part) that could have access to the server (if enabled), and the logs and status of the secure build at the time of image signing.</td>
<td align="center"><img alt="hpvs logo" src="../images/hpvs-logo.svg" /> <br> Encrypted in Secure Build Server Quotagroup</td>
<td>Created at the end of the secure build after each <code>hpvs sb build</code> in <a href="#securebuild-lab-build-build-application" target="_blank">this section of the lab</a>. The corresponding public key and the manifest itself are retrieved securely (using the <code>Secure Build Server Client Certificate and Key</code>) by the client VM to verify the build in <a href="#securebuild-lab-build-verify-your-application" target="_blank">this section of the lab</a></td>
<td>ISV or application developer</td>
</tr>
</tbody>
</table>
</details>
<h3 id="securebuild-lab-overview-register">REGISTER<a class="headerlink" href="#securebuild-lab-overview-register" title="Permanent link">&para;</a></h3>
<p>Register your securely built Docker Image with your Secure Service Container to verify its validity<sup id="fnref:3"><a class="footnote-ref" href="#securebuild-lab-overview-fn:3">3</a></sup> (see the end of <a href="#securebuild-lab-build" target="_blank"><code>Securely Build your Application</code></a> and the beginning of <a href="#securebuild-lab-deploy-app" target="_blank"><code>Deploy your Securely Built Application as a Hyper Protect Virtual Server</code></a>).
<img alt="Image Registration Overview" src="../securebuild-lab/Overview_Images/Image_Registration_Overview.png" /></p>
<h3 id="securebuild-lab-overview-deploy">DEPLOY<a class="headerlink" href="#securebuild-lab-overview-deploy" title="Permanent link">&para;</a></h3>
<p>Deploy your Secure Bitcoin Wallet application <code>(from the verified repository created in step 3)</code> as a Hyper Protect Virtual Server within its own secure enclave<sup id="fnref:4"><a class="footnote-ref" href="#securebuild-lab-overview-fn:4">4</a></sup> (see <a href="#securebuild-lab-deploy-app" target="_blank"><code>Deploy your Securely Built Application as a Hyper Protect Virtual Server</code></a>).
<img alt="Hyper Protect Virtual Servers Overview" src="../securebuild-lab/Overview_Images/Hyper_Protect_Virtual_Server_Overview.png" /></p>
<h3 id="securebuild-lab-overview-access">ACCESS<a class="headerlink" href="#securebuild-lab-overview-access" title="Permanent link">&para;</a></h3>
<p>Access your <a href="https://github.com/IBM/secure-bitcoin-wallet" target="_blank">Secure Electrum Bitcoin Wallet Application</a> application to use it with security built-in (see <a href="#securebuild-lab-bitcoin_wallet" target="_blank"><code>Welcome to the Secure Bitcoin Wallet on IBM LinuxONE</code></a>).</p>
<h3 id="securebuild-lab-overview-cleanup">CLEANUP<a class="headerlink" href="#securebuild-lab-overview-cleanup" title="Permanent link">&para;</a></h3>
<p>Clean up your environment for future users (see <a href="#securebuild-lab-cleanup" target="_blank"><code>Clean up your environment</code></a>).</p>
<div class="footnote">
<hr />
<ol>
<li id="securebuild-lab-overview-fn:1">
<p>The <code>Secure Build Experience</code> graphic is adapted from charts provided by the Hyper Protect Virtual Servers On-Premises development team.&#160;<a class="footnote-backref" href="#securebuild-lab-overview-fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="securebuild-lab-overview-fn:2">
<p>The above table explains all of the keys used for this lab, expounding on the more general table provided in the <a href="https://www.ibm.com/support/knowledgecenter/en/SSHPMH_1.2.x/120x_topics/keys_in_securebuild.html" target="_blank">IBM Knowledge Center</a> with specific details for the lab and omitting keys not used during the course of the lab.&#160;<a class="footnote-backref" href="#securebuild-lab-overview-fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="securebuild-lab-overview-fn:3">
<p>The <code>Image Registration Experience</code> graphic is adapted from charts provided by the Hyper Protect Virtual Servers On-Premises development team.&#160;<a class="footnote-backref" href="#securebuild-lab-overview-fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="securebuild-lab-overview-fn:4">
<p>The <code>Hyper Protect Virtual Server Experience</code> graphic is adapted from charts provided by the Hyper Protect Virtual Servers On-Premises development team.&#160;<a class="footnote-backref" href="#securebuild-lab-overview-fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="securebuild-lab-securebuild-setup"><h1 id="securebuild-lab-securebuild-setup-configuring-your-environment">Configuring your Environment<a class="headerlink" href="#securebuild-lab-securebuild-setup-configuring-your-environment" title="Permanent link">&para;</a></h1>
<h2 id="securebuild-lab-securebuild-setup-explore-the-hyper-protect-virtual-servers-command-line-interface-cli">Explore the Hyper Protect Virtual Servers command line interface (CLI)<a class="headerlink" href="#securebuild-lab-securebuild-setup-explore-the-hyper-protect-virtual-servers-command-line-interface-cli" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>In this lab, we will use the Hyper Protect Virtual Servers CLI (<code>hpvs</code> command) to interact with our Hyper Protect Virtual Servers Hosting Appliance in order to perform the various actions necessary for the Secure Build. Below is a quick introduction to the commands available through this CLI.</p>
</div>
<ol>
<li>
<p>See the different commands you could enter with:</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>IBM®<span class="w"> </span>Hyper<span class="w"> </span>Protect<span class="w"> </span>Virtual<span class="w"> </span>Servers,<span class="w"> </span>the<span class="w"> </span>evolution<span class="w"> </span>of<span class="w"> </span>the
IBM®<span class="w"> </span>Secure<span class="w"> </span>Service<span class="w"> </span>Container<span class="w"> </span><span class="k">for</span><span class="w"> </span>IBM®<span class="w"> </span>Cloud<span class="w"> </span>Private<span class="w"> </span>offering,
protects<span class="w"> </span>Linux<span class="w"> </span>workloads<span class="w"> </span>on<span class="w"> </span>IBM<span class="w"> </span>Z<span class="w"> </span>and<span class="w"> </span>LinuxONE<span class="w"> </span>throughout<span class="w"> </span>their
lifecycle<span class="w"> </span>build<span class="w"> </span>management<span class="w"> </span>and<span class="w"> </span>deployment.
This<span class="w"> </span>solution<span class="w"> </span>delivers<span class="w"> </span>the<span class="w"> </span>security<span class="w"> </span>needed<span class="w"> </span>to<span class="w"> </span>protect
mission<span class="w"> </span>critical<span class="w"> </span>applications<span class="w"> </span><span class="k">in</span><span class="w"> </span>hybrid<span class="w"> </span>multi-cloud<span class="w"> </span>deployments.

Usage:
hpvs<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
completion<span class="w">  </span>generate<span class="w"> </span>the<span class="w"> </span>autocompletion<span class="w"> </span>script<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>specified<span class="w"> </span>shell
crypto<span class="w">      </span>Crypto<span class="w"> </span><span class="nb">command</span>
deploy<span class="w">      </span>Deploy<span class="w"> </span><span class="nb">command</span>
<span class="nb">help</span><span class="w">        </span>Help<span class="w"> </span>about<span class="w"> </span>any<span class="w"> </span><span class="nb">command</span>
host<span class="w">        </span>Host<span class="w"> </span><span class="nb">command</span>
image<span class="w">       </span>Image<span class="w"> </span>Command
network<span class="w">     </span>Network<span class="w"> </span><span class="nb">command</span>
quotagroup<span class="w">  </span>Quotagroup<span class="w"> </span><span class="nb">command</span>
regfile<span class="w">     </span>Generate<span class="w"> </span>encrypted<span class="w"> </span>repository<span class="w"> </span>registration<span class="w"> </span>file.<span class="w"> </span>If<span class="w"> </span>you<span class="w"> </span>have<span class="w"> </span>already<span class="w"> </span>image<span class="w"> </span>build<span class="w"> </span>on<span class="w"> </span>s390x<span class="w"> </span>arch
registry<span class="w">    </span>Registry<span class="w"> </span><span class="nb">command</span>
repository<span class="w">  </span>Repository<span class="w"> </span><span class="nb">command</span>
sb<span class="w">          </span>SecureBuild<span class="w"> </span><span class="nb">command</span>
snapshot<span class="w">    </span>Snapshot<span class="w"> </span><span class="nb">command</span>
undeploy<span class="w">    </span>Undeploy<span class="w"> </span><span class="nb">command</span>
version<span class="w">     </span>Print<span class="w"> </span>hpvs<span class="w"> </span>version
vs<span class="w">          </span>Virtual<span class="w"> </span>Server<span class="w"> </span><span class="nb">command</span>

Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
-h,<span class="w"> </span>--help<span class="w">                    </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>hpvs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</li>
<li>
<p>See more information for the <code>Available Commands</code> listed above with:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:16"><input checked="checked" id="securebuild-lab-securebuild-setup-__tabbed_1_1" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_2" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_3" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_4" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_5" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_6" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_7" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_8" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_9" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_10" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_11" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_12" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_13" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_14" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_15" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_1_16" name="securebuild-lab-securebuild-setup-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="securebuild-lab-securebuild-setup-__tabbed_1_1">completion</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_2">crypto</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_3">deploy</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_4">help</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_5">host</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_6">image</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_7">network</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_8">quotagroup</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_9">regfile</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_10">registry</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_11">repository</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_12">sb</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_13">snapshot</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_14">undeploy</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_15">version</label><label for="securebuild-lab-securebuild-setup-__tabbed_1_16">vs</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>completion<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Generate<span class="w"> </span>the<span class="w"> </span>autocompletion<span class="w"> </span>script<span class="w"> </span><span class="k">for</span><span class="w"> </span>hpvs<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>specified<span class="w"> </span>shell.
See<span class="w"> </span>each<span class="w"> </span>sub-command<span class="err">&#39;</span>s<span class="w"> </span><span class="nb">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>details<span class="w"> </span>on<span class="w"> </span>how<span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span>the<span class="w"> </span>generated<span class="w"> </span>script.

Usage:
hpvs<span class="w"> </span>completion<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
bash<span class="w">        </span>generate<span class="w"> </span>the<span class="w"> </span>autocompletion<span class="w"> </span>script<span class="w"> </span><span class="k">for</span><span class="w"> </span>bash
fish<span class="w">        </span>generate<span class="w"> </span>the<span class="w"> </span>autocompletion<span class="w"> </span>script<span class="w"> </span><span class="k">for</span><span class="w"> </span>fish
powershell<span class="w">  </span>generate<span class="w"> </span>the<span class="w"> </span>autocompletion<span class="w"> </span>script<span class="w"> </span><span class="k">for</span><span class="w"> </span>powershell
zsh<span class="w">         </span>generate<span class="w"> </span>the<span class="w"> </span>autocompletion<span class="w"> </span>script<span class="w"> </span><span class="k">for</span><span class="w"> </span>zsh

Flags:
-h,<span class="w"> </span>--help<span class="w">   </span><span class="nb">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>completion

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs completion [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>crypto<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>List<span class="w"> </span>crypto

Usage:
hpvs<span class="w"> </span>crypto<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
list<span class="w">        </span>List<span class="w"> </span>crypto

Flags:
-h,<span class="w"> </span>--help<span class="w">          </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>crypto
<span class="w">    </span>--host<span class="w"> </span>string<span class="w">   </span>Host<span class="w"> </span>LPAR<span class="w"> </span>name
<span class="w">    </span>--json<span class="w">          </span><span class="k">if</span><span class="w"> </span>--json<span class="w"> </span>flag<span class="w"> </span>is<span class="w"> </span>passed<span class="w"> </span>,<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span><span class="k">in</span><span class="w"> </span>json<span class="w"> </span>format

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs crypto [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>deploy<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Deploy<span class="w"> </span>virtual<span class="w"> </span>servers

Usage:
hpvs<span class="w"> </span>deploy<span class="w"> </span><span class="o">[</span>flags<span class="o">]</span>

Flags:
<span class="w">    </span>--config<span class="w"> </span>string<span class="w">         </span>YAML<span class="w"> </span>configuration<span class="w"> </span>file<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>virtual<span class="w"> </span>server<span class="w"> </span>deployment
<span class="w">    </span>--exclude<span class="w"> </span>strings<span class="w">       </span>Virtual<span class="w"> </span>servers<span class="w"> </span>e.g<span class="w"> </span>vs1,vs2<span class="p">;</span><span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>excluded<span class="w"> </span>from
<span class="w">                            </span>deploying,<span class="w"> </span>other<span class="w"> </span>vs<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>included<span class="w"> </span><span class="k">for</span><span class="w"> </span>deployment,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>all
<span class="w">                            </span>vs<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>deployed
-h,<span class="w"> </span>--help<span class="w">                  </span><span class="nb">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>deploy
<span class="w">    </span>--include<span class="w"> </span>strings<span class="w">       </span>Virtual<span class="w"> </span>servers<span class="w"> </span>e.g<span class="w"> </span>vs1,vs2<span class="p">;</span><span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>included<span class="w"> </span><span class="k">for</span>
<span class="w">                            </span>deploying,<span class="w"> </span>other<span class="w"> </span>vs<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>excluded<span class="w"> </span>from<span class="w"> </span>deployment<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>all
<span class="w">                            </span>vs<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>deployed
<span class="w">    </span>--templatefile<span class="w"> </span>string<span class="w">   </span>YAML<span class="w"> </span>resource<span class="w"> </span>template<span class="w"> </span>file<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>virtual<span class="w"> </span>server<span class="w"> </span>deployment
-u,<span class="w"> </span>--update<span class="w">                </span>If<span class="w"> </span>-u<span class="w"> </span>is<span class="w"> </span>passed<span class="w"> </span>virtual<span class="w"> </span>server<span class="w"> </span>deployment<span class="w"> </span>setup<span class="w"> </span>gets<span class="w"> </span>updated

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span><span class="nb">help</span><span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Help<span class="w"> </span>provides<span class="w"> </span><span class="nb">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>any<span class="w"> </span><span class="nb">command</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>application.
Simply<span class="w"> </span><span class="nb">type</span><span class="w"> </span>hpvs<span class="w"> </span><span class="nb">help</span><span class="w"> </span><span class="o">[</span>path<span class="w"> </span>to<span class="w"> </span>command<span class="o">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>full<span class="w"> </span>details.

Usage:
hpvs<span class="w"> </span><span class="nb">help</span><span class="w"> </span><span class="o">[</span>command<span class="o">]</span><span class="w"> </span><span class="o">[</span>flags<span class="o">]</span>

Flags:
-h,<span class="w"> </span>--help<span class="w">   </span><span class="nb">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">help</span>

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>host<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>add,<span class="w"> </span>delete,<span class="w"> </span>update,<span class="w"> </span>list,<span class="w"> </span>unset,<span class="w"> </span>show,<span class="w"> </span><span class="nb">set</span><span class="w"> </span>Host

Usage:
hpvs<span class="w"> </span>host<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
add<span class="w">         </span>Add<span class="w"> </span>host
delete<span class="w">      </span>Delete<span class="w"> </span>host
list<span class="w">        </span>List<span class="w"> </span>host
<span class="nb">set</span><span class="w">         </span>Set<span class="w"> </span>host
show<span class="w">        </span>Show<span class="w"> </span>host
<span class="nb">unset</span><span class="w">       </span>Unset<span class="w"> </span>host
update<span class="w">      </span>Update<span class="w"> </span>host

Flags:
-h,<span class="w"> </span>--help<span class="w">   </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>host

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs host [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>image<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>list,<span class="w"> </span>delete,<span class="w"> </span>show,<span class="w"> </span>load,<span class="w"> </span>pull<span class="w"> </span>Image

Usage:
hpvs<span class="w"> </span>image<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
delete<span class="w">      </span>Delete<span class="w"> </span>image
list<span class="w">        </span>List<span class="w"> </span>image
load<span class="w">        </span>Upload<span class="w"> </span>image
pull<span class="w">        </span>Pull<span class="w"> </span>image
show<span class="w">        </span>Show<span class="w"> </span>image

Flags:
-h,<span class="w"> </span>--help<span class="w">          </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>image
<span class="w">    </span>--host<span class="w"> </span>string<span class="w">   </span>Host<span class="w"> </span>LPAR<span class="w"> </span>name
<span class="w">    </span>--json<span class="w">          </span><span class="k">if</span><span class="w"> </span>--json<span class="w"> </span>flag<span class="w"> </span>is<span class="w"> </span>passed<span class="w"> </span>,<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span><span class="k">in</span><span class="w"> </span>json<span class="w"> </span>format

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs image [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>network<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>list,<span class="w"> </span>create,<span class="w"> </span>update,<span class="w"> </span>delete,<span class="w"> </span>show<span class="w"> </span>Network

Usage:
hpvs<span class="w"> </span>network<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
create<span class="w">      </span>Create<span class="w"> </span>network
delete<span class="w">      </span>Delete<span class="w"> </span>network
list<span class="w">        </span>List<span class="w"> </span>network
show<span class="w">        </span>Show<span class="w"> </span>network
update<span class="w">      </span>Update<span class="w"> </span>network

Flags:
-h,<span class="w"> </span>--help<span class="w">          </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>network
<span class="w">    </span>--host<span class="w"> </span>string<span class="w">   </span>Host<span class="w"> </span>LPAR<span class="w"> </span>name
<span class="w">    </span>--json<span class="w">          </span><span class="k">if</span><span class="w"> </span>--json<span class="w"> </span>flag<span class="w"> </span>is<span class="w"> </span>passed<span class="w"> </span>,<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span><span class="k">in</span><span class="w"> </span>json<span class="w"> </span>format

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs network [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>quotagroup<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>create,<span class="w"> </span>delete,<span class="w"> </span>list,<span class="w"> </span>show,<span class="w"> </span>update<span class="w"> </span>Quotagroup

Usage:
hpvs<span class="w"> </span>quotagroup<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
create<span class="w">      </span>Create<span class="w"> </span>quotagroup
delete<span class="w">      </span>Delete<span class="w"> </span>quotagroup
list<span class="w">        </span>List<span class="w"> </span>quotagroup
show<span class="w">        </span>Show<span class="w"> </span>quotagroup
update<span class="w">      </span>Update<span class="w"> </span>quotagroup

Flags:
-h,<span class="w"> </span>--help<span class="w">          </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>quotagroup
<span class="w">    </span>--host<span class="w"> </span>string<span class="w">   </span>Host<span class="w"> </span>LPAR<span class="w"> </span>name
<span class="w">    </span>--json<span class="w">          </span><span class="k">if</span><span class="w"> </span>--json<span class="w"> </span>flag<span class="w"> </span>is<span class="w"> </span>passed<span class="w"> </span>,<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span><span class="k">in</span><span class="w"> </span>json<span class="w"> </span>format

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs quotagroup [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>regfile<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Generate<span class="w"> </span>encrypted<span class="w"> </span>repository<span class="w"> </span>registration<span class="w"> </span>file.<span class="w"> </span>If<span class="w"> </span>you<span class="w"> </span>have<span class="w"> </span>already<span class="w"> </span>image<span class="w"> </span>build<span class="w"> </span>on<span class="w"> </span>s390x<span class="w"> </span>arch

Usage:
hpvs<span class="w"> </span>regfile<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
create<span class="w">      </span>Create<span class="w"> </span>encrypted<span class="w"> </span>repository<span class="w"> </span>registration<span class="w"> </span>file

Flags:
-h,<span class="w"> </span>--help<span class="w">   </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>regfile

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs regfile [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>registry<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>add,<span class="w"> </span>delete,<span class="w"> </span>update,<span class="w"> </span>list,<span class="w"> </span>show<span class="w"> </span>Registry

Usage:
hpvs<span class="w"> </span>registry<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
add<span class="w">         </span>Add<span class="w"> </span>registry
delete<span class="w">      </span>Delete<span class="w"> </span>registry
list<span class="w">        </span>List<span class="w"> </span>registry
show<span class="w">        </span>Show<span class="w"> </span>registry
update<span class="w">      </span>Update<span class="w"> </span>registry

Flags:
-h,<span class="w"> </span>--help<span class="w">   </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>registry
<span class="w">    </span>--json<span class="w">   </span><span class="k">if</span><span class="w"> </span>--json<span class="w"> </span>flag<span class="w"> </span>is<span class="w"> </span>passed<span class="w"> </span>,<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span><span class="k">in</span><span class="w"> </span>json<span class="w"> </span>format

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs registry [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>repository<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>list,<span class="w"> </span>register,<span class="w"> </span>delete,<span class="w"> </span>show,<span class="w"> </span>update<span class="w"> </span>Repository

Usage:
hpvs<span class="w"> </span>repository<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
delete<span class="w">      </span>Delete<span class="w"> </span>repository
list<span class="w">        </span>List<span class="w"> </span>repository
register<span class="w">    </span>Register<span class="w"> </span>repository
show<span class="w">        </span>Show<span class="w"> </span>repository
update<span class="w">      </span>Update<span class="w"> </span>repository

Flags:
-h,<span class="w"> </span>--help<span class="w">          </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>repository
<span class="w">    </span>--host<span class="w"> </span>string<span class="w">   </span>Host<span class="w"> </span>LPAR<span class="w"> </span>name
<span class="w">    </span>--json<span class="w">          </span><span class="k">if</span><span class="w"> </span>--json<span class="w"> </span>flag<span class="w"> </span>is<span class="w"> </span>passed<span class="w"> </span>,<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span><span class="k">in</span><span class="w"> </span>json<span class="w"> </span>format

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs repository [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>SecureBuild<span class="w"> </span><span class="nb">command</span>

Usage:
hpvs<span class="w"> </span>sb<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
build<span class="w">       </span>Securely<span class="w"> </span>build<span class="w"> </span>your<span class="w"> </span>image
clean<span class="w">       </span>Secure<span class="w"> </span>build<span class="w"> </span>clean.<span class="w"> </span>It<span class="w"> </span>will<span class="w"> </span>clean<span class="w"> </span>vs<span class="w"> </span>data<span class="w"> </span>eg<span class="w"> </span>-<span class="w"> </span>logs
init<span class="w">        </span>Initialize<span class="w"> </span>secure<span class="w"> </span>build<span class="w"> </span>configuration
log<span class="w">         </span>Get<span class="w"> </span>logs
manifest<span class="w">    </span>Get<span class="w"> </span>manifest<span class="w"> </span>file
pubkey<span class="w">      </span>Get<span class="w"> </span>manifest<span class="w"> </span>public<span class="w"> </span>key
regfile<span class="w">     </span>Get<span class="w"> </span>encrypted<span class="w"> </span>repository<span class="w"> </span>registration<span class="w"> </span>file
status<span class="w">      </span>Get<span class="w"> </span>secure<span class="w"> </span>build<span class="w"> </span>status
update<span class="w">      </span>Update<span class="w"> </span>secure<span class="w"> </span>build<span class="w"> </span>environment

Flags:
-h,<span class="w"> </span>--help<span class="w">   </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>sb

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs sb [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>snapshot<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>list,<span class="w"> </span>create,<span class="w"> </span>delete,<span class="w"> </span>restore<span class="w"> </span>Snapshot

Usage:
hpvs<span class="w"> </span>snapshot<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
create<span class="w">      </span>Create<span class="w"> </span>snapshot
delete<span class="w">      </span>Delete<span class="w"> </span>snapshot
list<span class="w">        </span>List<span class="w"> </span>snapshots
restore<span class="w">     </span>Restore<span class="w"> </span>snapshot

Flags:
-h,<span class="w"> </span>--help<span class="w">          </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>snapshot
<span class="w">    </span>--host<span class="w"> </span>string<span class="w">   </span>Host<span class="w"> </span>LPAR<span class="w"> </span>name
<span class="w">    </span>--json<span class="w">          </span><span class="k">if</span><span class="w"> </span>--json<span class="w"> </span>flag<span class="w"> </span>is<span class="w"> </span>passed<span class="w"> </span>,<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span><span class="k">in</span><span class="w"> </span>json<span class="w"> </span>format

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs snapshot [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>undeploy<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Undeploy<span class="w"> </span>virtual<span class="w"> </span>servers

Usage:
hpvs<span class="w"> </span>undeploy<span class="w"> </span><span class="o">[</span>flags<span class="o">]</span>

Flags:
<span class="w">    </span>--config<span class="w"> </span>string<span class="w">     </span>YAML<span class="w"> </span>configuration<span class="w"> </span>file<span class="w"> </span>used<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>virtual<span class="w"> </span>server<span class="w"> </span>deployment
<span class="w">    </span>--exclude<span class="w"> </span>strings<span class="w">   </span>Virtual<span class="w"> </span>servers<span class="w"> </span>e.g<span class="w"> </span>vs1,vs2<span class="p">;</span><span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>excluded<span class="w"> </span>from
<span class="w">                        </span>undeploying,<span class="w"> </span>other<span class="w"> </span>vs<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>included<span class="w"> </span><span class="k">for</span><span class="w"> </span>undeployment,<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>all
<span class="w">                        </span>vs<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>undeployed
-h,<span class="w"> </span>--help<span class="w">              </span><span class="nb">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>undeploy
<span class="w">    </span>--include<span class="w"> </span>strings<span class="w">   </span>Virtual<span class="w"> </span>servers<span class="w"> </span>e.g<span class="w"> </span>vs1,vs2<span class="p">;</span><span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>included<span class="w"> </span><span class="k">for</span>
<span class="w">                        </span>undeploying,<span class="w"> </span>other<span class="w"> </span>vs<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>excluded<span class="w"> </span>from<span class="w"> </span>undeployment<span class="w"> </span>by<span class="w"> </span>default<span class="w"> </span>all
<span class="w">                        </span>vs<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>undeployed

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>version<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Print<span class="w"> </span>hpvs<span class="w"> </span>version

Usage:
hpvs<span class="w"> </span>version<span class="w"> </span><span class="o">[</span>flags<span class="o">]</span>

Flags:
-h,<span class="w"> </span>--help<span class="w">   </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>version

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory
</code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>vs<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>create,<span class="w"> </span>delete,<span class="w"> </span>list,<span class="w"> </span>log,<span class="w"> </span>restart,<span class="w"> </span>show,<span class="w"> </span>start,<span class="w"> </span>stop<span class="w"> </span>VS

Usage:
hpvs<span class="w"> </span>vs<span class="w"> </span><span class="o">[</span>command<span class="o">]</span>

Available<span class="w"> </span>Commands:
create<span class="w">      </span>Create<span class="w"> </span>virtual<span class="w"> </span>server
delete<span class="w">      </span>Delete<span class="w"> </span>virtual<span class="w"> </span>server
list<span class="w">        </span>List<span class="w"> </span>virtual<span class="w"> </span>servers
log<span class="w">         </span>Get<span class="w"> </span>virtual<span class="w"> </span>server<span class="w"> </span>log
restart<span class="w">     </span>Restart<span class="w"> </span>virtual<span class="w"> </span>server
show<span class="w">        </span>Show<span class="w"> </span>virtual<span class="w"> </span>server
start<span class="w">       </span>Start<span class="w"> </span>virtual<span class="w"> </span>server
stop<span class="w">        </span>Stop<span class="w"> </span>virtual<span class="w"> </span>server
update<span class="w">      </span>Update<span class="w"> </span>virtual<span class="w"> </span>server

Flags:
-h,<span class="w"> </span>--help<span class="w">          </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>vs
<span class="w">    </span>--host<span class="w"> </span>string<span class="w">   </span>Host<span class="w"> </span>LPAR<span class="w"> </span>name
<span class="w">    </span>--json<span class="w">          </span><span class="k">if</span><span class="w"> </span>--json<span class="w"> </span>flag<span class="w"> </span>is<span class="w"> </span>passed<span class="w"> </span>,<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span><span class="k">in</span><span class="w"> </span>json<span class="w"> </span>format

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory

Use<span class="w"> </span><span class="s2">&quot;hpvs vs [command] --help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>about<span class="w"> </span>a<span class="w"> </span>command.
</code></pre></div>
</details>
</div>
</div>
</div>
</li>
<li>
<p>You can even dive into the <code>Available Commands</code> of the above commands with another <code>--help</code> <img alt="😮" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f62e.svg" title=":open_mouth:" /></p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>build<span class="w"> </span>--help
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Securely<span class="w"> </span>build<span class="w"> </span>your<span class="w"> </span>image

Usage:
hpvs<span class="w"> </span>sb<span class="w"> </span>build<span class="w"> </span><span class="o">[</span>flags<span class="o">]</span>

Flags:
<span class="w">    </span>--config<span class="w"> </span>string<span class="w">   </span>Config<span class="w"> </span>file<span class="w"> </span>path
-h,<span class="w"> </span>--help<span class="w">            </span>Help<span class="w"> </span><span class="k">for</span><span class="w"> </span>build
<span class="w">    </span>--timeout<span class="w"> </span>int<span class="w">     </span>Build<span class="w"> </span>timeout<span class="w"> </span><span class="k">in</span><span class="w"> </span>minutes<span class="w"> </span><span class="o">(</span>default<span class="w"> </span><span class="m">10</span><span class="o">)</span>

Global<span class="w"> </span>Flags:
<span class="w">    </span>--debug<span class="w">                   </span>If<span class="w"> </span>--debug<span class="w"> </span>is<span class="w"> </span>passed,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>debug<span class="w"> </span>logs
<span class="w">    </span>--log-output-dir<span class="w"> </span>string<span class="w">   </span>Set<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory
</code></pre></div>
</details>
</li>
<li>
<p>For further exploration of the Hyper Protect Virtual Servers CLI <a href="https://www.ibm.com/support/knowledgecenter/en/SSHPMH_1.2.x/topics/cmd_hpvs.html" target="_blank">see the Knowledge Center</a></p>
</li>
</ol>
<h2 id="securebuild-lab-securebuild-setup-add-docker-registry-to-use-for-secure-build">Add Docker registry to use for secure build<a class="headerlink" href="#securebuild-lab-securebuild-setup-add-docker-registry-to-use-for-secure-build" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>In this section you will add the details to connect to your Docker Hub Registry so your secure build container can push your securely built images there. Don't worry, your Docker token is safely encrypted on your Skytap Linux VM using the <code>HPVS Registry CLI Encryption Key</code> referenced in the <a href="#securebuild-lab-overview-fnref:2">key table</a>.</p>
</div>
<ol>
<li>
<p>See your current Docker registries with:</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>registry<span class="w"> </span>list
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>ERROR: HVS-RYLI001 List registry failed. Error occurred while reading /home/hpvsgrep11/hpvs/config/reg.json file. Refer to the product documentation for resolution.
</code></pre></div>
</details>
</li>
<li>
<p>Set your <code>DOCKER_USERNAME</code> to the username for your account on <a href="https://hub.docker.com/" target="_blank">Docker Hub</a></p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="securebuild-lab-securebuild-setup-__tabbed_2_1" name="securebuild-lab-securebuild-setup-__tabbed_2" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_2_2" name="securebuild-lab-securebuild-setup-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="securebuild-lab-securebuild-setup-__tabbed_2_1">Command Syntax</label><label for="securebuild-lab-securebuild-setup-__tabbed_2_2">Example Command</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">DOCKER_USERNAME</span><span class="o">=</span><span class="s2">&quot;my_username&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">DOCKER_USERNAME</span><span class="o">=</span><span class="s2">&quot;gmoney23&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will be the username you used when you created your <a href="https://hub.docker.com/" target="_blank">Docker Hub</a> account in the <a href="#prerequisites-Create-a-Docker-Hub" target="_blank">Prerequisites</a></p>
</div>
</li>
<li>
<p>Save your <code>DOCKER_USERNAME</code> to <code>bashrc</code> for later use.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export DOCKER_USERNAME=&#39;</span><span class="si">${</span><span class="nv">DOCKER_USERNAME</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
</code></pre></div>
</li>
<li>
<p>Set your <code>DOCKER_PASSWORD</code> to the token you created for this lab on <a href="https://hub.docker.com/" target="_blank">Docker Hub</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="securebuild-lab-securebuild-setup-__tabbed_3_1" name="securebuild-lab-securebuild-setup-__tabbed_3" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_3_2" name="securebuild-lab-securebuild-setup-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="securebuild-lab-securebuild-setup-__tabbed_3_1">Command Syntax</label><label for="securebuild-lab-securebuild-setup-__tabbed_3_2">Example Command</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">DOCKER_PASSWORD</span><span class="o">=</span><span class="s2">&quot;my_docker_token&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">DOCKER_PASSWORD</span><span class="o">=</span><span class="s2">&quot;123456789&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will be the Docker Hub token you created for the lab in the <a href="#prerequisites-create-a-docker-access-token" target="_blank">Prerequisites</a></p>
</div>
</li>
<li>
<p>Check your <a href="https://hub.docker.com/" target="_blank">Docker Hub</a> login credentials with a <code>docker login</code> and do a <code>docker logout</code> to remove unencrypted Docker credentials locally.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">DOCKER_PASSWORD</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>login<span class="w"> </span>-u<span class="w"> </span><span class="si">${</span><span class="nv">DOCKER_USERNAME</span><span class="si">}</span><span class="w"> </span>--password-stdin<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>docker<span class="w"> </span><span class="nb">logout</span>
</code></pre></div>
<details class="success" open="open">
<summary>Successful login</summary>
<div class="highlight"><pre><span></span><code>WARNING!<span class="w"> </span>Your<span class="w"> </span>password<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>stored<span class="w"> </span>unencrypted<span class="w"> </span><span class="k">in</span><span class="w"> </span>/home/hyper-protect-lab/.docker/config.json.
Configure<span class="w"> </span>a<span class="w"> </span>credential<span class="w"> </span>helper<span class="w"> </span>to<span class="w"> </span>remove<span class="w"> </span>this<span class="w"> </span>warning.<span class="w"> </span>See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login<span class="w"> </span>Succeeded
Removing<span class="w"> </span>login<span class="w"> </span>credentials<span class="w"> </span><span class="k">for</span><span class="w"> </span>https://index.docker.io/v1/
</code></pre></div>
</details>
<details class="failure" open="open">
<summary>Failed Login <img alt="😞" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f61e.svg" title=":disappointed:" /> Please redo <a href="#securebuild-lab-securebuild-setup-add-docker-registry-to-use-for-secure-build">this section</a></summary>
<div class="highlight"><pre><span></span><code>Error<span class="w"> </span>response<span class="w"> </span>from<span class="w"> </span>daemon:<span class="w"> </span>Get<span class="w"> </span>https://registry-1.docker.io/v2/:<span class="w"> </span>unauthorized:<span class="w"> </span>incorrect<span class="w"> </span>username<span class="w"> </span>or<span class="w"> </span>password
</code></pre></div>
</details>
</li>
<li>
<p>Set your <code>REGISTRY_NAME</code> to a Docker registry placeholder name of your choosing.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="securebuild-lab-securebuild-setup-__tabbed_4_1" name="securebuild-lab-securebuild-setup-__tabbed_4" type="radio" /><input id="securebuild-lab-securebuild-setup-__tabbed_4_2" name="securebuild-lab-securebuild-setup-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="securebuild-lab-securebuild-setup-__tabbed_4_1">Command Syntax</label><label for="securebuild-lab-securebuild-setup-__tabbed_4_2">Example Command</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">REGISTRY_NAME</span><span class="o">=</span><span class="s2">&quot;my_registry&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">REGISTRY_NAME</span><span class="o">=</span><span class="s2">&quot;g_docker_hub&quot;</span>
</code></pre></div>
</div>
</div>
</div>
</li>
<li>
<p>Save your <code>REGISTRY_NAME</code> to <code>bashrc</code> for future shells (in case you open new terminals)</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export REGISTRY_NAME=&#39;</span><span class="si">${</span><span class="nv">REGISTRY_NAME</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
</code></pre></div>
</li>
<li>
<p>Add your Docker registry with:</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">DOCKER_PASSWORD</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>hpvs<span class="w"> </span>registry<span class="w"> </span>add<span class="w"> </span><span class="se">\</span>
--name<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">REGISTRY_NAME</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>--dct<span class="w"> </span>https://notary.docker.io<span class="w"> </span><span class="se">\</span>
--url<span class="w"> </span>docker.io<span class="w"> </span>--user<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">DOCKER_USERNAME</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Enter<span class="w"> </span>Password:
</code></pre></div>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can ignore the <code>Enter Password:</code> prompt because the command does that for you with the <code>echo "${DOCKER_PASSWORD}" |</code> before the <code>hpvs registry add</code> command.</p>
</div>
</li>
<li>
<p>List your registered Docker registries again to confirm your registry has been added.</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>registry<span class="w"> </span>list
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+---------------+
<span class="p">|</span><span class="w"> </span>REGISTRY<span class="w"> </span>NAME<span class="w"> </span><span class="p">|</span>
+---------------+
<span class="p">|</span><span class="w"> </span>g_docker_hub<span class="w">  </span><span class="p">|</span>
+---------------+
</code></pre></div>
</details>
</li>
<li>
<p>Check the details of your added registry with</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>registry<span class="w"> </span>show<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">REGISTRY_NAME</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+------+--------------------------+
<span class="p">|</span><span class="w"> </span>name<span class="w"> </span><span class="p">|</span><span class="w"> </span>g_docker_hub<span class="w">             </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>user<span class="w"> </span><span class="p">|</span><span class="w"> </span>gmoney23<span class="w">                 </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>dct<span class="w">  </span><span class="p">|</span><span class="w"> </span>https://notary.docker.io<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>url<span class="w">  </span><span class="p">|</span><span class="w"> </span>docker.io<span class="w">                </span><span class="p">|</span>
+------+--------------------------+
</code></pre></div>
</details>
</li>
</ol>
<h2 id="securebuild-lab-securebuild-setup-create-directory-for-secure-build-lab-and-change-directory">Create directory for secure build lab and change directory<a class="headerlink" href="#securebuild-lab-securebuild-setup-create-directory-for-secure-build-lab-and-change-directory" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Set your secure build directory</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SB_DIR</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/securebuild-lab&quot;</span>
</code></pre></div>
</li>
<li>
<p>Save <code>SB_DIR</code> to <code>$HOME/.bashrc</code> for future shells (in case you open new terminals)</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export SB_DIR=&#39;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
</code></pre></div>
</li>
<li>
<p>Create <code>SB_DIR</code> and change into it</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</li>
</ol>
<h2 id="securebuild-lab-securebuild-setup-create-ssh-key-and-grant-github-access">Create SSH Key and Grant GitHub access<a class="headerlink" href="#securebuild-lab-securebuild-setup-create-ssh-key-and-grant-github-access" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This section goes through adding the <code>GitHub SSH Key</code> referenced in the <a href="#securebuild-lab-overview-fnref:2">key table</a> to your GitHub account to enable cloning GitHub repositories via SSH for secure builds.</p>
</div>
<ol>
<li>
<p>Create GitHub keys directory</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/github_keys&quot;</span>
</code></pre></div>
</li>
<li>
<p>Set <code>GITHUB_SSH_KEY</code> variable</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">GITHUB_SSH_KEY</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/github_keys/github_rsa&quot;</span>
</code></pre></div>
</li>
<li>
<p>Save <code>GITHUB_SSH_KEY</code> variable in <code>bashrc</code> for later use</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export GITHUB_SSH_KEY=&#39;</span><span class="si">${</span><span class="nv">GITHUB_SSH_KEY</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
</code></pre></div>
</li>
<li>
<p>Create public and private key for GitHub access</p>
<div class="highlight"><pre><span></span><code>ssh-keygen<span class="w"> </span>-t<span class="w"> </span>rsa<span class="w"> </span>-b<span class="w"> </span><span class="m">4096</span><span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GITHUB_SSH_KEY</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-N<span class="w"> </span><span class="s1">&#39;&#39;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Generating<span class="w"> </span>public/private<span class="w"> </span>rsa<span class="w"> </span>key<span class="w"> </span>pair.
Your<span class="w"> </span>identification<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>saved<span class="w"> </span><span class="k">in</span><span class="w"> </span>/home/multiarch-lab/securebuild-lab/github_keys/github_rsa.
Your<span class="w"> </span>public<span class="w"> </span>key<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>saved<span class="w"> </span><span class="k">in</span><span class="w"> </span>/home/multiarch-lab/securebuild-lab/github_keys/github_rsa.pub.
The<span class="w"> </span>key<span class="w"> </span>fingerprint<span class="w"> </span>is:
SHA256:sbEfCzwyOz/LaZ4jSeKT+Aw7IWUr7YT6m8Hxv9Dq90k<span class="w"> </span>multiarch-lab@ubuntu
The<span class="w"> </span>key<span class="err">&#39;</span>s<span class="w"> </span>randomart<span class="w"> </span>image<span class="w"> </span>is:
+---<span class="o">[</span>RSA<span class="w"> </span><span class="m">4096</span><span class="o">]</span>----+
<span class="p">|</span><span class="w">                 </span><span class="p">|</span>
<span class="p">|</span><span class="w">                 </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span>o<span class="w">        </span><span class="p">|</span>
<span class="p">|</span><span class="w">  </span>o<span class="w">    </span>.<span class="w"> </span><span class="o">=</span><span class="w">       </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span><span class="o">=</span>..<span class="w">  </span>o<span class="w"> </span>S<span class="w"> </span>.<span class="w">      </span><span class="p">|</span>
<span class="p">|</span>+.<span class="o">=</span>o...+<span class="w"> </span>+<span class="w"> </span>o<span class="w">     </span><span class="p">|</span>
<span class="p">|</span>.<span class="o">=</span>++o++.E<span class="w"> </span>o<span class="w">      </span><span class="p">|</span>
<span class="p">|</span>.<span class="w"> </span>+*+++<span class="o">=</span>++<span class="w">       </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>.<span class="o">===</span>oo*X+<span class="w">       </span><span class="p">|</span>
+----<span class="o">[</span>SHA256<span class="o">]</span>-----+
</code></pre></div>
</details>
</li>
<li>
<p>Cat GitHub public key to terminal</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GITHUB_SSH_KEY</span><span class="si">}</span><span class="s2">.pub&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>ssh-rsa<span class="w"> </span>AAAAB3NzaC1yc2EAAAADAQABAAACAQC6zsnjH4fXaR/imYkzRaYVgWsNVIY4LzCftygKGTFJVBDMqVErsbkvF810RUTPIIowwe7Bx2UGLtwv3kL2omUJaHjol/+nzQjdmFrV2qnZosMUCn4xSpdffCmMyFWE8FnWw1ZSc7STcTD/NFzLjrN/vbJgMvla0aSxsENio2RvyFQkMKbwfojE22Q/MOtJAg0wyr9/0JNXiAyLYUEwfi1qVoF4F1mvXgLtNgTSx4VzokUKBsiSaDDbEa70ik154dtWLY9nemUsrSfUluCrHLaJhUy9cg6Jc+/9tco0cZhyZDnLIhT/4+n1XGfZxb83c5WElrg/IEYHGOHfqp+lMfusMj/0ppopz+f66dWDabVQCbrkqa+yfbw0ItC0+sZ7opIYGRLt+OelkrIECo7utzCTxdCCJ+2iUIiBV14my7xAFR+fNLKzl9KD+FTT/QoUPlqTmUQNo6NFNGG15znWVRtMDOdDiA6fugl6RrFJHDpaw9/lh+7g7tqwHGF83ZomvvFdKFMsXY6JTpj6rb7gtKzEapB9imCr0aw0ZTWTdlzTs9ksSNr1gZRf/eiztP5puC4weGDRXVjPwHOFOGbUH7Wk8ywQAmUJdEg03bz01U1htYryiNTD4VD2QfVTmxTltocj/2yv7Apv6gQ+Gb0LsgTp2aWbAnbeWX7qfjpYt0j/iw<span class="o">==</span><span class="w"> </span>multiarch-lab@ubuntu
</code></pre></div>
</details>
</li>
<li>
<p>Copy <strong>your</strong> output (<strong>not</strong> the <code>Example Output</code> above) to the clipboard with <code>ctrl+c</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The above copy command (<code>ctrl+c</code>) is saving the <code>.pub</code> public key <strong>NOT</strong> the <code>private</code> key. You keep the private key and GitHub uses the public key to verify that it is communicating with the owner of the private key (i.e. you).</p>
</div>
</li>
<li>
<p>Add this key to your public GitHub at <a href="https://github.com/settings/ssh/new" target="_blank">https://github.com/settings/ssh/new</a></p>
<ol>
<li>
<p>Login or confirm your password if prompted</p>
<p><img alt="GitHub login page" src="../securebuild-lab/securebuild-setup_Images/GitHub_login_setup.png" /></p>
</li>
<li>
<p>Add SSH Key</p>
<p><img alt="Add GitHub SSH Key" src="../securebuild-lab/securebuild-setup_Images/Add_SSH_Key_GitHub.png" /></p>
</li>
<li>
<p>See your new SSH key has been added with your chosen title.</p>
<p><img alt="GitHub SSH Key Added" src="../securebuild-lab/securebuild-setup_Images/SSH_key_added_to_GitHub.png" /></p>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You created this <em>public</em> GitHub account in the <a href="#prerequisites-Create-a-GitHub" target="_blank">Prerequisites</a> (or already had one).</p>
</div>
</li>
<li>
<p>Scan for GitHub's public key (Done to trust GitHub connection the first time)</p>
<div class="highlight"><pre><span></span><code>ssh-keyscan<span class="w"> </span>-H<span class="w"> </span>github.com<span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.ssh/known_hosts&quot;</span>
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Example Output</p>
<div class="highlight"><pre><span></span><code><span class="c1"># github.com:22 SSH-2.0-babeld-4f04c79d</span>
<span class="c1"># github.com:22 SSH-2.0-babeld-4f04c79d</span>
<span class="c1"># github.com:22 SSH-2.0-babeld-4f04c79d</span>
</code></pre></div>
</div>
</li>
<li>
<p>Check that your GitHub key now has access to your account with:</p>
<div class="highlight"><pre><span></span><code>ssh<span class="w"> </span>-T<span class="w"> </span>git@github.com<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GITHUB_SSH_KEY</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Your key was added successfully</p>
<div class="highlight"><pre><span></span><code>Warning:<span class="w"> </span>Permanently<span class="w"> </span>added<span class="w"> </span>the<span class="w"> </span>RSA<span class="w"> </span>host<span class="w"> </span>key<span class="w"> </span><span class="k">for</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="s1">&#39;140.82.114.3&#39;</span><span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>known<span class="w"> </span>hosts.
Hi<span class="w"> </span>siler23!<span class="w"> </span>You<span class="err">&#39;</span>ve<span class="w"> </span>successfully<span class="w"> </span>authenticated,<span class="w"> </span>but<span class="w"> </span>GitHub<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>provide<span class="w"> </span>shell<span class="w"> </span>access.
</code></pre></div>
</div>
<div class="admonition failure">
<p class="admonition-title">Your key was <strong>NOT</strong> added <img alt="😞" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f61e.svg" title=":disappointed:" /> Please redo <a href="#securebuild-lab-securebuild-setup-create-ssh-key-and-grant-github-access">this section</a></p>
<div class="highlight"><pre><span></span><code>Warning:<span class="w"> </span>Permanently<span class="w"> </span>added<span class="w"> </span>the<span class="w"> </span>RSA<span class="w"> </span>host<span class="w"> </span>key<span class="w"> </span><span class="k">for</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="s1">&#39;140.82.113.3&#39;</span><span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>known<span class="w"> </span>hosts.
git@github.com:<span class="w"> </span>Permission<span class="w"> </span>denied<span class="w"> </span><span class="o">(</span>publickey<span class="o">)</span>.
</code></pre></div>
</div>
</li>
<li>
<p>Feel at ease knowing you will delete this key from your Github account in the cleanup phase of this lab so access will be revoked soon enough <img alt="☺" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/263a.svg" title=":relaxed:" /></p>
</li>
</ol></section><section class="print-page" id="securebuild-lab-create-server"><h1 id="securebuild-lab-create-server-create-your-hpvs-secure-build-server">Create your HPVS Secure Build Server<a class="headerlink" href="#securebuild-lab-create-server-create-your-hpvs-secure-build-server" title="Permanent link">&para;</a></h1>
<h2 id="securebuild-lab-create-server-export-variables-set-in-previous-sections-to-current-terminal-session">Export Variables set in previous sections to current terminal session<a class="headerlink" href="#securebuild-lab-create-server-export-variables-set-in-previous-sections-to-current-terminal-session" title="Permanent link">&para;</a></h2>
<p>Source <code>bashrc</code> to set necessary variables if unset</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
</code></pre></div>
<h2 id="securebuild-lab-create-server-set-your-provided-number-and-save-it-for-later-use">Set your provided number and save it for later use<a class="headerlink" href="#securebuild-lab-create-server-set-your-provided-number-and-save-it-for-later-use" title="Permanent link">&para;</a></h2>
<p>You will be assigned a number for the lab so as not to interfere with other users.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a href="#assignment" target="_blank">This table</a> tells you which number you are assigned.</p>
</div>
<ol>
<li>
<p>Set the <code>HPVS_NUMBER</code> variable with your assigned 2 digit number</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="securebuild-lab-create-server-__tabbed_1_1" name="securebuild-lab-create-server-__tabbed_1" type="radio" /><input id="securebuild-lab-create-server-__tabbed_1_2" name="securebuild-lab-create-server-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="securebuild-lab-create-server-__tabbed_1_1">Command Syntax</label><label for="securebuild-lab-create-server-__tabbed_1_2">Example Command</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">HPVS_NUMBER</span><span class="o">=</span><span class="s2">&quot;your_assigned_number&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">HPVS_NUMBER</span><span class="o">=</span><span class="s2">&quot;00&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Your user will <strong>NOT</strong> be <code>00</code>. Please set the appropriate user you have been assigned.</p>
</div>
</li>
<li>
<p>Save your number to <code>bashrc</code> for later use.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export HPVS_NUMBER=&#39;</span><span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
</code></pre></div>
</li>
<li>
<p>Set Secure Build Server Port</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SB_PORT</span><span class="o">=</span><span class="m">300</span><span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span>
</code></pre></div>
</li>
<li>
<p>Save <code>SB_PORT</code> to <code>bashrc</code> for later use.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export SB_PORT=&#39;</span><span class="si">${</span><span class="nv">SB_PORT</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
</code></pre></div>
</li>
</ol>
<h2 id="securebuild-lab-create-server-create-certificate-and-key-for-server-side-certificate-checking-in-tls">Create Certificate and Key for server-side certificate checking in TLS<a class="headerlink" href="#securebuild-lab-create-server-create-certificate-and-key-for-server-side-certificate-checking-in-tls" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>In this process you will create the <code>Secure Build Server Client Certificate and Key</code> referenced in the <a href="#securebuild-lab-overview-fnref:2">key table</a>. You will keep the private key on your Linux vm and pass the corresponding certificate to the secure build server you are deploying in this section. Then, whenever you interact with the secure build server to build your applications and get your manifest files it will check that your private key matches the public key of the certificate (i.e., server-side checking in mutual TLS) so that only you (or others / CI tools with the necessary private key) can access the server to perform secure build operations (<code>hpvs sb</code> commands) on it (i.e., build, log, status, manifest, etc.).</p>
</div>
<ol>
<li>
<p>Generate rand file</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>rand<span class="w"> </span>-out<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.rnd&quot;</span><span class="w"> </span>-hex<span class="w"> </span><span class="m">256</span>
</code></pre></div>
</li>
<li>
<p>Make <code>SB_DIR/sbs_keys</code> directory to store secure build server keys and switch to it.</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sbs_keys&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span>/sbs_keys
</code></pre></div>
</li>
<li>
<p>Create a private key that will be used by the Secure Build Server certification authority</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>genrsa<span class="w"> </span>-out<span class="w"> </span>ca.key<span class="w"> </span><span class="m">2048</span>
</code></pre></div>
</li>
<li>
<p>Create the Secure Build Server certification authority</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-x509<span class="w"> </span>-key<span class="w"> </span>ca.key<span class="w"> </span>-days<span class="w"> </span><span class="m">730</span><span class="w"> </span>-out<span class="w"> </span>ca.pem
</code></pre></div>
</li>
<li>
<p>Set environment variables that will be referenced in a configuration file used by subsequent openssl commands in the lab</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">COMMON_NAME</span><span class="o">=</span>server
<span class="nb">export</span><span class="w"> </span><span class="nv">PATHLEN</span><span class="o">=</span>CA:true
<span class="nb">export</span><span class="w"> </span><span class="nv">SUBJECT_ALT_NAME</span><span class="o">=</span>DNS:192.168.22.79:<span class="si">${</span><span class="nv">SB_PORT</span><span class="si">}</span>,IP:192.168.22.79
</code></pre></div>
</li>
<li>
<p>Create the configuration file which will be used by subsequent openssl commands in the lab</p>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">cat &lt;&lt; EOF &gt; ${SB_DIR}/sbs_keys/openssl.cnf</span>
<span class="l l-Scalar l-Scalar-Plain"># OpenSSL configuration file.</span>
<span class="l l-Scalar l-Scalar-Plain">#</span>

<span class="l l-Scalar l-Scalar-Plain"># Establish working directory.</span>

<span class="l l-Scalar l-Scalar-Plain">dir   = .</span>

<span class="l l-Scalar l-Scalar-Plain">[ ca ]</span>
<span class="l l-Scalar l-Scalar-Plain">default_ca  = CA_default</span>

<span class="l l-Scalar l-Scalar-Plain">[ CA_default ]</span>
<span class="l l-Scalar l-Scalar-Plain">serial   = \$dir/serial</span>
<span class="l l-Scalar l-Scalar-Plain">#database  = \${ENV::DIR}/index.txt</span>
<span class="l l-Scalar l-Scalar-Plain">#new_certs_dir  = \$dir/newcerts</span>
<span class="l l-Scalar l-Scalar-Plain">#private_key       = \$dir/ca.key</span>
<span class="l l-Scalar l-Scalar-Plain">#certificate       = \$dir/ca.cer</span>
<span class="l l-Scalar l-Scalar-Plain">default_days  = 730</span>
<span class="l l-Scalar l-Scalar-Plain">default_md  = sha256</span>
<span class="l l-Scalar l-Scalar-Plain">preserve  = no</span>
<span class="l l-Scalar l-Scalar-Plain">email_in_dn  = no</span>
<span class="l l-Scalar l-Scalar-Plain">nameopt   = default_ca</span>
<span class="l l-Scalar l-Scalar-Plain">certopt   = default_ca</span>
<span class="l l-Scalar l-Scalar-Plain">default_crl_days = 45</span>
<span class="l l-Scalar l-Scalar-Plain">policy   = policy_match</span>

<span class="l l-Scalar l-Scalar-Plain">[ policy_match ]</span>
<span class="l l-Scalar l-Scalar-Plain">countryName  = match</span>
<span class="l l-Scalar l-Scalar-Plain">stateOrProvinceName = optional</span>
<span class="l l-Scalar l-Scalar-Plain">organizationName = match</span>
<span class="l l-Scalar l-Scalar-Plain">organizationalUnitName = optional</span>
<span class="l l-Scalar l-Scalar-Plain">commonName  = supplied</span>
<span class="l l-Scalar l-Scalar-Plain">emailAddress  = optional</span>

<span class="l l-Scalar l-Scalar-Plain">[ req ]</span>
<span class="l l-Scalar l-Scalar-Plain">default_md  = sha256</span>
<span class="l l-Scalar l-Scalar-Plain">distinguished_name = req_distinguished_name</span>
<span class="l l-Scalar l-Scalar-Plain">prompt             = yes</span>

<span class="l l-Scalar l-Scalar-Plain">[ req_distinguished_name ]</span>
<span class="l l-Scalar l-Scalar-Plain">#countryName = Country</span>
<span class="l l-Scalar l-Scalar-Plain">#countryName_default = US</span>
<span class="l l-Scalar l-Scalar-Plain">#countryName_min = 2</span>
<span class="l l-Scalar l-Scalar-Plain">#countryName_max = 2</span>
<span class="l l-Scalar l-Scalar-Plain">#localityName = Locality</span>
<span class="l l-Scalar l-Scalar-Plain">#localityName_default = Los Angeles</span>
<span class="l l-Scalar l-Scalar-Plain">#organizationName = Organization</span>
<span class="l l-Scalar l-Scalar-Plain">#organizationName_default = IBM</span>
<span class="l l-Scalar l-Scalar-Plain">#commonName = Common Name</span>
<span class="l l-Scalar l-Scalar-Plain">#commonName_max = 64</span>

<span class="l l-Scalar l-Scalar-Plain">C  = US</span>
<span class="l l-Scalar l-Scalar-Plain">ST = California</span>
<span class="l l-Scalar l-Scalar-Plain">L  = Los Angeles</span>
<span class="l l-Scalar l-Scalar-Plain">O  = IBM</span>
<span class="l l-Scalar l-Scalar-Plain">CN = \${ENV::COMMON_NAME}</span>

<span class="l l-Scalar l-Scalar-Plain">[ certauth ]</span>
<span class="l l-Scalar l-Scalar-Plain">subjectKeyIdentifier = hash</span>
<span class="l l-Scalar l-Scalar-Plain">authorityKeyIdentifier = keyid:always,issuer:always</span>
<span class="l l-Scalar l-Scalar-Plain">keyUsage = digitalSignature, keyEncipherment, dataEncipherment, keyCertSign, cRLSign</span>
<span class="l l-Scalar l-Scalar-Plain">keyUsage = digitalSignature, keyEncipherment, dataEncipherment, keyCertSign, cRLSign</span>
<span class="l l-Scalar l-Scalar-Plain">basicConstraints = \${ENV::PATHLEN}</span>
<span class="l l-Scalar l-Scalar-Plain">#crlDistributionPoints = @crl</span>

<span class="l l-Scalar l-Scalar-Plain">[ server ]</span>
<span class="l l-Scalar l-Scalar-Plain">basicConstraints = CA:FALSE</span>
<span class="l l-Scalar l-Scalar-Plain">keyUsage = digitalSignature, keyEncipherment, dataEncipherment</span>
<span class="l l-Scalar l-Scalar-Plain">extendedKeyUsage = serverAuth</span>
<span class="l l-Scalar l-Scalar-Plain">nsCertType = server</span>
<span class="l l-Scalar l-Scalar-Plain">crlDistributionPoints = @crl</span>
<span class="l l-Scalar l-Scalar-Plain">subjectAltName = \${ENV::SUBJECT_ALT_NAME}</span>

<span class="l l-Scalar l-Scalar-Plain">[ client ]</span>
<span class="l l-Scalar l-Scalar-Plain">basicConstraints = CA:FALSE</span>
<span class="l l-Scalar l-Scalar-Plain">keyUsage = digitalSignature, keyEncipherment, dataEncipherment</span>
<span class="l l-Scalar l-Scalar-Plain">extendedKeyUsage = clientAuth,msSmartcardLogin</span>
<span class="l l-Scalar l-Scalar-Plain">nsCertType = client</span>
<span class="l l-Scalar l-Scalar-Plain">crlDistributionPoints = @crl</span>
<span class="l l-Scalar l-Scalar-Plain">authorityInfoAccess = @ocsp_section</span>
<span class="l l-Scalar l-Scalar-Plain">subjectAltName = @alt_names</span>

<span class="l l-Scalar l-Scalar-Plain">[ selfSignedServer ]</span>
<span class="l l-Scalar l-Scalar-Plain">subjectKeyIdentifier = hash</span>
<span class="l l-Scalar l-Scalar-Plain">authorityKeyIdentifier = keyid:always,issuer:always</span>
<span class="l l-Scalar l-Scalar-Plain">keyUsage = digitalSignature, keyEncipherment, dataEncipherment</span>
<span class="l l-Scalar l-Scalar-Plain">basicConstraints = CA:FALSE</span>
<span class="l l-Scalar l-Scalar-Plain">subjectAltName = \${ENV::SUBJECT_ALT_NAME}</span>
<span class="l l-Scalar l-Scalar-Plain">extendedKeyUsage = serverAuth</span>

<span class="l l-Scalar l-Scalar-Plain">[ selfSignedClient ]</span>
<span class="l l-Scalar l-Scalar-Plain">subjectKeyIdentifier = hash</span>
<span class="l l-Scalar l-Scalar-Plain">authorityKeyIdentifier = keyid:always,issuer:always</span>
<span class="l l-Scalar l-Scalar-Plain">keyUsage = digitalSignature, keyEncipherment, dataEncipherment</span>
<span class="l l-Scalar l-Scalar-Plain">basicConstraints = CA:FALSE</span>
<span class="l l-Scalar l-Scalar-Plain">subjectAltName = @alt_names</span>
<span class="l l-Scalar l-Scalar-Plain">extendedKeyUsage = clientAuth</span>

<span class="l l-Scalar l-Scalar-Plain">[ server_client ]</span>
<span class="l l-Scalar l-Scalar-Plain">subjectKeyIdentifier = hash</span>
<span class="l l-Scalar l-Scalar-Plain">keyUsage = digitalSignature, keyEncipherment, dataEncipherment</span>
<span class="l l-Scalar l-Scalar-Plain">basicConstraints = CA:FALSE</span>
<span class="l l-Scalar l-Scalar-Plain">subjectAltName = \${ENV::SUBJECT_ALT_NAME}</span>
<span class="l l-Scalar l-Scalar-Plain">crlDistributionPoints = @crl</span>
<span class="l l-Scalar l-Scalar-Plain">extendedKeyUsage = serverAuth,clientAuth</span>

<span class="l l-Scalar l-Scalar-Plain">[ v3_intermediate_ca ]</span>
<span class="l l-Scalar l-Scalar-Plain"># Extensions for a typical intermediate CA</span><span class="w"> </span>
<span class="l l-Scalar l-Scalar-Plain">subjectKeyIdentifier = hash</span>
<span class="l l-Scalar l-Scalar-Plain">authorityKeyIdentifier = keyid:always,issuer</span>
<span class="l l-Scalar l-Scalar-Plain">basicConstraints = critical, \${ENV::PATHLEN}</span>
<span class="l l-Scalar l-Scalar-Plain">keyUsage = critical, digitalSignature, cRLSign, keyCertSign</span>
<span class="l l-Scalar l-Scalar-Plain">crlDistributionPoints = @crl</span>
<span class="l l-Scalar l-Scalar-Plain">authorityInfoAccess = @ocsp_section</span>

<span class="l l-Scalar l-Scalar-Plain">[ crl ]</span>
<span class="l l-Scalar l-Scalar-Plain">URI=http://localhost/ca.crl</span>

<span class="l l-Scalar l-Scalar-Plain">[ ocsp_section ]</span>
<span class="l l-Scalar l-Scalar-Plain">OCSP;URI.0 = http://localhost:2560/ocsp</span>

<span class="l l-Scalar l-Scalar-Plain">[ ocsp ]</span>
<span class="l l-Scalar l-Scalar-Plain"># Extension for OCSP signing certificates</span><span class="w"> </span>
<span class="l l-Scalar l-Scalar-Plain">basicConstraints = CA:FALSE</span>
<span class="l l-Scalar l-Scalar-Plain">subjectKeyIdentifier = hash</span>
<span class="l l-Scalar l-Scalar-Plain">authorityKeyIdentifier = keyid,issuer</span>
<span class="l l-Scalar l-Scalar-Plain">keyUsage = critical, digitalSignature</span>
<span class="l l-Scalar l-Scalar-Plain">extendedKeyUsage = critical, OCSPSigning</span>

<span class="l l-Scalar l-Scalar-Plain">[alt_names]</span>
<span class="l l-Scalar l-Scalar-Plain"># email= \${ENV::SUBJECT_ALT_NAME}</span>
<span class="l l-Scalar l-Scalar-Plain">otherName=msUPN;UTF8:\${ENV::SUBJECT_ALT_NAME}</span>

<span class="l l-Scalar l-Scalar-Plain">[v3_conf]</span>
<span class="l l-Scalar l-Scalar-Plain">keyUsage = digitalSignature, keyEncipherment, dataEncipherment, keyCertSign, cRLSign</span>
<span class="l l-Scalar l-Scalar-Plain">basicConstraints = CA:FALSE</span>
<span class="l l-Scalar l-Scalar-Plain">EOF</span>
</code></pre></div>
</li>
<li>
<p>Create a private key that will be used by the Secure Build Server</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>genrsa<span class="w"> </span>-out<span class="w"> </span>server-key.pem<span class="w"> </span><span class="m">2048</span>
</code></pre></div>
</li>
<li>
<p>Create the Secure Build Server certificate signing request</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-key<span class="w"> </span>server-key.pem<span class="w"> </span>-out<span class="w"> </span>server.csr<span class="w">   </span>
</code></pre></div>
</li>
<li>
<p>Create the Secure Build Server certificate</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>x509<span class="w"> </span>-sha256<span class="w"> </span>-req<span class="w"> </span>-in<span class="w"> </span>server.csr<span class="w"> </span><span class="se">\</span>
-CA<span class="w"> </span>ca.pem<span class="w"> </span><span class="se">\</span>
-CAkey<span class="w"> </span>ca.key<span class="w"> </span><span class="se">\</span>
-set_serial<span class="w"> </span><span class="m">8086</span><span class="w"> </span>-extfile<span class="w"> </span>openssl.cnf<span class="w"> </span><span class="se">\</span>
-extensions<span class="w"> </span>server<span class="w"> </span>-days<span class="w"> </span><span class="m">730</span><span class="w"> </span>-outform<span class="w"> </span>PEM<span class="w"> </span><span class="se">\</span>
-out<span class="w"> </span>server.pem
</code></pre></div>
</li>
<li>
<p>Create a private key for use by the client certificate</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>genrsa<span class="w"> </span>-out<span class="w"> </span>client-key.pem<span class="w"> </span><span class="m">2048</span>
</code></pre></div>
</li>
<li>
<p>Create the client certificate signing request</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span><span class="se">\</span>
-key<span class="w"> </span>client-key.pem<span class="w"> </span><span class="se">\</span>
-out<span class="w"> </span>client.csr
</code></pre></div>
</li>
<li>
<p>Create the client certificate</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>x509<span class="w"> </span>-req<span class="w"> </span>-days<span class="w"> </span><span class="m">730</span><span class="w"> </span><span class="se">\</span>
-in<span class="w"> </span>client.csr<span class="w"> </span><span class="se">\</span>
-CA<span class="w"> </span>ca.pem<span class="w"> </span><span class="se">\</span>
-CAcreateserial<span class="w"> </span><span class="se">\</span>
-CAkey<span class="w"> </span>ca.key<span class="w"> </span><span class="se">\</span>
-out<span class="w"> </span>client_cert.pem
</code></pre></div>
</li>
<li>
<p>Create environment variables</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">ca_cert</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="k">$(</span>cat<span class="w"> </span>ca.pem<span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="k">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39; &#39;</span><span class="k">)</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">client_cert</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="k">$(</span>cat<span class="w"> </span>client_cert.pem<span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="k">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39; &#39;</span><span class="k">)</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">server_cert</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="k">$(</span>cat<span class="w"> </span>server.pem<span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="k">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39; &#39;</span><span class="k">)</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">server_key</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="k">$(</span>cat<span class="w"> </span>server-key.pem<span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="k">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39; &#39;</span><span class="k">)</span>
</code></pre></div>
</li>
<li>
<p>Switch back to main lab working directory</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span>
</code></pre></div>
<h2 id="securebuild-lab-create-server-create-quotagroup-with-storage-for-secure-build-server">Create Quotagroup with storage for secure build server<a class="headerlink" href="#securebuild-lab-create-server-create-quotagroup-with-storage-for-secure-build-server" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>quotagroup<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;sb_user</span><span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>--size<span class="o">=</span>40GB
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+-------------+--------------+
<span class="p">|</span><span class="w"> </span>PROPERTIES<span class="w">  </span><span class="p">|</span><span class="w"> </span>VALUES<span class="w">       </span><span class="p">|</span>
+-------------+--------------+
<span class="p">|</span><span class="w"> </span>Name<span class="w">        </span><span class="p">|</span><span class="w"> </span>sb_user00<span class="w">    </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Filesystem<span class="w">  </span><span class="p">|</span><span class="w"> </span>btrfs<span class="w">        </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Passthrough<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">        </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>PoolID<span class="w">      </span><span class="p">|</span><span class="w"> </span>lv_data_pool<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Size<span class="w">        </span><span class="p">|</span><span class="w"> </span><span class="m">40</span><span class="w"> </span>GB<span class="w">        </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Containers<span class="w">  </span><span class="p">|</span><span class="w">              </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Available<span class="w">   </span><span class="p">|</span><span class="w"> </span><span class="m">39</span><span class="w"> </span>GB<span class="w">        </span><span class="p">|</span>
+-------------+--------------+
</code></pre></div>
</details>
<h2 id="securebuild-lab-create-server-create-secure-build-server">Create Secure Build Server<a class="headerlink" href="#securebuild-lab-create-server-create-secure-build-server" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>vs<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>sbserver_<span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span><span class="w"> </span>--repo<span class="w"> </span>SecureDockerBuild<span class="w"> </span><span class="se">\</span>
--tag<span class="w"> </span><span class="m">1</span>.2.7.3<span class="w"> </span>--cpu<span class="w"> </span><span class="m">2</span><span class="w"> </span>--ram<span class="w"> </span><span class="m">2048</span><span class="w"> </span><span class="se">\</span>
--quotagroup<span class="w"> </span><span class="s2">&quot;{quotagroup = sb_user</span><span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span><span class="s2">, mountid = new, mount = /newroot, filesystem = ext4, size = 4GB, reset_root=true}&quot;</span><span class="w"> </span><span class="se">\</span>
--quotagroup<span class="w"> </span><span class="s2">&quot;{quotagroup = sb_user</span><span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span><span class="s2">, mountid = data, mount = /data, filesystem = ext4, size = 4GB}&quot;</span><span class="w"> </span><span class="se">\</span>
--quotagroup<span class="w"> </span><span class="s2">&quot;{quotagroup = sb_user</span><span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span><span class="s2">, mountid = docker, mount = /docker, filesystem = ext4, size = 16GB}&quot;</span><span class="w"> </span><span class="se">\</span>
--env<span class="o">={</span><span class="nv">EX_VOLUMES</span><span class="o">=</span><span class="s2">&quot;/docker,/data&quot;</span>,ROOTFS_LOCK<span class="o">=</span>y,CLIENT_CRT<span class="o">=</span><span class="nv">$client_cert</span>,CLIENT_CA<span class="o">=</span><span class="nv">$ca_cert</span>,SERVER_CRT<span class="o">=</span><span class="nv">$server_cert</span>,SERVER_KEY<span class="o">=</span><span class="nv">$server_key</span>,RUNQ_ROOTDISK<span class="o">=</span>new<span class="o">}</span><span class="w"> </span><span class="se">\</span>
--ports<span class="w"> </span><span class="s2">&quot;{containerport = 443, protocol = tcp, hostport = </span><span class="si">${</span><span class="nv">SB_PORT</span><span class="si">}</span><span class="s2">}&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+-------------+------------------------------+
<span class="p">|</span><span class="w"> </span>PROPERTIES<span class="w">  </span><span class="p">|</span><span class="w"> </span>VALUES<span class="w">                       </span><span class="p">|</span>
+-------------+------------------------------+
<span class="p">|</span><span class="w"> </span>Name<span class="w">        </span><span class="p">|</span><span class="w"> </span>sbserver_00<span class="w">                  </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>CPU<span class="w">         </span><span class="p">|</span><span class="w"> </span><span class="m">2</span><span class="w">                            </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Memory<span class="w">      </span><span class="p">|</span><span class="w"> </span><span class="m">2048</span><span class="w">                         </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>State<span class="w">       </span><span class="p">|</span><span class="w"> </span>running<span class="w">                      </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Status<span class="w">      </span><span class="p">|</span><span class="w"> </span>Up<span class="w"> </span>Less<span class="w"> </span>than<span class="w"> </span>a<span class="w"> </span>second<span class="w">        </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Networks<span class="w">    </span><span class="p">|</span><span class="w"> </span>Gateway:172.31.0.1<span class="w">           </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>IPAddress:172.31.0.2<span class="w">         </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>MacAddress:02:42:ac:1f:00:02<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>Network:bridge<span class="w">               </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>Subnet:16<span class="w">                    </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Ports<span class="w">       </span><span class="p">|</span><span class="w"> </span>GuestPort:30000<span class="w">              </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>LocalPort:443/tcp<span class="w">            </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Quotagroups<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">[</span>sb_user00<span class="o">]</span><span class="w">                  </span><span class="p">|</span>
+-------------+------------------------------+
</code></pre></div>
</details>
<p>We can see the quotagroup is now being used with</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>quotagroup<span class="w"> </span>show<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;sb_user</span><span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+-------------+-----------------------------+
<span class="p">|</span><span class="w"> </span>PROPERTIES<span class="w">  </span><span class="p">|</span><span class="w"> </span>VALUES<span class="w">                      </span><span class="p">|</span>
+-------------+-----------------------------+
<span class="p">|</span><span class="w"> </span>Name<span class="w">        </span><span class="p">|</span><span class="w"> </span>sb_user00<span class="w">                   </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Filesystem<span class="w">  </span><span class="p">|</span><span class="w"> </span>btrfs<span class="w">                       </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Passthrough<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">                       </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>PoolID<span class="w">      </span><span class="p">|</span><span class="w"> </span>lv_data_pool<span class="w">                </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Size<span class="w">        </span><span class="p">|</span><span class="w"> </span><span class="m">40</span><span class="w"> </span>GB<span class="w">                       </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Containers<span class="w">  </span><span class="p">|</span><span class="w"> </span>container_name:sbserver_00<span class="w">  </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>mount_ids:<span class="o">[</span>new<span class="w"> </span>data<span class="w"> </span>docker<span class="o">]</span><span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Available<span class="w">   </span><span class="p">|</span><span class="w"> </span><span class="m">11</span><span class="w"> </span>GB<span class="w">                       </span><span class="p">|</span>
+-------------+-----------------------------+
</code></pre></div>
</details>
<p>The show output for the Hyper Protect Virtual Server was shown when it was deployed but we can bring it back up with</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>vs<span class="w"> </span>show<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;sbserver_</span><span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+-------------+------------------------------+
<span class="p">|</span><span class="w"> </span>PROPERTIES<span class="w">  </span><span class="p">|</span><span class="w"> </span>VALUES<span class="w">                       </span><span class="p">|</span>
+-------------+------------------------------+
<span class="p">|</span><span class="w"> </span>Name<span class="w">        </span><span class="p">|</span><span class="w"> </span>sbserver_00<span class="w">                  </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>CPU<span class="w">         </span><span class="p">|</span><span class="w"> </span><span class="m">2</span><span class="w">                            </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Memory<span class="w">      </span><span class="p">|</span><span class="w"> </span><span class="m">2048</span><span class="w">                         </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>State<span class="w">       </span><span class="p">|</span><span class="w"> </span>running<span class="w">                      </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Status<span class="w">      </span><span class="p">|</span><span class="w"> </span>Up<span class="w"> </span><span class="m">2</span><span class="w"> </span>minutes<span class="w">                 </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Networks<span class="w">    </span><span class="p">|</span><span class="w"> </span>Gateway:172.31.0.1<span class="w">           </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>IPAddress:172.31.0.2<span class="w">         </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>MacAddress:02:42:ac:1f:00:02<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>Network:bridge<span class="w">               </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>Subnet:16<span class="w">                    </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Ports<span class="w">       </span><span class="p">|</span><span class="w"> </span>GuestPort:30000<span class="w">              </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>LocalPort:443/tcp<span class="w">            </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Quotagroups<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">[</span>sb_user00<span class="o">]</span><span class="w">                  </span><span class="p">|</span>
+-------------+------------------------------+
</code></pre></div>
</details>
<p>Your secure build server is now up and running! <img alt="🔥" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f525.svg" title=":fire:" /></p>
<p>It is available at the IP Address of the Hyper Protect Virtual Server LPAR and port (GuestPort) specified.</p>
<p>You will use this secure build server to securely build your application in the next section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can assign IP addresses and hostnames for containers as necessary for your purposes but using the docker network and host ports is a nice way to quickly get running without having to use up IP addresses on your network.</p>
</div></section><section class="print-page" id="securebuild-lab-build"><h1 id="securebuild-lab-build-securely-build-your-application">Securely Build your Application<a class="headerlink" href="#securebuild-lab-build-securely-build-your-application" title="Permanent link">&para;</a></h1>
<h2 id="securebuild-lab-build-export-variables-set-in-previous-sections-to-current-terminal-session">Export Variables set in previous sections to current terminal session<a class="headerlink" href="#securebuild-lab-build-export-variables-set-in-previous-sections-to-current-terminal-session" title="Permanent link">&para;</a></h2>
<p>Source <code>bashrc</code> to set necessary variables if unset</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
</code></pre></div>
<h2 id="securebuild-lab-build-create-repository-registration-gpg-signing-key">Create repository registration GPG signing key<a class="headerlink" href="#securebuild-lab-build-create-repository-registration-gpg-signing-key" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This section creates the <code>Repository Registration Signing Key</code> referenced in the <a href="#securebuild-lab-overview-fnref:2">key table</a>. <a href="https://gnupg.org/" target="_blank">The GNU Privacy Guard (GPG)</a> utility (a free implementation of the OpenPGP standard or PGP) generates this key pair (protected by a user defined password) and then exports the public and private keys to files in the <code>${SB_DIR}/registration_keys/</code> directory. Later, you will employ these keys to sign a registration file for your securely built image to register it with your Hyper Protect Virtual Servers appliance such that only the holder of the private key can change the registered repository on the Hyper Protect Virtual Servers appliance.</p>
</div>
<ol>
<li>
<p>Set key name</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">keyName</span><span class="o">=</span><span class="s2">&quot;secure_bitcoin_key</span><span class="si">${</span><span class="nv">RANDOM</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p><code>${RANDOM}</code> stores a pseudo-random number to use since GPG keys on a system must each have a unique key name (uid). This will make sure users can safely re-run commands for multiple runs if they so choose.</p>
</div>
</li>
<li>
<p>Set key passphrase</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="securebuild-lab-build-__tabbed_1_1" name="securebuild-lab-build-__tabbed_1" type="radio" /><input id="securebuild-lab-build-__tabbed_1_2" name="securebuild-lab-build-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="securebuild-lab-build-__tabbed_1_1">Command Syntax</label><label for="securebuild-lab-build-__tabbed_1_2">Example Command</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">passphrase</span><span class="o">=</span><span class="s2">&quot;your_passphrase&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">passphrase</span><span class="o">=</span><span class="s2">&quot;most_secure_pw_i_could_think_of&quot;</span>
</code></pre></div>
</div>
</div>
</div>
</li>
<li>
<p>Create directory to store Docker repository registration signing key material</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/registration_keys&quot;</span>
</code></pre></div>
</li>
<li>
<p>Create Key Definition</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/registration_keys/</span><span class="si">${</span><span class="nv">keyName</span><span class="si">}</span><span class="s2">_definition_keys&quot;</span><span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<span class="s">%echo Generating registration definition key</span>
<span class="s">Key-Type: RSA</span>
<span class="s">Key-Length: 4096</span>
<span class="s">Subkey-Type: RSA</span>
<span class="s">Subkey-Length: 4096</span>
<span class="s">Name-Real: ${keyName}</span>
<span class="s">Expire-Date: 0</span>
<span class="s">Passphrase: ${passphrase}</span>
<span class="s"># Do a commit here, so that we can later print &quot;done&quot; :-)</span>
<span class="s">%commit</span>
<span class="s">%echo done</span>
<span class="s">EOF</span>
</code></pre></div>
</li>
<li>
<p>Generate Key pair</p>
<div class="highlight"><pre><span></span><code>gpg<span class="w"> </span>--armor<span class="w"> </span>--batch<span class="w"> </span><span class="se">\</span>
--generate-key<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/registration_keys/</span><span class="si">${</span><span class="nv">keyName</span><span class="si">}</span><span class="s2">_definition_keys&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>gpg:<span class="w"> </span>directory<span class="w"> </span><span class="s1">&#39;/home/multiarch-lab/.gnupg&#39;</span><span class="w"> </span>created
gpg:<span class="w"> </span>keybox<span class="w"> </span><span class="s1">&#39;/home/multiarch-lab/.gnupg/pubring.kbx&#39;</span><span class="w"> </span>created
gpg:<span class="w"> </span>Generating<span class="w"> </span>registration<span class="w"> </span>definition<span class="w"> </span>key
gpg:<span class="w"> </span>/home/multiarch-lab/.gnupg/trustdb.gpg:<span class="w"> </span>trustdb<span class="w"> </span>created
gpg:<span class="w"> </span>key<span class="w"> </span>7E05CE05DFEBA2BC<span class="w"> </span>marked<span class="w"> </span>as<span class="w"> </span>ultimately<span class="w"> </span>trusted
gpg:<span class="w"> </span>directory<span class="w"> </span><span class="s1">&#39;/home/multiarch-lab/.gnupg/openpgp-revocs.d&#39;</span><span class="w"> </span>created
gpg:<span class="w"> </span>revocation<span class="w"> </span>certificate<span class="w"> </span>stored<span class="w"> </span>as<span class="w"> </span><span class="s1">&#39;/home/multiarch-lab/.gnupg/openpgp-revocs.d/27FB55DC5F7FDF0598C9B1007E05CE05DFEBA2BC.rev&#39;</span>
gpg:<span class="w"> </span><span class="k">done</span>
</code></pre></div>
</details>
</li>
<li>
<p>Export Private key</p>
<div class="highlight"><pre><span></span><code>gpg<span class="w"> </span>--armor<span class="w"> </span>--pinentry-mode<span class="o">=</span>loopback<span class="w"> </span>--passphrase<span class="w">  </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">passphrase</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
--export-secret-keys<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">keyName</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/registration_keys/</span><span class="si">${</span><span class="nv">keyName</span><span class="si">}</span><span class="s2">.private&quot;</span>
</code></pre></div>
</li>
<li>
<p>Export Public key</p>
<div class="highlight"><pre><span></span><code>gpg<span class="w"> </span>--armor<span class="w"> </span>--export<span class="w"> </span><span class="si">${</span><span class="nv">keyName</span><span class="si">}</span><span class="w"> </span>&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/registration_keys/</span><span class="si">${</span><span class="nv">keyName</span><span class="si">}</span><span class="s2">.pub&quot;</span>
</code></pre></div>
</li>
<li>
<p>List newly generated key files</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>ls<span class="w"> </span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span>/registration_keys/
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>secure_bitcoin_key7750_definition_keys<span class="w">  </span>secure_bitcoin_key7750.private<span class="w">  </span>secure_bitcoin_key7750.pub
</code></pre></div>
</details>
</li>
</ol>
<h2 id="securebuild-lab-build-set-build-configuration">Set Build Configuration<a class="headerlink" href="#securebuild-lab-build-set-build-configuration" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Set Secure Build Lab IP Address</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SB_IP</span><span class="o">=</span><span class="m">192</span>.168.22.79
</code></pre></div>
</li>
<li>
<p>Save Secure Build Lab IP Address for later use</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export SB_IP=&#39;</span><span class="si">${</span><span class="nv">SB_IP</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
</code></pre></div>
</li>
<li>
<p>Set Secure Build GitHub repository</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">GH_REPO</span><span class="o">=</span><span class="s2">&quot;git@github.com:ibm-wsc/secure-bitcoin-wallet.git&quot;</span>
</code></pre></div>
</li>
<li>
<p>Set Docker Image Name</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">IMAGE_NAME</span><span class="o">=</span><span class="s2">&quot;hpvs_bc&quot;</span>
</code></pre></div>
</li>
<li>
<p>Set repository registration name</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">REPO_ID</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">IMAGE_NAME</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</li>
<li>
<p>Save repository registration name for later use</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export REPO_ID=&#39;</span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
</code></pre></div>
</li>
<li>
<p>Create config file</p>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">cat &gt; &quot;${SB_DIR}/sb_config.yaml&quot; &lt;&lt;EOF</span>
<span class="l l-Scalar l-Scalar-Plain">secure_build_workers</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="nt">sbs</span><span class="p">:</span>
<span class="w">        </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;https://${SB_IP}&#39;</span>
<span class="w">        </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${SB_PORT}&#39;</span>
<span class="w">        </span><span class="nt">cert_path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${SB_DIR}/sbs_keys/client_cert.pem&#39;</span>
<span class="w">        </span><span class="nt">key_path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${SB_DIR}/sbs_keys/client-key.pem&#39;</span>
<span class="w">        </span><span class="nt">ca_cert_path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${SB_DIR}/sbs_keys/ca.pem&#39;</span>
<span class="w">    </span><span class="nt">regfile</span><span class="p">:</span>
<span class="w">        </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${REPO_ID}&#39;</span>
<span class="w">    </span><span class="nt">github</span><span class="p">:</span>
<span class="w">        </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${GH_REPO}&#39;</span>
<span class="w">        </span><span class="nt">branch</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;master&#39;</span>
<span class="w">        </span><span class="nt">ssh_private_key_path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${GITHUB_SSH_KEY}&#39;</span>
<span class="w">        </span><span class="nt">recurse_submodules</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span>
<span class="w">        </span><span class="nt">dockerfile_path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;./Dockerfile&#39;</span>
<span class="w">        </span><span class="nt">docker_build_path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;./&#39;</span>
<span class="w">    </span><span class="nt">docker</span><span class="p">:</span>
<span class="w">        </span><span class="nt">push_server</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${REGISTRY_NAME}&#39;</span>
<span class="w">        </span><span class="c1">#base_server: &#39;${REGISTRY_NAME}&#39;</span>
<span class="w">        </span><span class="nt">pull_server</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${REGISTRY_NAME}&#39;</span>
<span class="w">        </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${DOCKER_USERNAME}/${IMAGE_NAME}&#39;</span>
<span class="w">        </span><span class="nt">image_tag_prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;latest&#39;</span>
<span class="w">        </span><span class="nt">content_trust_base</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;False&#39;</span>
<span class="w">    </span><span class="c1">#env:</span>
<span class="w">    </span><span class="c1"># You would enter environment variables that you want to use in your application container in the whitelist array.</span>
<span class="w">    </span><span class="c1">#    whitelist: []</span>
<span class="w">    </span><span class="c1">#build:</span>
<span class="w">    </span><span class="c1"># You would enter build parameters such as build args you want to use in your application container</span>
<span class="w">    </span><span class="c1">#    args: { &#39;ARG1&#39; : &#39;VALUE1&#39; }</span>
<span class="w">    </span><span class="nt">signing_key</span><span class="p">:</span>
<span class="w">        </span><span class="nt">private_key_path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${SB_DIR}/registration_keys/${keyName}.private&#39;</span>
<span class="w">        </span><span class="nt">public_key_path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;${SB_DIR}/registration_keys/${keyName}.pub&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">EOF</span>
</code></pre></div>
</li>
<li>
<p>Continue to the <a href="#securebuild-lab-build-build-application">Build Application section</a> if you are launching secure build for the first time or the <a href="#securebuild-lab-build-troubleshooting-secure-build">Troubleshooting Secure Build section</a> if things didn't go as planned your first go-round and you are trying to get back on the right track.</p>
</li>
</ol>
<h2 id="securebuild-lab-build-build-application">Build Application<a class="headerlink" href="#securebuild-lab-build-build-application" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>In this section, you finally use all of your configuration information to build your application securely over TLS by connecting to the secure build server you deployed in the <a href="#securebuild-lab-create-server" target="_blank">previous part of the lab</a> with the <code>Secure Build Server Client Certificate and Key</code>. This build securely updates the application using <a href="https://docs.docker.com/engine/security/trust/content_trust/" target="_blank">Docker Content Trust</a>, an implementation of <a href="https://theupdateframework.io/overview/" target="_blank">The Update Framework</a>. This involves securely signing a series of <a href="https://theupdateframework.io/metadata/" target="_blank">metadata files</a> with corresponding keys (<code>Root Key</code>, <code>Image Signing "Targets" Key</code>, <code>Snapshot Key</code>, and <code>Timestamp Key</code> referenced in the <a href="#securebuild-lab-overview-fnref:2">key table</a>) and pushing this trust metadata to a <a href="https://docs.docker.com/notary/service_architecture/" target="_blank">Notary Server</a> to provide assurances regarding the integrity of the Docker Images when users pull them to run in their environments. This conforms to <a href="https://github.com/theupdateframework/specification/blob/master/tuf-spec.md#the-update-framework-specification" target="_blank">The Update Framework Specification</a></p>
<p>Additionally, this process generates a <code>Manifest Signing Key</code> which it employs to sign the contents of the build for attestation of the build contents by internal and/or third party auditors. The <code>Manifest Signing Key</code> is discussed in more detail in the <a href="#securebuild-lab-build-verify-your-application"><code>Verify your application section</code></a> later in the lab.</p>
</div>
<ol>
<li>
<p>Initialize Secure Build Hyper Protect Virtual Server with configuration file generated in the <a href="#securebuild-lab-build-set-build-configuration">Set Build Configuration section</a></p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>init<span class="w"> </span>--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span>
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Example Output</p>
<div class="highlight"><pre><span></span><code><span class="o">{</span><span class="s2">&quot;status&quot;</span>:<span class="s2">&quot;OK&quot;</span><span class="o">}</span>
</code></pre></div>
</div>
</li>
<li>
<p>Launch secure build with a timeout of 20 minutes to complete using the configuration file generated in the <a href="#securebuild-lab-build-set-build-configuration">Set Build Configuration section</a></p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>build<span class="w"> </span><span class="se">\</span>
--timeout<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="se">\</span>
--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The following build will take anywhere from <strong>15-20 minutes</strong> to complete. While this is ongoing, you should open a new tab in your terminal to check the automatically updating logs and build status (steps for doing this are detailed in the next few steps). If this command times out please check the status as in <code>step 4</code> to make sure nothing went wrong. It might just be that your build took too long and everything will be ok. If something did go wrong, visit the <a href="#securebuild-lab-build-troubleshooting-secure-build">Troubleshooting Secure Build section</a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The secure build is asynchronous so if the command gets interrupted here don't worry! <img alt="😁" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f601.svg" title=":grin:" /></p>
</div>
<details class="example" open="open">
<summary>Example Output after running 15-20 minutes to completion</summary>
<div class="highlight"><pre><span></span><code>+--------+-------------------------+
<span class="p">|</span><span class="w"> </span>status<span class="w"> </span><span class="p">|</span><span class="w"> </span>OK:<span class="w"> </span>async<span class="w"> </span>build<span class="w"> </span>started<span class="w"> </span><span class="p">|</span>
+--------+-------------------------+
<span class="c1">##############################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################</span>
+---------------------+--------------------------------------------------------------------------------------------+
<span class="p">|</span><span class="w"> </span>root_ssh_enabled<span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">                                                                                      </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>status<span class="w">              </span><span class="p">|</span><span class="w"> </span>success<span class="w">                                                                                    </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>build_name<span class="w">          </span><span class="p">|</span><span class="w"> </span>docker.io.gmoney23.hpvs_bc_a.latest-b3416d8.2020-06-23_22-12-54.183641<span class="w">                     </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>image_tag<span class="w">           </span><span class="p">|</span><span class="w"> </span>latest-b3416d8<span class="w">                                                                             </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>manifest_key_gen<span class="w">    </span><span class="p">|</span><span class="w"> </span>soft_crypto<span class="w">                                                                                </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>manifest_public_key<span class="w"> </span><span class="p">|</span><span class="w"> </span>manifest.docker.io.gmoney23.hpvs_bc_a.latest-b3416d8.2020-06-23_22-12-54.183641-public.pem<span class="w"> </span><span class="p">|</span>
+---------------------+--------------------------------------------------------------------------------------------+
</code></pre></div>
</details>
</li>
<li>
<p>Please look at the logs in another terminal window while the secure build is running (don't interrupt the current terminal window which is waiting for the secure build)</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>log<span class="w"> </span>--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Truncated Output</summary>
<div class="highlight"><pre><span></span><code>2020-06-23 05:25:42,453  root       INFO    starting a build
2020-06-23 05:25:42,454  root       INFO    cleaning up the local github repo and the github access credential
2020-06-23 05:25:42,454  root       INFO    github_dir=secure-bitcoin-wallet
2020-06-23 05:25:42,454  root       INFO    cloning a github repo
2020-06-23 05:25:42,454  root       INFO    github_host=github.com
2020-06-23 05:25:42,454  root       INFO    cmd=ssh-keyscan github.com
2020-06-23 05:25:47,659  root       INFO    # github.com:22 SSH-2.0-babeld-7c96ae41
# github.com:22 SSH-2.0-babeld-b6072416
# github.com:22 SSH-2.0-babeld-b6072416
github.com ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pL
.....
</code></pre></div>
</details>
</li>
<li>
<p>You can also look at the secure build status in another window. This can be useful if you accidentally interrupted the secure build command or it times out due to the timeout not being long enough. It will also fill out the additional fields that are initially blank when the build completes (such as <code>build_name</code> and <code>manifest_public_key</code>, etc.).</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>status<span class="w"> </span>--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+---------------------+---------------+
<span class="p">|</span><span class="w"> </span>build_name<span class="w">          </span><span class="p">|</span><span class="w">               </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>image_tag<span class="w">           </span><span class="p">|</span><span class="w">               </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>manifest_key_gen<span class="w">    </span><span class="p">|</span><span class="w">               </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>manifest_public_key<span class="w"> </span><span class="p">|</span><span class="w">               </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>root_ssh_enabled<span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">         </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>status<span class="w">              </span><span class="p">|</span><span class="w"> </span>github<span class="w"> </span>cloned<span class="w"> </span><span class="p">|</span>
+---------------------+---------------+
</code></pre></div>
</details>
<div class="admonition error">
<p class="admonition-title">If you see an error in your status</p>
<p>If you see that your build ran into an error please visit the <a href="#securebuild-lab-build-troubleshooting-secure-build">Troubleshooting Secure Build section</a></p>
</div>
</li>
<li>
<p>You can continue to check the logs to monitor the progress of your secure build with the previous logs command</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>log<span class="w"> </span>--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span>
</code></pre></div>
</li>
<li>
<p>When the secure build successfully completes, it will have ending logs similar to the following:</p>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code><span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:28,843<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span>run:<span class="w"> </span>latest:<span class="w"> </span>digest:<span class="w"> </span>sha256:45cd2d06a2ef978cf1ae60b58833689ff2af1aff0b3d6aa2e69ea83378f6f22d<span class="w"> </span>size:<span class="w"> </span><span class="m">5549</span>
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:28,843<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span>run:<span class="w"> </span>Signing<span class="w"> </span>and<span class="w"> </span>pushing<span class="w"> </span>trust<span class="w"> </span>metadata
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:29,656<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span>run:<span class="w"> </span>Successfully<span class="w"> </span>signed<span class="w"> </span>docker.io/gmoney23/hpvs_bc:latest
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:29,661<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span>run:<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nv">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:29,662<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span>extracting<span class="w"> </span>an<span class="w"> </span>image<span class="w"> </span>keyid<span class="w"> </span>and<span class="w"> </span>key
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:29,663<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span><span class="nv">keyid</span><span class="o">=</span>2092f4e8a72ab297e94a05c18a1ad5b558b9cdee3531018752cd23e238c02889
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:29,663<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span><span class="nv">publickey</span><span class="o">=</span>LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJrVENDQVRhZ0F3SUJBZ0lSQUlSUVpKVmR0QVJycGNnc1A3T0diRVF3Q2dZSUtvWkl6ajBFQXdJd0xqRXMKTUNvR0ExVUVBd3dqWkc5amEyVnlMbWx2TDNOcGJHeHBiV0Z1TDJod2RuTmZZbU5mTWpBeU1qQTBNall3SGhjTgpNakl3TkRJMk1UZ3dPVEkwV2hjTk16SXdOREl6TVRnd09USTBXakF1TVN3d0tnWURWUVFERENOa2IyTnJaWEl1CmFXOHZjMmxzYkdsdFlXNHZhSEIyYzE5aVkxOHlNREl5TURReU5qQlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDkKQXdFSEEwSUFCSUhqM1RLaDZPYmp4Z214allOZ3ZDSGlDSTNOOTlBZy8vS0lPc0hxR25SYUR6NU5LbEdMWktvOAoxaDRYaUgwRG92d1ZFMGUvdlZzM3V3dnlwT0JEYzNtak5UQXpNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WCkhTVUVEREFLQmdnckJnRUZCUWNEQXpBTUJnTlZIUk1CQWY4RUFqQUFNQW9HQ0NxR1NNNDlCQU1DQTBrQU1FWUMKSVFEU2o4SzcvVDhRSWFLbVoyaEdSTTZnTkRsRE01L21UcUdQK09qc3NwWS9jZ0loQU43ZDM5RXlITkV3bFRUMApkMC9XaVcwejRCMWdMM1RyQVhFRDlwVUhoMVR5Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:29,663<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span>generating<span class="w"> </span>a<span class="w"> </span>config<span class="w"> </span>file
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:29,664<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span>create_and_push:<span class="w"> </span>SoftCrypto
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:30,627<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span><span class="nv">digest</span><span class="o">=</span>7b997311130b0b0984e1b7cabd45e7b4a5461337d52dcb1b99be26849d7172d9
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:30,627<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span><span class="nv">block_size</span><span class="o">=</span><span class="m">64</span>
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:30,648<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span><span class="nv">digest</span><span class="o">=</span>7b997311130b0b0984e1b7cabd45e7b4a5461337d52dcb1b99be26849d7172d9
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:30,650<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span><span class="nv">signature</span><span class="o">=</span>4e6b43530773245b8c04e016e8b112cfa8efab6621b84c9825d06c7fa7faba525c8cc97618313205bf46db123d8f53ca2377871b3daa6dec62e48fc539fd17c9796f5c395bd1a82b05e60d69796fea1baa7fb48b4f9ae0cd72c329121241b2e4f7a21d8bc6456fa921df2ab9b9a47974bfb841c540ff1bd9e9e350e9f9d1c5f4da3bef0857e3f21605e1131f4b6ca0a12db33ae57149e37718ef8e54b978769cbf8cf025d32323f1f488df6db9ffd6ec22ebad7daa67e99c3506b47bdefc0ebe3d0fe76edc6d19d38283a355f9d94eab20c3e3d32cdd6b5ae8f8e0f4748ffbfec10661f7aad9dbc3dd5017e42f4468f7ef5443303c694761d6ff8646382fda14
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:30,650<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span><span class="nv">verify</span><span class="o">=</span>OK
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:31,049<span class="w">  </span>root<span class="w">       </span>WARNING<span class="w"> </span>undefined<span class="w"> </span>MANIFEST_BUCKET_NAME
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:31,049<span class="w">  </span>root<span class="w">       </span>WARNING<span class="w"> </span>skipping<span class="w"> </span>transferring<span class="w"> </span>a<span class="w"> </span>manifest<span class="w"> </span>to<span class="w"> </span>COS
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:31,049<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span>cleaning<span class="w"> </span>up<span class="w"> </span>the<span class="w"> </span>build<span class="w"> </span>environment
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:31,049<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span><span class="nv">github_dir</span><span class="o">=</span>secure-bitcoin-wallet
<span class="m">2022</span>-04-26<span class="w"> </span><span class="m">18</span>:09:31,110<span class="w">  </span>root<span class="w">       </span>INFO<span class="w">    </span>completed<span class="w"> </span>a<span class="w"> </span>build
</code></pre></div>
</details>
</li>
<li>
<p>When the secure build successfully completes, you can check the status again to see a status of <code>success</code>.</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>status<span class="w"> </span>--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+---------------------+---------------------------------------------------------------------------------------------------+
<span class="p">|</span><span class="w"> </span>manifest_public_key<span class="w"> </span><span class="p">|</span><span class="w"> </span>manifest.docker.io.gmoney23.hpvs_bc.latest-941893e.2022-04-26_18-09-29.663558-public.pem<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>root_ssh_enabled<span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">                                                                                    </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>status<span class="w">              </span><span class="p">|</span><span class="w"> </span>success<span class="w">                                                                                  </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>build_name<span class="w">          </span><span class="p">|</span><span class="w"> </span>docker.io.gmoney23.hpvs_bc.latest-941893e.2022-04-26_18-09-29.663558<span class="w">                     </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>image_tag<span class="w">           </span><span class="p">|</span><span class="w"> </span>latest-941893e<span class="w">                                                                           </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>manifest_key_gen<span class="w">    </span><span class="p">|</span><span class="w"> </span>soft_crypto<span class="w">                                                                              </span><span class="p">|</span>
+---------------------+------------------------------------------------------------------------------------------+
</code></pre></div>
</details>
<div class="admonition error">
<p class="admonition-title">If you see an error in your status</p>
<p>If you see that your build ran into an error please visit the <a href="#securebuild-lab-build-troubleshooting-secure-build">Troubleshooting Secure Build section</a></p>
</div>
</li>
<li>
<p>From the original terminal window, where you ran <code>hpvs sb init</code>, output the repository registration file.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">passphrase</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>hpvs<span class="w"> </span>sb<span class="w"> </span>regfile<span class="w"> </span><span class="se">\</span>
--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span><span class="w"> </span><span class="se">\</span>
--out<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/yaml.</span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="s2">.enc&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>Enter<span class="w"> </span>Signing<span class="w"> </span>Private<span class="w"> </span>key<span class="w"> </span>passphrase:
</code></pre></div>
</details>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <code>echo</code> command takes care of the passphrase so you don't need to enter it manually.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you run this command from a terminal window where you did not set the <code>passphrase</code> environment variable you will get an error saying <code>openpgp: invalid data: private key checksum failure</code>. You can also check to make sure you are in the right terminal window by running <code>echo "${passphrase}"</code> and the output should be the passphrase you set in the beginning of the "Create repository registration GPG signing key" section.</p>
</div>
</li>
</ol>
<h2 id="securebuild-lab-build-troubleshooting-secure-build">Troubleshooting Secure Build<a class="headerlink" href="#securebuild-lab-build-troubleshooting-secure-build" title="Permanent link">&para;</a></h2>
<details open="open">
<summary>Troubleshooting Instructions</summary>
<p>If your build completed successfully, feel free to <a href="#securebuild-lab-build-verify-your-application">SKIP this section</a> <img alt="😄" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f604.svg" title=":smile:" /></p>
<div class="admonition error">
<p class="admonition-title">If your build failed continue for instructions on how to find the happy path yet again.</p>
<p>If at any point you see an error in the status command you will need to restart your build with the following steps.</p>
<ol>
<li>If the secure build command is still running in its own window please interrupt it with <code>ctrl + c</code></li>
<li>Check the logs for more error information using:
    <div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>log<span class="w"> </span>--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span>
</code></pre></div></li>
<li>Correct whatever information was incorrect and go back through the steps in the <a href="#securebuild-lab-build-set-build-configuration">Set Build Configuration section</a></li>
<li>Clean up the data (i.e. logs) from the old build with:
    <div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>clean<span class="w"> </span>--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span>
</code></pre></div></li>
<li>Update the secure build server with the new configuration
    <div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>update<span class="w"> </span>--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span>
</code></pre></div></li>
<li>Continue onward like you just initialized your build server (You did ... just for another time <img alt="😁" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f601.svg" title=":grin:" />) at <code>Step 2</code> in the <a href="#securebuild-lab-build-build-application">Build Application Section</a></li>
</ol>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The next command you should run will be <code>hpvs sb build</code> (<code>Step 2</code> in the <a href="#securebuild-lab-build-build-application">Build Application Section</a>)</p>
</div>
</div>
</details>
<h2 id="securebuild-lab-build-verify-your-application">Verify your application<a class="headerlink" href="#securebuild-lab-build-verify-your-application" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>On the secure build server, the <code>.tbz</code> manifest file was hashed and then signed by the <code>Manifest Signing Key</code> referenced in the <a href="#securebuild-lab-overview-fnref:2">key table</a> which only exists on the server (inside its secure environment). In steps 1-11 below, you are using the matching public key you will receive from the secure build server (using a secure TLS connection) in <code>step 4</code> to "undo" this signature to reveal the original hash of the file. We then compare this hash to the hash of the file we have using the <code>verify</code> command in <code>step 11</code>. <code>Verification OK</code> means they are the same, implying that the <code>.tbz</code> file we have now was the same one that was signed by the manifest private key inside the safe confines of the secure build server.</p>
</div>
<ol>
<li>
<p>Create directories for your manifest file information and change into your new <code>manifest</code> directory.</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/manifest/manifest_files&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/manifest&quot;</span>
</code></pre></div>
</li>
<li>
<p>Save the build name from the status command as a variable</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">BUILD_NAME</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>hpvs<span class="w"> </span>sb<span class="w"> </span>status<span class="w"> </span>--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>build_name<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-ow<span class="w"> </span><span class="s1">&#39;docker.*[[:digit:]]&#39;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BUILD_NAME</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>docker.io.gmoney23.hpvs_bc.latest-941893e.2022-04-26_18-09-29.663558
</code></pre></div>
</details>
</li>
<li>
<p>Get your application manifest</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>manifest<span class="w"> </span>--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span><span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BUILD_NAME</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</li>
<li>
<p>Get your manifest public verification key</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>sb<span class="w"> </span>pubkey<span class="w"> </span>--config<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/sb_config.yaml&quot;</span><span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BUILD_NAME</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Connections to the secure build server are secured using mutual TLS. This means that proper certificates and keys have to be used on the client side to access these files (as well as when doing the previous secure build commands). This adds a layer of security to make sure that the <code>public key</code> and <code>manifest files</code> are authentic and securely distributed.</p>
</div>
</li>
<li>
<p>Check that your application manifest and signing key were retrieved</p>
<div class="highlight"><pre><span></span><code>ls
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>docker.io.gmoney23.hpvs_bc.latest-941893e.2022-04-26_18-09-29.663558-public.pem
manifest.docker.io.gmoney23.hpvs_bc.latest-941893e.2022-04-26_18-09-29.663558.sig.tbz
manifest_files
</code></pre></div>
</details>
</li>
<li>
<p>Set <code>MANIFEST</code> to point to your manifest files.</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">MANIFEST</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/manifest/manifest.</span><span class="si">${</span><span class="nv">BUILD_NAME</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</li>
<li>
<p>Set <code>MAN_PUBKEY</code> to point to your manifest public key.</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">MAN_PUBKEY</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/manifest/</span><span class="si">${</span><span class="nv">BUILD_NAME</span><span class="si">}</span><span class="s2">-public.pem&quot;</span>
</code></pre></div>
</li>
<li>
<p>Untar and unzip the manifest <code>.sig.tbz</code> file to reveal the <code>.sig</code> and <code>.tbz</code> files (and remove the original <code>.sig.tbz</code>)</p>
<div class="highlight"><pre><span></span><code>tar<span class="w"> </span>-xjvf<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MANIFEST</span><span class="si">}</span><span class="s2">.sig.tbz&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MANIFEST</span><span class="si">}</span><span class="s2">.sig.tbz&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>manifest.docker.io.gmoney23.hpvs_bc.latest-941893e.2022-04-26_18-09-29.663558.tbz
manifest.docker.io.gmoney23.hpvs_bc.latest-941893e.2022-04-26_18-09-29.663558.sig
</code></pre></div>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>.sig.tbz</code> was a tarball compressed using bzip2 compression of both a nested <code>.tbz</code> file (containing the manifest files) and a <code>.sig</code> file containing a signature of the nested <code>.tbz</code> to verify it with the public key retrieved using the <code>hpvs sb pubkey</code> command above saved in the file referenced by <code>MAN_PUBKEY</code>.</p>
</div>
</li>
<li>
<p>Convert the signature file to binary format</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MANIFEST</span><span class="si">}</span><span class="s2">.sig&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>xxd<span class="w"> </span>-r<span class="w"> </span>-p<span class="w"> </span>&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MANIFEST</span><span class="si">}</span><span class="s2">.sig.bin&quot;</span>
</code></pre></div>
</li>
<li>
<p>Hash (<code>SHA256</code>) the manifest <code>.tbz</code> file (containing the manifest files)</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>dgst<span class="w"> </span>-sha256<span class="w"> </span>-binary<span class="w"> </span>-out<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MANIFEST</span><span class="si">}</span><span class="s2">.tbz.sha256&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MANIFEST</span><span class="si">}</span><span class="s2">.tbz&quot;</span>
</code></pre></div>
</li>
<li>
<p>Verify that the <code>.tbz</code> manifest package was the one signed on the secure build server.</p>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>dgst<span class="w"> </span>-sha256<span class="w"> </span>-verify<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MAN_PUBKEY</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
-signature<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MANIFEST</span><span class="si">}</span><span class="s2">.sig.bin&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MANIFEST</span><span class="si">}</span><span class="s2">.tbz.sha256&quot;</span>
</code></pre></div>
<details class="success" open="open">
<summary>Success</summary>
<div class="highlight"><pre><span></span><code>Verified<span class="w"> </span>OK
</code></pre></div>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this case, we are double hashing the <code>.tbz</code> file on the signature side which is why we hash the <code>.tbz</code> before the verify command here.</p>
</div>
</li>
<li>
<p>Untar and unzip the manifest <code>.tbz</code> file into the <code>manifest_files</code> directory.</p>
<div class="highlight"><pre><span></span><code>tar<span class="w"> </span>-xjf<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MANIFEST</span><span class="si">}</span><span class="s2">.tbz&quot;</span><span class="w"> </span>-C<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/manifest/manifest_files&quot;</span>
</code></pre></div>
</li>
<li>
<p>Change into the <code>manifest_files</code> directory with your manifest files and view the files in the directory.</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/manifest/manifest_files&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>ls
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>data<span class="w">  </span>git<span class="w">  </span>root_ssh
</code></pre></div>
</details>
<div class="admonition info">
<p class="admonition-title">Manifest explanation</p>
<p>This <code>manifest</code> package contains three directories as shown above. The <code>data</code> directory contains the <code>build.json</code> (containing the build status of the directory updated after the image was pushed to its Docker Registry) and <code>build.log</code> (containing the logs from the secure build). The <code>git</code> directory contains the source code used for the build (cloned from git). Finally, the <code>root_ssh</code> directory contains any <code>ssh</code> material provided (if the user chose to use ssh) which is empty for us because we didn't enable ssh and provide ssh keys. This way no one can ssh into our secure build container.</p>
</div>
</li>
<li>
<p>What does this give me?</p>
<p>This gives you a way to see the collection of files used for your build at the time of the build and signed by the manifest private key which is secured in your secure build container. By retrieving the public key and verifying the signature of the package we <em>and auditors</em> can verify what was used for our secure image build. (Since the private key was generated in the secure build server we can trust it). This gives us verification of what was used in the build as well as the verification of the images themselves we get from <a href="https://docs.docker.com/engine/security/trust/content_trust/" target="_blank">Docker Content Trust</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The secure build server also generates the keys for Docker Content Trust and stores them safely to provide a secure root of trust.</p>
<p><em>Remember the secure build server is running as a Hyper Protect Virtual Server and thus inherits all of the security features and assurances of Hyper Protect Virtual Servers.</em></p>
</div>
</li>
</ol>
<h2 id="securebuild-lab-build-summary">Summary<a class="headerlink" href="#securebuild-lab-build-summary" title="Permanent link">&para;</a></h2>
<p>Congratulations!!! <img alt="🎉" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f389.svg" title=":tada:" /></p>
<p>You have securely built your application and are ready to deploy it into a Hyper Protect Virtual Server in the next section.</p></section><section class="print-page" id="securebuild-lab-deploy-app"><h1 id="securebuild-lab-deploy-app-deploy-your-securely-built-application-as-a-hyper-protect-virtual-server">Deploy your Securely Built Application as a Hyper Protect Virtual Server<a class="headerlink" href="#securebuild-lab-deploy-app-deploy-your-securely-built-application-as-a-hyper-protect-virtual-server" title="Permanent link">&para;</a></h1>
<h2 id="securebuild-lab-deploy-app-export-variables-set-in-previous-sections-to-current-terminal-session">Export Variables set in previous sections to current terminal session<a class="headerlink" href="#securebuild-lab-deploy-app-export-variables-set-in-previous-sections-to-current-terminal-session" title="Permanent link">&para;</a></h2>
<p>Source <code>bashrc</code> to set necessary variables if unset</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
</code></pre></div>
<h2 id="securebuild-lab-deploy-app-set-up-your-docker-image-repository">Set up your Docker Image Repository<a class="headerlink" href="#securebuild-lab-deploy-app-set-up-your-docker-image-repository" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Register your repository</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>repository<span class="w"> </span>register<span class="w"> </span><span class="se">\</span>
--pgp<span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">/yaml.</span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="s2">.enc&quot;</span><span class="w"> </span><span class="se">\</span>
--id<span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+-----------------+------------------------------+
<span class="p">|</span><span class="w"> </span>repository<span class="w"> </span>name<span class="w"> </span><span class="p">|</span><span class="w"> </span>docker.io/gmoney23/hpvs_bc_a<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>runtime<span class="w">         </span><span class="p">|</span><span class="w"> </span>runq<span class="w">                         </span><span class="p">|</span>
+-----------------+------------------------------+
</code></pre></div>
</details>
</li>
<li>
<p>View your newly registered repository</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>repository<span class="w"> </span>show<span class="w"> </span>--id<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+-----------------+------------------------------+
<span class="p">|</span><span class="w"> </span>repository<span class="w"> </span>name<span class="w"> </span><span class="p">|</span><span class="w"> </span>docker.io/gmoney23/hpvs_bc_a<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>runtime<span class="w">         </span><span class="p">|</span><span class="w"> </span>runq<span class="w">                         </span><span class="p">|</span>
+-----------------+------------------------------+
</code></pre></div>
</details>
</li>
</ol>
<h2 id="securebuild-lab-deploy-app-set-up-your-quotagroup-for-storage">Set up your Quotagroup for storage<a class="headerlink" href="#securebuild-lab-deploy-app-set-up-your-quotagroup-for-storage" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Create Quotagroup</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>quotagroup<span class="w"> </span>create<span class="w"> </span>--name<span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>--size<span class="o">=</span>5GB
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+-------------+---------------------+
<span class="p">|</span><span class="w"> </span>PROPERTIES<span class="w">  </span><span class="p">|</span><span class="w"> </span>VALUES<span class="w">              </span><span class="p">|</span>
+-------------+---------------------+
<span class="p">|</span><span class="w"> </span>Name<span class="w">        </span><span class="p">|</span><span class="w"> </span>hpvs_bc_a_00<span class="w">        </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Filesystem<span class="w">  </span><span class="p">|</span><span class="w"> </span>btrfs<span class="w">               </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Passthrough<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">               </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>PoolID<span class="w">      </span><span class="p">|</span><span class="w"> </span>lv_data_pool<span class="w">        </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Size<span class="w">        </span><span class="p">|</span><span class="w"> </span><span class="m">5</span><span class="w"> </span>GB<span class="w">                </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Containers<span class="w">  </span><span class="p">|</span><span class="w">                     </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Available<span class="w">   </span><span class="p">|</span><span class="w"> </span><span class="m">4</span><span class="w"> </span>GB<span class="w">                </span><span class="p">|</span>
+-------------+---------------------+
</code></pre></div>
</details>
</li>
<li>
<p>View your newly created quotagroup</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>quotagroup<span class="w"> </span>show<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+-------------+---------------------+
<span class="p">|</span><span class="w"> </span>PROPERTIES<span class="w">  </span><span class="p">|</span><span class="w"> </span>VALUES<span class="w">              </span><span class="p">|</span>
+-------------+---------------------+
<span class="p">|</span><span class="w"> </span>Name<span class="w">        </span><span class="p">|</span><span class="w"> </span>hpvs_bc_a_00<span class="w">        </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Filesystem<span class="w">  </span><span class="p">|</span><span class="w"> </span>btrfs<span class="w">               </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Passthrough<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nb">false</span><span class="w">               </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>PoolID<span class="w">      </span><span class="p">|</span><span class="w"> </span>lv_data_pool<span class="w">        </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Size<span class="w">        </span><span class="p">|</span><span class="w"> </span><span class="m">5</span><span class="w"> </span>GB<span class="w">                </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Containers<span class="w">  </span><span class="p">|</span><span class="w">                     </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Available<span class="w">   </span><span class="p">|</span><span class="w"> </span><span class="m">4</span><span class="w"> </span>GB<span class="w">                </span><span class="p">|</span>
+-------------+---------------------+
</code></pre></div>
</details>
</li>
</ol>
<h2 id="securebuild-lab-deploy-app-deploy-your-application">Deploy your Application<a class="headerlink" href="#securebuild-lab-deploy-app-deploy-your-application" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Set App port</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">APP_PORT</span><span class="o">=</span><span class="m">301</span><span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span>
</code></pre></div>
</li>
<li>
<p>Create your Hyper Protect Virtual Server</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>vs<span class="w"> </span>create<span class="w"> </span>--name<span class="o">=</span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="w"> </span>--repo<span class="w"> </span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
--tag<span class="w"> </span>latest<span class="w"> </span>--cpu<span class="w"> </span><span class="m">2</span><span class="w"> </span>--ram<span class="w"> </span><span class="m">2048</span><span class="w"> </span><span class="se">\</span>
--quotagroup<span class="w"> </span><span class="s2">&quot;{quotagroup = </span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="s2">, mountid = new, mount = /newroot, filesystem = btrfs, size = 4GB}&quot;</span><span class="w"> </span><span class="se">\</span>
--ports<span class="w"> </span><span class="s2">&quot;{containerport = 443, protocol = tcp, hostport = </span><span class="si">${</span><span class="nv">APP_PORT</span><span class="si">}</span><span class="s2">}&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+-------------+------------------------------+
<span class="p">|</span><span class="w"> </span>PROPERTIES<span class="w">  </span><span class="p">|</span><span class="w"> </span>VALUES<span class="w">                       </span><span class="p">|</span>
+-------------+------------------------------+
<span class="p">|</span><span class="w"> </span>Name<span class="w">        </span><span class="p">|</span><span class="w"> </span>hpvs_bc_a_00<span class="w">                 </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>CPU<span class="w">         </span><span class="p">|</span><span class="w"> </span><span class="m">2</span><span class="w">                            </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Memory<span class="w">      </span><span class="p">|</span><span class="w"> </span><span class="m">2048</span><span class="w">                         </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>State<span class="w">       </span><span class="p">|</span><span class="w"> </span>running<span class="w">                      </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Status<span class="w">      </span><span class="p">|</span><span class="w"> </span>Up<span class="w"> </span>Less<span class="w"> </span>than<span class="w"> </span>a<span class="w"> </span>second<span class="w">        </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Networks<span class="w">    </span><span class="p">|</span><span class="w"> </span>Gateway:172.31.0.1<span class="w">           </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>IPAddress:172.31.0.6<span class="w">         </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>MacAddress:02:42:ac:1f:00:06<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>Network:bridge<span class="w">               </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>Subnet:16<span class="w">                    </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Ports<span class="w">       </span><span class="p">|</span><span class="w"> </span>GuestPort:30100<span class="w">              </span><span class="p">|</span>
<span class="p">|</span><span class="w">             </span><span class="p">|</span><span class="w"> </span>LocalPort:443/tcp<span class="w">            </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>Quotagroups<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">[</span>hpvs_bc_a_00<span class="o">]</span><span class="w">               </span><span class="p">|</span>
+-------------+------------------------------+
</code></pre></div>
</details>
</li>
<li>
<p>Check on the Quotagroup (and see the application is indeed using it)</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>quotagroup<span class="w"> </span>show<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+-------------+------------------------------------+
| PROPERTIES  | VALUES                             |
+-------------+------------------------------------+
| Name        | hpvs_bc_a_00                       |
| Filesystem  | btrfs                              |
| Passthrough | false                              |
| PoolID      | lv_data_pool                       |
| Size        | 5 GB                               |
| Containers  | container_name:hpvs_a_00           |
|             | mount_ids:[new]                    |
| Available   | 751 MB                             |
+-------------+------------------------------------+
</code></pre></div>
</details>
<p>We can see the Hyper Protect Virtual Server for our application is now taking up the majority of our Quotagroup.</p>
</li>
<li>
<p>If you ever need to check the Hyper Protect Virtual Server you can use the show command</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>vs<span class="w"> </span>show<span class="w"> </span>--name<span class="o">=</span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+-------------+------------------------------+
| PROPERTIES  | VALUES                       |
+-------------+------------------------------+
| Name        | hpvs_bc_a_00                 |
| CPU         | 2                            |
| Memory      | 2048                         |
| State       | running                      |
| Status      | Up 5 minutes                 |
| Networks    | IPAddress:172.31.0.6         |
|             | MacAddress:02:42:ac:1f:00:06 |
|             | Network:bridge               |
|             | Subnet:16                    |
|             | Gateway:172.31.0.1           |
| Ports       | GuestPort:30100              |
|             | LocalPort:443/tcp            |
| Quotagroups | [hpvs_bc_a_00]               |
+-------------+------------------------------+
</code></pre></div>
</details>
</li>
</ol>
<h2 id="securebuild-lab-deploy-app-access-your-application">Access your application<a class="headerlink" href="#securebuild-lab-deploy-app-access-your-application" title="Permanent link">&para;</a></h2>
<p>Run the following command to print the address for your electrum wallet application:</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;https://</span><span class="si">${</span><span class="nv">SB_IP</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">APP_PORT</span><span class="si">}</span><span class="s2">/electrum&quot;</span>
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>https://192.168.22.79:30100/electrum
</code></pre></div>
</details>
<p>Your app is now up and running at the address printed in your terminal!</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can visit the IP address easily by right-clicking on the link (wih the line under it) in your terminal and selecting <code>Open Link</code>
<img alt="Open Link" src="../securebuild-lab/Bitcoin_Wallet_Images/Open_Link.png" /></p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This application uses self-signed certificates so don't worry about the certificate warning you'll need to accept in your browser. Just click <code>Advanced</code> and then <code>Accept the Risk and Continue</code> <img alt="😄" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f604.svg" title=":smile:" />
<img alt="Accept Risk" src="../securebuild-lab/Bitcoin_Wallet_Images/Accept_SelfSigned_Cert.png" /></p>
</div>
<p>In the final part of this lab you will use your newly built application...</p></section><section class="print-page" id="securebuild-lab-bitcoin_wallet"><h1 id="securebuild-lab-bitcoin_wallet-welcome-to-the-secure-bitcoin-wallet-on-ibm-linuxone">Welcome to the Secure Bitcoin Wallet on IBM LinuxONE<a class="headerlink" href="#securebuild-lab-bitcoin_wallet-welcome-to-the-secure-bitcoin-wallet-on-ibm-linuxone" title="Permanent link">&para;</a></h1>
<h2 id="securebuild-lab-bitcoin_wallet-overview">Overview<a class="headerlink" href="#securebuild-lab-bitcoin_wallet-overview" title="Permanent link">&para;</a></h2>
<p>This application is a secure <a href="https://electrum.org/#home" target="_blank">Electrum</a> Bitcoin wallet found at <a href="https://github.com/IBM/secure-bitcoin-wallet" target="_blank">this GitHub repository</a>. You can use it to store the identities necessary to transact on the Bitcoin public blockchain network. While this version of the wallet is just a proof of concept, running this type of wallet on Hyper Protect enables you to protect your digital assets from bad actors such as malicious server administrators.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This Electrum Bitcoin wallet functions regularly, while inheriting the security benefits of the Hyper Protect Virtual Server platform. This ensures that a legitimate version of the application is running (Secure Image Build process) and that administrators cannot compromise the application (Hyper Protect Virtual Server deployment).</p>
</div>
<h2 id="securebuild-lab-bitcoin_wallet-account-registration">Account Registration<a class="headerlink" href="#securebuild-lab-bitcoin_wallet-account-registration" title="Permanent link">&para;</a></h2>
<p>Registering a fake account for lab purposes.</p>
<ol>
<li>
<p>Choose <code>Register</code> since you won't have an existing account on the newly deployed server.</p>
<p><img alt="Secure Bitcoin Wallet Welcome" src="../securebuild-lab/Bitcoin_Wallet_Images/Bitcoin_Wallet_Homepage.png" /></p>
</li>
<li>
<p>Enter the registration details you desire.</p>
<p><img alt="User Registration" src="../securebuild-lab/Bitcoin_Wallet_Images/Wallet_register_info.png" /></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Do not worry about the information you enter on the registration page shown above as it won't map to anything. You just need your password to log back in if you log out of the application.</p>
</div>
</li>
</ol>
<h2 id="securebuild-lab-bitcoin_wallet-wallet-initialization">Wallet initialization<a class="headerlink" href="#securebuild-lab-bitcoin_wallet-wallet-initialization" title="Permanent link">&para;</a></h2>
<p>It's time to set up your Secure Electrum Bitcoin wallet itself! <img alt="⚡" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/26a1.svg" title=":zap:" /></p>
<ol>
<li>
<p>Bring up the wallet screen</p>
<p><img alt="Wallet Start" src="../securebuild-lab/Bitcoin_Wallet_Images/Click_Wallet_Start.png" /></p>
</li>
<li>
<p>Enter in a <code>password</code> for your wallet and click <code>Create Wallet</code></p>
<p><img alt="Create Wallet" src="../securebuild-lab/Bitcoin_Wallet_Images/Create_Wallet.png" /></p>
</li>
<li>
<p>Load your newly created wallet to enable it</p>
<p><img alt="Load Wallet" src="../securebuild-lab/Bitcoin_Wallet_Images/Load_Wallet.png" /></p>
</li>
<li>
<p>Reload the page.</p>
<p><img alt="Initialized Wallet" src="../securebuild-lab/Bitcoin_Wallet_Images/Reload_new_wallet.png" /></p>
</li>
<li>
<p>Your wallet is ready for use in all of its glory <img alt="👼" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f47c.svg" title=":angel:" /></p>
<p><img alt="Locked and Loaded Wallet" src="../securebuild-lab/Bitcoin_Wallet_Images/Loaded_Wallet_Time.png" /></p>
</li>
</ol>
<h2 id="securebuild-lab-bitcoin_wallet-receiving-bitcoins">Receiving Bitcoins<a class="headerlink" href="#securebuild-lab-bitcoin_wallet-receiving-bitcoins" title="Permanent link">&para;</a></h2>
<p>A wallet without currency is blasphemy, so it's time to fill it on up with fake bitcoins.</p>
<ol>
<li>
<p>Go to the <code>Receive</code> section of the wallet and get the bitcoin wallet address.  </p>
<p><img alt="Wallet receiving bitcoin" src="../securebuild-lab/Bitcoin_Wallet_Images/Receiving_bitcoin.png" /></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This is the address whose allotted bitcoins you lay claim to.</p>
</div>
</li>
<li>
<p>Open <a href="https://coinfaucet.eu/en/btc-testnet/" target="_blank">this bitcoin test faucet site</a> [click on the link] and use it to transfer bitcoin value to the <code>Receiving address</code> in your wallet <strong>from step 1 above</strong>.</p>
<p><img alt="Transfer Bitcoins" src="../securebuild-lab/Bitcoin_Wallet_Images/Send_bitcoins_to_wallet.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Instead of transacting on the "real" bitcoin blockchain network, we are using a <a href="https://medium.com/myetherwallet/understanding-blockchain-changes-testnets-and-mainnets-c2171a8e835f" target="_blank">testnet</a>. This means that the network participants agree that the assets on the network have no value. Testnets are used for testing changes to the network, testing applications and introducing new users to the technical aspects of network. There are testnets for many of the public blockchain networks including of course bitcoin and ethereum. Test faucets (like the one we are using) act as distributors of tokens to other users on the testnet.</p>
</div>
</li>
<li>
<p>Switch back to your wallet tab and go to the <code>History</code> section and then reload the page.</p>
<p><img alt="Check History" src="../securebuild-lab/Bitcoin_Wallet_Images/Check_History_Receive_Transaction.png" /></p>
</li>
<li>
<p>You should now see your wallet address as the recipient of a <code>pending transaction</code> from the bitcoin testnet faucet.</p>
<p><img alt="First Transaction History" src="../securebuild-lab/Bitcoin_Wallet_Images/Transaction_History_no_confirmations.png" /></p>
</li>
<li>
<p>After clicking for more information you get a detailed transaction overview</p>
<p><img alt="Receive Transaction 0 Confirmations" src="../securebuild-lab/Bitcoin_Wallet_Images/0_confirmations_block_details.png" /></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The number of <a href="https://en.bitcoin.it/wiki/Confirmation" target="_blank">confirmations</a> a block receives is the number of blocks deep the block that has included the blockchain transaction is. In other words, <code>1 confirmation</code> means that the current head block includes the transaction. <code>2 confirmations</code> means that the current head block's parent block contains the transaction and so on. The deeper the transaction is (more confirmations it has) the more mining power it would take to "reverse history" and undo the transaction.</p>
</div>
<p>Since there are <code>0 confirmations</code> in the picture above, it means that the transaction is not yet included in a block. This is why it has no timestamp yet and its block number is listed as <code>0</code>.</p>
</li>
<li>
<p>After waiting anywhere from a minute to a few minutes (depending on the current testnet traffic) you should see a confirmation on your transaction.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You will need to keep reloading the page for it to update. It doesn't update automatically.</p>
</div>
<p><img alt="1 Confirmation Received" src="../securebuild-lab/Bitcoin_Wallet_Images/1_Confirmation_Received.png" /></p>
<p>There is now a timestamp and a block number! <img alt="💵" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f4b5.svg" title=":dollar:" /></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>As time passes more confirmations will accumulate. You can check on the <code>confirmations</code> again at the end of the lab to show yourself this (Given enough time has passed for one or more additional confirmation(s) to occur).</p>
</div>
</li>
</ol>
<h2 id="securebuild-lab-bitcoin_wallet-returning-bitcoins">Returning Bitcoins<a class="headerlink" href="#securebuild-lab-bitcoin_wallet-returning-bitcoins" title="Permanent link">&para;</a></h2>
<p>Since you are feeling charitable you decide to transfer your testnet value back to the faucet's address.</p>
<ol>
<li>
<p>Go back to <a href="https://bitcoinfaucet.uo1.net/send.php" target="_blank">the faucet site</a> and get its bitcoin address</p>
<p><img alt="Faucet Address" src="../securebuild-lab/Bitcoin_Wallet_Images/testnet_faucet_address.png" /></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This address is here for easy copy and paste (ensure this matches what the application shows in the browser before using this, as the bitcoin address they use for returning funds changes occasionally):</p>
<div class="highlight"><pre><span></span><code>tb1ql7w62elx9ucw4pj5lgw4l028hmuw80sndtntxt
</code></pre></div>
</div>
</li>
<li>
<p>Send bitcoins to faucet using <code>Send</code> section of wallet</p>
<p><img alt="Send Bitcoins to Faucet" src="../securebuild-lab/Bitcoin_Wallet_Images/Send_bitcoins_back_to_faucet.png" /></p>
</li>
<li>
<p>Once sent you will see the <code>Signed transaction</code> information filled out on your wallet page.</p>
<p><img alt="Bitcoins Sent Back to Faucet" src="../securebuild-lab/Bitcoin_Wallet_Images/bitcoin_send_transaction_output.png" /></p>
</li>
<li>
<p>You can go back to the <a href="https://bitcoinfaucet.uo1.net/send.php" target="_blank">bitcoin faucet site</a> and see the transaction as green there with a sender of your address and a transaction ID matching the one you sent.</p>
<p><img alt="Bitcoins returned to faucet" src="../securebuild-lab/Bitcoin_Wallet_Images/transaction_giving_coins_back_to_faucet.png" /></p>
</li>
<li>
<p>You can view both the initial received transaction and the newly sent transaction in the <code>History</code> tab of your bitcoin wallet.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You have to keep reloading the page for it to update with new confirmations.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>If you wait long enough, eventually these transactions will gain confirmations as in the picture below</p>
</div>
<p><img alt="Both transactions with 1 confirmation" src="../securebuild-lab/Bitcoin_Wallet_Images/both_confirmed_transactions.png" /></p>
</li>
<li>
<p>You can continue to play around with the electrum wallet before moving on.</p>
</li>
</ol>
<h2 id="securebuild-lab-bitcoin_wallet-summary">Summary<a class="headerlink" href="#securebuild-lab-bitcoin_wallet-summary" title="Permanent link">&para;</a></h2>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>You have participated in the bitcoin testnet using a securely built electrum bitcoin wallet powered by a Hyper Protect Virtual Server. Congratulations!!! </p>
</div>
<p><img alt="🚀" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/1f680.svg" title=":rocket:" /></p>
<p>Now, it's time to clean up...</p></section><section class="print-page" id="securebuild-lab-cleanup"><h1 id="securebuild-lab-cleanup-clean-up-your-environment">Clean up your Environment<a class="headerlink" href="#securebuild-lab-cleanup-clean-up-your-environment" title="Permanent link">&para;</a></h1>
<h2 id="securebuild-lab-cleanup-export-variables-set-in-previous-sections-to-current-terminal-session">Export Variables set in previous sections to current terminal session<a class="headerlink" href="#securebuild-lab-cleanup-export-variables-set-in-previous-sections-to-current-terminal-session" title="Permanent link">&para;</a></h2>
<p>Source <code>bashrc</code> to set necessary variables if unset</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
</code></pre></div>
<h2 id="securebuild-lab-cleanup-clean-up-secure-build-server">Clean up Secure Build Server<a class="headerlink" href="#securebuild-lab-cleanup-clean-up-secure-build-server" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Clean up virtual server</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>vs<span class="w"> </span>delete<span class="w"> </span>--name<span class="w"> </span>sbserver_<span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span>
</code></pre></div>
</li>
<li>
<p>Clean up Quotagroup</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>quotagroup<span class="w"> </span>delete<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;sb_user</span><span class="si">${</span><span class="nv">HPVS_NUMBER</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</li>
</ol>
<h2 id="securebuild-lab-cleanup-clean-up-application">Clean up Application<a class="headerlink" href="#securebuild-lab-cleanup-clean-up-application" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Clean up HPVS deployment</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>vs<span class="w"> </span>delete<span class="w"> </span>--name<span class="w"> </span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span>
</code></pre></div>
</li>
<li>
<p>Clean up Quotagroup</p>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>quotagroup<span class="w"> </span>delete<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</li>
</ol>
<h2 id="securebuild-lab-cleanup-clean-up-repository">Clean up Repository<a class="headerlink" href="#securebuild-lab-cleanup-clean-up-repository" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>hpvs<span class="w"> </span>repository<span class="w">  </span>delete<span class="w"> </span>--id<span class="w"> </span><span class="si">${</span><span class="nv">REPO_ID</span><span class="si">}</span><span class="w"> </span>--force
</code></pre></div>
<details class="example" open="open">
<summary>Example Output</summary>
<div class="highlight"><pre><span></span><code>+-------------------+-------------------------------------+
<span class="p">|</span><span class="w"> </span>ContainersDeleted<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">[]</span><span class="w">                                  </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>ImagesDeleted<span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="o">[</span>gmoney23/hpvs_bc_a:latest<span class="o">]</span><span class="w">         </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>RepositoryDeleted<span class="w"> </span><span class="p">|</span><span class="w"> </span>docker.io/gmoney23/hpvs_bc_a<span class="w">        </span><span class="p">|</span>
+-------------------+-------------------------------------+
</code></pre></div>
</details>
<h2 id="securebuild-lab-cleanup-clean-up-docker-token">Clean up Docker Token<a class="headerlink" href="#securebuild-lab-cleanup-clean-up-docker-token" title="Permanent link">&para;</a></h2>
<p>Delete the existing Docker Token by logging into your <code>Docker Hub</code> account and following <a href="https://docs.docker.com/docker-hub/access-tokens/#modify-existing-tokens" target="_blank">these instructions</a></p>
<h2 id="securebuild-lab-cleanup-clean-up-github-ssh-key">Clean up GitHub ssh key<a class="headerlink" href="#securebuild-lab-cleanup-clean-up-github-ssh-key" title="Permanent link">&para;</a></h2>
<p>Delete the ssh key you added for the lab following steps 1-3 of <a href="https://help.github.com/en/github/authenticating-to-github/reviewing-your-ssh-keys" target="_blank">these instructions</a>. Stay logged in to GitHub as the next section also deals with your GitHub account. </p>
<h2 id="securebuild-lab-cleanup-clean-up-github-personal-access-token">Clean up GitHub personal access token<a class="headerlink" href="#securebuild-lab-cleanup-clean-up-github-personal-access-token" title="Permanent link">&para;</a></h2>
<p>You should still be logged in to GitHub from the previous step.  Click on your picture or avatar for your account and navigate to <em>Settings-&gt;Developer Settings-&gt;Personal access tokens</em> and delete the personal access token that you created for this lab. Ask an instructor for help if you have difficulty deleting this.</p>
<h2 id="securebuild-lab-cleanup-clean-up-lab-directory">Clean up Lab directory<a class="headerlink" href="#securebuild-lab-cleanup-clean-up-lab-directory" title="Permanent link">&para;</a></h2>
<p>You can remove the directory you stored your files in throughout the lab. This is a personal choice as the lab machine will be deleted after the lab anyway.</p>
<div class="highlight"><pre><span></span><code>rm<span class="w"> </span>-rf<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SB_DIR</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></section><h1 class='nav-section-title-end'>Ended: Secure Image Build Lab</h1><section class="print-page" id="glossary"><h1 id="glossary-glossary">Glossary<a class="headerlink" href="#glossary-glossary" title="Permanent link">&para;</a></h1>
<p>This glossary of terms consolidates the terms for the Hyper Protect Virtual Servers offering in alphabetical order to help both customers and internal team members to understand our offering better.</p>
<h2 id="glossary-appliance">Appliance<a class="headerlink" href="#glossary-appliance" title="Permanent link">&para;</a></h2>
<p>IBM Secure Service Container based appliance provided by an Appliance Vendor. From Hosting Appliance perspective, it is the combination of IBM Secure Service Container and the Hyper Protect Servers Hosting Appliance.</p>
<h2 id="glossary-appliance-administrator">Appliance Administrator<a class="headerlink" href="#glossary-appliance-administrator" title="Permanent link">&para;</a></h2>
<p>The person administrating an appliance which includes tasks, such as configuring storage, or memory to the appliance or performing other configuration tasks through the API provided by SSC/the Hosting Appliance.</p>
<h2 id="glossary-appliance-operational-data">Appliance Operational Data<a class="headerlink" href="#glossary-appliance-operational-data" title="Permanent link">&para;</a></h2>
<p>Metrics, logs, appliance dump data, error logs, stack traces, kernel dump, etc.</p>
<h2 id="glossary-appliance-protected-data">Appliance Protected Data<a class="headerlink" href="#glossary-appliance-protected-data" title="Permanent link">&para;</a></h2>
<p>Appliance secrets, workload data, configuration data, settings, and other internal information stored by an appliance.</p>
<h2 id="glossary-appliance-vendor">Appliance Vendor<a class="headerlink" href="#glossary-appliance-vendor" title="Permanent link">&para;</a></h2>
<p>An internal, or external exploiter of SSC, packaging SSC into an appliance.</p>
<h2 id="glossary-byok">BYOK<a class="headerlink" href="#glossary-byok" title="Permanent link">&para;</a></h2>
<p>The abbreviation of Bring Your Own Key, which allows you to import your existing keys to Hyper Protect Crypto Services service instances that protect your keys with advanced encryption.</p>
<h2 id="glossary-byoi">BYOI<a class="headerlink" href="#glossary-byoi" title="Permanent link">&para;</a></h2>
<p>The abbreviation of Bring Your Own Image, which is a part of the IBM Hyper Protect Virtual Servers solution to support the development and deployment of your own container images on top of the Secure Service Container framework.</p>
<h2 id="glossary-container">Container<a class="headerlink" href="#glossary-container" title="Permanent link">&para;</a></h2>
<p>A runtime instance of an Open Container Image (OCI) image.</p>
<h2 id="glossary-crypto-administrator">Crypto administrator<a class="headerlink" href="#glossary-crypto-administrator" title="Permanent link">&para;</a></h2>
<p>The person who signs commands that are issued to the crypto units. Multiple administrators can be added to one crypto unit to increase security.</p>
<h2 id="glossary-crypto-units">Crypto units<a class="headerlink" href="#glossary-crypto-units" title="Permanent link">&para;</a></h2>
<p>A single unit that represents a hardware security module and the corresponding software stack that is dedicated to the hardware security module for cryptography.</p>
<h2 id="glossary-data-encryption-keys">Data encryption keys<a class="headerlink" href="#glossary-data-encryption-keys" title="Permanent link">&para;</a></h2>
<p>A cryptographic key used to encrypt data that is stored in an application.</p>
<h2 id="glossary-datapool">Datapool<a class="headerlink" href="#glossary-datapool" title="Permanent link">&para;</a></h2>
<p>Synonyms for Storage Pool.</p>
<h2 id="glossary-docker-content-trust">Docker Content Trust<a class="headerlink" href="#glossary-docker-content-trust" title="Permanent link">&para;</a></h2>
<p>Docker Content Trust (DCT) is a feature in the Docker containerization platform that provides the ability to use digital signatures for data sent to and received from remote Docker registries. These signatures allow client-side or runtime verification of the integrity and publisher of specific image tags.</p>
<p>Through DCT, image publishers can sign their images and image consumers can ensure that the images they pull are signed. Publishers could be individuals or organizations manually signing their content or automated software supply chains signing content as part of their release process.</p>
<h2 id="glossary-docker-registry">Docker registry<a class="headerlink" href="#glossary-docker-registry" title="Permanent link">&para;</a></h2>
<p>A Docker registry is a storage and content delivery system, holding named Docker images, available in different tagged versions.</p>
<h2 id="glossary-ep11">EP11<a class="headerlink" href="#glossary-ep11" title="Permanent link">&para;</a></h2>
<p>The abbreviation of Enterprise PKCS #11, which is specifically designed for customers seeking support for open standards and enhanced security. The EP11 library provides an interface very similar to the industry-standard PKCS #11 API.</p>
<h2 id="glossary-envelope-encryption">Envelope encryption<a class="headerlink" href="#glossary-envelope-encryption" title="Permanent link">&para;</a></h2>
<p>The process of encrypting data with a data encryption key and then encrypting the key with a root key that can be fully managed.</p>
<h2 id="glossary-fips-140-2-compliance">FIPS 140-2 compliance<a class="headerlink" href="#glossary-fips-140-2-compliance" title="Permanent link">&para;</a></h2>
<p>An organization’s adherence to the Federal Information Processing Standards (FIPS) 140-2 standards. This standard specifies the security requirements that will be satisfied by a cryptographic module utilized within a security system protecting sensitive information.  FIPS 140-2 outlines four levels of security: </p>
<p>Level 1 - the lowest level of security. It covers the basic security features in a cryptographic module.</p>
<p>Level 2 - improves the physical security aspects of cryptographic modules. Examples of required physical security             measures are tamper-evident coatings, seals, or pick-resistant locks. Role-based authentication is included in this security level and ensures the operator accessing the module is authorized and is limited to their assigned actions. </p>
<p>Level 3 - requires enhanced physical security, potentially with products available from the private sector. A multi-chip embedded module has to be contained in a strong enclosure that zeroizes critical security parameters when it is removed. This security level also uses identity-based authentication. </p>
<p>Level 4 - requires tamper detection circuits to be able to detect any device penetration. This level is best for when cryptographic modules are in a physically unprotected environment that intruders can access. Modules must be able to detect fluctuations and zeroize themselves. Level 4 also protects against security compromises due to environmental conditions.</p>
<h2 id="glossary-fips-197-compliance">FIPS 197 compliance<a class="headerlink" href="#glossary-fips-197-compliance" title="Permanent link">&para;</a></h2>
<p>An organization’s adherence to Federal Information Processing Standards (FIPS) 197 which is an algorithmic standard that addresses the Advanced Encryption Standard (AES). AES specifies a FIPS-approved cryptographic algorithm that can be used to protect electronic data. The AES algorithm is a symmetric block cipher that can encrypt and decrypt information.</p>
<h2 id="glossary-gpg">GPG<a class="headerlink" href="#glossary-gpg" title="Permanent link">&para;</a></h2>
<p>The abbreviation of Gnu Privacy Guard, which is an open standard used for signing, encrypting, and decrypting texts with public and private keys to increase the security of communications.</p>
<h2 id="glossary-grep11">GREP11<a class="headerlink" href="#glossary-grep11" title="Permanent link">&para;</a></h2>
<p>Represents Enterprise PKCS #11 (EP11) APIs over gRPC calls, which is designed to be a stateless interface for cryptographic operations on cloud.</p>
<h2 id="glossary-grpc">gRPC<a class="headerlink" href="#glossary-grpc" title="Permanent link">&para;</a></h2>
<p>A modern open source high performance remote procedure call (RPC) framework that can connect services in and across data centers for load balancing, tracing, health checking, and authentication.</p>
<h2 id="glossary-hardware-security-module">Hardware security module<a class="headerlink" href="#glossary-hardware-security-module" title="Permanent link">&para;</a></h2>
<p>A physical appliance that provides on-demand encryption, key management, and key storage as a managed service.</p>
<h2 id="glossary-hosting-appliance">Hosting Appliance<a class="headerlink" href="#glossary-hosting-appliance" title="Permanent link">&para;</a></h2>
<p>A technical component within IBM Secure Service Container based appliances, providing the enablement for running Docker-based workloads.</p>
<h2 id="glossary-image">Image<a class="headerlink" href="#glossary-image" title="Permanent link">&para;</a></h2>
<p>The basis of the containers. An image is an ordered collection of root file system changes and the corresponding execution parameters for use within a container runtime.</p>
<h2 id="glossary-isv">ISV<a class="headerlink" href="#glossary-isv" title="Permanent link">&para;</a></h2>
<p>The abbreviation of Independent Software Vendor, who provides software solutions by developing and deploying containerized applications to the Secure Service Container partitions.</p>
<h2 id="glossary-master-key">Master key<a class="headerlink" href="#glossary-master-key" title="Permanent link">&para;</a></h2>
<p>An encryption key that is used to protect a crypto unit. The master key provides full control of the hardware security module and ownership of the root of trust that encrypts the chain keys, including the root key and standard key.</p>
<h2 id="glossary-management-utilities">Management Utilities<a class="headerlink" href="#glossary-management-utilities" title="Permanent link">&para;</a></h2>
<p>A set of applications to provide an alternate way of configuring Hyper Protect Crypto Services service instances using signature keys and master key parts stored on smart cards. </p>
<h2 id="glossary-management-server">Management server<a class="headerlink" href="#glossary-management-server" title="Permanent link">&para;</a></h2>
<p>An x86 or s390x Linux management server used to run the commands provided by the Hyper Protect Virtual Servers offering, and administer the offering.</p>
<h2 id="glossary-manifest">Manifest<a class="headerlink" href="#glossary-manifest" title="Permanent link">&para;</a></h2>
<p>A manifest is generated by the Secure Build for audit purpose, which contains a copy of the github project cloned by the Secure Build container, a copy of the build log, and a build.json with the build status.</p>
<h2 id="glossary-manifest-public-key">Manifest public key<a class="headerlink" href="#glossary-manifest-public-key" title="Permanent link">&para;</a></h2>
<p>A manifest public key is used to verify the manifest generated by the Secure Build.</p>
<h2 id="glossary-manifest-private-key">Manifest private key<a class="headerlink" href="#glossary-manifest-private-key" title="Permanent link">&para;</a></h2>
<p>A manifest private key is used to sign the manifest during the Secure Build.</p>
<h2 id="glossary-mutual-tls">Mutual TLS<a class="headerlink" href="#glossary-mutual-tls" title="Permanent link">&para;</a></h2>
<p>Mutual authentication or two-way authentication refers to two parties authenticating each other at the same time. Mutual TLS is doing this over the TLS protocol.</p>
<h2 id="glossary-namespace">Namespace<a class="headerlink" href="#glossary-namespace" title="Permanent link">&para;</a></h2>
<p>A namespace such as ibmzcontainers that contains a number of unique images. For examples, the images include hpvsop-base, hyperpcons-worker, hyperpcons-riaas, and so on.</p>
<h2 id="glossary-partition">Partition<a class="headerlink" href="#glossary-partition" title="Permanent link">&para;</a></h2>
<p>A partition is the logic partition (LPAR) on the mainframe, and can be created by using the logic partitioning tools such as Hardware Management Console (HMC) or other logical partitioning tools.</p>
<h2 id="glossary-pkcs-11">PKCS #11<a class="headerlink" href="#glossary-pkcs-11" title="Permanent link">&para;</a></h2>
<p>The abbreviation of Public-Key Cryptography Standards #11, which defines a platform-independent API to cryptographic tokens, such as HSM and smart cards.</p>
<h2 id="glossary-protected-memory-enclave">Protected memory enclave<a class="headerlink" href="#glossary-protected-memory-enclave" title="Permanent link">&para;</a></h2>
<p>Defined private regions of memory whose contents are protected and unable to be read or saved to any process outside the enclave itself.</p>
<h2 id="glossary-quotagroup">Quotagroup<a class="headerlink" href="#glossary-quotagroup" title="Permanent link">&para;</a></h2>
<p>The storage assigned to a workload running on an appliance. The appliance administrator assigns FCP, or ECKD based storage to an appliance. He then creates quotagroups, representing parts of the underlying storage. He finally assigns quotagroups to workloads through the appliance API.</p>
<h2 id="glossary-root-keys">Root keys<a class="headerlink" href="#glossary-root-keys" title="Permanent link">&para;</a></h2>
<p>A symmetric wrapping key that is used for encrypting and decrypting other keys that are stored in a data service.</p>
<h2 id="glossary-registry">Registry<a class="headerlink" href="#glossary-registry" title="Permanent link">&para;</a></h2>
<p>A Registry is a hosted service containing repositories of container images that responds to the Registry API. For example, Docker Hub.</p>
<h2 id="glossary-repository">Repository<a class="headerlink" href="#glossary-repository" title="Permanent link">&para;</a></h2>
<p>A repository is a set of containerized images. A repository can be shared by pushing it to a registry server. Different images in the repository can be labeled using tags. For example, hpvsop-base.</p>
<h2 id="glossary-repository-definition-files">Repository definition files<a class="headerlink" href="#glossary-repository-definition-files" title="Permanent link">&para;</a></h2>
<p>An encrypted registration file or a repository definition file is used to register the repository, for authentication or validation reasons, such that a Hosting Appliance will trust that the image, when pulled from the registry, is authentic.</p>
<h2 id="glossary-repository-registration-files">Repository registration files<a class="headerlink" href="#glossary-repository-registration-files" title="Permanent link">&para;</a></h2>
<p>A cleartext Python or JSON format file, which is generated by the Secure Build container when the container is created. The JSON format repository registration file can be used as the direct input to generate an encrypted repository definition file.</p>
<h2 id="glossary-runc">runc<a class="headerlink" href="#glossary-runc" title="Permanent link">&para;</a></h2>
<p>A CLI tool for spawning and running containers according to the Open Container Initiative (OCI) specification.</p>
<h2 id="glossary-runq">runq<a class="headerlink" href="#glossary-runq" title="Permanent link">&para;</a></h2>
<p>An open-sourced hypervisor-based Docker runtime environment, which is based on runc to run regular containerized images in a lightweight KVM or Qemu virtual machine.</p>
<h2 id="glossary-s390x">s390x<a class="headerlink" href="#glossary-s390x" title="Permanent link">&para;</a></h2>
<p>The underlying architecture of IBM Z or LinuxONE mainframe.</p>
<h2 id="glossary-secondary-node">Secondary node<a class="headerlink" href="#glossary-secondary-node" title="Permanent link">&para;</a></h2>
<p>A cluster member that replicates the contents of the primary database in Hyper Protect DBaaS.</p>
<h2 id="glossary-smart-cards">Smart cards<a class="headerlink" href="#glossary-smart-cards" title="Permanent link">&para;</a></h2>
<p>An HSM that looks like a credit card with an embedded chip. The chip is capable of performing a limited set of cryptographic operations and is loaded with custom software.</p>
<h2 id="glossary-smart-card-readers">Smart card readers<a class="headerlink" href="#glossary-smart-card-readers" title="Permanent link">&para;</a></h2>
<p>A device that attaches to a workstation and allows the workstation to communicate with a smart card.</p>
<h2 id="glossary-smart-card-utility-program">Smart Card Utility Program<a class="headerlink" href="#glossary-smart-card-utility-program" title="Permanent link">&para;</a></h2>
<p>The application installed as part of the Management Utilities. It sets up and manages the smart cards used by the Trusted Key Entry (TKE) application.</p>
<h2 id="glossary-signature-key">Signature key<a class="headerlink" href="#glossary-signature-key" title="Permanent link">&para;</a></h2>
<p>An encryption key that is used by the crypto unit administrator to sign commands that are issued to the crypto unit.</p>
<h2 id="glossary-standard-key">Standard key<a class="headerlink" href="#glossary-standard-key" title="Permanent link">&para;</a></h2>
<p>Another resource in Hyper Protect Crypto Services to directly encrypt and decrypt data.</p>
<h2 id="glossary-secure-build-secure-image-build">Secure Build / Secure Image Build<a class="headerlink" href="#glossary-secure-build-secure-image-build" title="Permanent link">&para;</a></h2>
<p>The process of building the application code from a Git-like source repository into a container image for s390x architecture, signing the image by using the authentication keys, and publishing the image to the remote repository for later integration.</p>
<h2 id="glossary-secure-service-container">Secure Service Container<a class="headerlink" href="#glossary-secure-service-container" title="Permanent link">&para;</a></h2>
<p>A container framework based on the runq technology, that is supported by the IBM Z or LinuxONE servers.</p>
<h2 id="glossary-secure-service-container-partition">Secure Service Container partition<a class="headerlink" href="#glossary-secure-service-container-partition" title="Permanent link">&para;</a></h2>
<p>A type of logic partitions (LPARs) on the mainframe that runs the Secure Service Container framework.</p>
<h2 id="glossary-ssh">SSH<a class="headerlink" href="#glossary-ssh" title="Permanent link">&para;</a></h2>
<p>The abbreviation of Secure Shell, which is a cryptographic network protocol for operating network services securely over an unsecured network by using public and private keys.</p>
<h2 id="glossary-storage-pool">Storage Pool<a class="headerlink" href="#glossary-storage-pool" title="Permanent link">&para;</a></h2>
<p>A storage pool is a uniquely named collection of storage disks on which the appliance file system is mounted.</p>
<h2 id="glossary-system-administrator">System Administrator<a class="headerlink" href="#glossary-system-administrator" title="Permanent link">&para;</a></h2>
<p>This role includes the system administrator of a machine, storage administrators, and network administrators.</p>
<h2 id="glossary-tag">tag<a class="headerlink" href="#glossary-tag" title="Permanent link">&para;</a></h2>
<p>A tag is used to version images in a repository. For example, latest, 1.2.3.4-develop-a0d3aea, or s390x-develop-54a9045.</p>
<h2 id="glossary-trusted-key-entry-application">Trusted Key Entry application<a class="headerlink" href="#glossary-trusted-key-entry-application" title="Permanent link">&para;</a></h2>
<p>The application installed as part of the Management Utilities. It uses smart cards to load master keys in service instances and to perform other configuration tasks for service instances.</p>
<h2 id="glossary-workload">Workload<a class="headerlink" href="#glossary-workload" title="Permanent link">&para;</a></h2>
<p>The application and data provided and generated by a (running) Workload Image.</p>
<h2 id="glossary-workload-data">Workload Data<a class="headerlink" href="#glossary-workload-data" title="Permanent link">&para;</a></h2>
<p>Workload user or workload client data, workload logs, workload secrets stored in the appliance.</p>
<h2 id="glossary-workload-image">Workload Image<a class="headerlink" href="#glossary-workload-image" title="Permanent link">&para;</a></h2>
<p>A container-based image, provided by the Workload Vendor. An appliance only runs workload images which have been registered with the appliance through a repository definition file.</p>
<h2 id="glossary-workload-user">Workload User<a class="headerlink" href="#glossary-workload-user" title="Permanent link">&para;</a></h2>
<p>The end-user of a workload.</p>
<h2 id="glossary-workload-vendor">Workload Vendor<a class="headerlink" href="#glossary-workload-vendor" title="Permanent link">&para;</a></h2>
<p>The creator of a Docker image running on top of Hosting Appliance.</p></section><section class="print-page" id="resources"><h1 id="resources-other-resources">Other Resources<a class="headerlink" href="#resources-other-resources" title="Permanent link">&para;</a></h1>
<h2 id="resources-hyper-protect-virtual-server-resources">Hyper Protect Virtual Server Resources<a class="headerlink" href="#resources-hyper-protect-virtual-server-resources" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.ibm.com/support/knowledgecenter/SSHPMH_1.2.x/kc_welcome_page.html">Knowledge Center</a></li>
<li><a href="http://www.redbooks.ibm.com/abstracts/sg248469.html?Open">Redbook</a></li>
</ul>
<h2 id="resources-hyper-protect-resources">Hyper Protect Resources<a class="headerlink" href="#resources-hyper-protect-resources" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://ibm-hyper-protect.github.io/">IBM Cloud Hyper Protect Services</a></li>
<li><a href="https://www.ustream.tv/recorded/126960640">Hyper Protect Digital Assets Platform</a></li>
</ul></section><section class="print-page" id="proposechange"><h1 id="proposechange-how-to-propose-a-change">How to propose a change<a class="headerlink" href="#proposechange-how-to-propose-a-change" title="Permanent link">&para;</a></h1>
<p>On the page you want to make a change to, click on the pencil icon next to the page's title. This will take you to edit the page in Github.</p>
<p>You will see a message similar to the following: "You’re editing a file in a project you don’t have write access to. Submitting a change to this file will write it to a new branch in your fork, so you can send a pull request."</p>
<p>Make your changes in Markdown. And submit for review.</p>
<p>The owners of this repo will review your pull request and accept or deny your change proposal.</p>
<p>There are other ways of doing a pull request, a Google search will lead you to those tutorials.</p></section></div>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 21.35-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.08C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53L12 21.35Z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 21.35-1.45-1.32C5.4 15.36 2 12.27 2 8.5 2 5.41 4.42 3 7.5 3c.67 0 1.32.12 1.94.33L13 9.35l-4 5 3 7M16.5 3C19.58 3 22 5.41 22 8.5c0 3.77-3.4 6.86-8.55 11.53L12 21.35l-1-7 4.5-5-2.65-5.08C13.87 3.47 15.17 3 16.5 3Z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback! Help us improve this page by using our <a href="https://github.com/ibm-wsc/hyper-protect-virtual-servers-workshop/issues/new/?title=[Feedback]+Print%20Site+-+/print_page/" target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ibm-wsc" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://hub.docker.com/u/s390x" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make the documentation as good as possible.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "/", "features": ["header.autohide", "navigation.sections", "navigation.expand", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "navigation.footer", "search.share", "navigation.indexes", "announce.dismiss", "content.tabs.link", "content.code.copy", "content.action.edit", "content.action.view"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fac441b0.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>